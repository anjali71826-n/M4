"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "googleapis":
/*!*****************************!*\
  !*** external "googleapis" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("googleapis");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "dns":
/*!**********************!*\
  !*** external "dns" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("dns");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fanjali.shrivastava07icloud.com%2FDocuments%2FGitHub%2FM4%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fanjali.shrivastava07icloud.com%2FDocuments%2FGitHub%2FM4&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fanjali.shrivastava07icloud.com%2FDocuments%2FGitHub%2FM4%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fanjali.shrivastava07icloud.com%2FDocuments%2FGitHub%2FM4&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_anjali_shrivastava07icloud_com_Documents_GitHub_M4_src_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/chat/route.ts */ \"(rsc)/./src/app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"/Users/anjali.shrivastava07icloud.com/Documents/GitHub/M4/src/app/api/chat/route.ts\",\n    nextConfigOutput,\n    userland: _Users_anjali_shrivastava07icloud_com_Documents_GitHub_M4_src_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmFuamFsaS5zaHJpdmFzdGF2YTA3aWNsb3VkLmNvbSUyRkRvY3VtZW50cyUyRkdpdEh1YiUyRk00JTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmFuamFsaS5zaHJpdmFzdGF2YTA3aWNsb3VkLmNvbSUyRkRvY3VtZW50cyUyRkdpdEh1YiUyRk00JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNtQztBQUNoSDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2Fkdmlzb3ItYXBwb2ludG1lbnQtc2NoZWR1bGVyLz9iZDc0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9hbmphbGkuc2hyaXZhc3RhdmEwN2ljbG91ZC5jb20vRG9jdW1lbnRzL0dpdEh1Yi9NNC9zcmMvYXBwL2FwaS9jaGF0L3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jaGF0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2hhdFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY2hhdC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9hbmphbGkuc2hyaXZhc3RhdmEwN2ljbG91ZC5jb20vRG9jdW1lbnRzL0dpdEh1Yi9NNC9zcmMvYXBwL2FwaS9jaGF0L3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jaGF0L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fanjali.shrivastava07icloud.com%2FDocuments%2FGitHub%2FM4%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fanjali.shrivastava07icloud.com%2FDocuments%2FGitHub%2FM4&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/chat/route.ts":
/*!***********************************!*\
  !*** ./src/app/api/chat/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_agent_intent_parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/agent/intent-parser */ \"(rsc)/./src/lib/agent/intent-parser.ts\");\n/* harmony import */ var _lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/agent/date-parser */ \"(rsc)/./src/lib/agent/date-parser.ts\");\n/* harmony import */ var _lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/agent/conversation */ \"(rsc)/./src/lib/agent/conversation.ts\");\n/* harmony import */ var _lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/google/calendar */ \"(rsc)/./src/lib/google/calendar.ts\");\n/* harmony import */ var _lib_google_sheets__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/google/sheets */ \"(rsc)/./src/lib/google/sheets.ts\");\n/* harmony import */ var _lib_google_gmail__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/lib/google/gmail */ \"(rsc)/./src/lib/google/gmail.ts\");\n\n\n\n\n\n\n\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { message, sessionState } = body;\n        // Initialize state if not provided\n        const currentState = sessionState || (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.createInitialState)();\n        // Parse the user's intent\n        const intent = (0,_lib_agent_intent_parser__WEBPACK_IMPORTED_MODULE_1__.parseIntent)(message, currentState);\n        // Handle based on intent type\n        switch(intent.type){\n            case \"SELECT_SLOT\":\n                return handleSlotSelection(message, currentState, intent.slotIndex);\n            case \"BOOK\":\n                return handleBooking(message, currentState);\n            case \"RESCHEDULE\":\n                return handleReschedule(message, currentState);\n            case \"CANCEL\":\n                return handleCancellation(message, currentState);\n            case \"CONFIRM\":\n                return handleConfirmation(message, currentState);\n            default:\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    reply: 'I\\'m your appointment scheduling assistant. I can help you:\\n\\n‚Ä¢ **Book** an appointment: \"Book an appointment on Monday at 2pm\"\\n‚Ä¢ **Reschedule** an appointment: \"Reschedule my appointment to Tuesday at 3pm\"\\n‚Ä¢ **Cancel** an appointment: \"Cancel my appointment on Wednesday\"\\n\\nHow can I help you today?',\n                    newState: currentState,\n                    success: true\n                });\n        }\n    } catch (error) {\n        console.error(\"Chat API error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: \"I apologize, but I encountered an error processing your request. Please try again.\",\n            newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.createInitialState)(),\n            success: false\n        });\n    }\n}\n// Handle booking intent\nasync function handleBooking(message, state) {\n    const { date, time } = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.parseDateTime)(message);\n    if (!date) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: 'I\\'d be happy to book an appointment for you. Could you please specify the date? For example, \"January 20th\" or \"next Monday\".',\n            newState: {\n                ...state,\n                currentIntent: \"BOOK\"\n            },\n            success: true\n        });\n    }\n    if (!time) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: `Great! I can see you want to book for ${formatDate(date)}. What time would you prefer? For example, \\\"at 2pm\\\" or \\\"at 10:30am\\\".`,\n            newState: {\n                ...state,\n                currentIntent: \"BOOK\",\n                targetDate: date.toISOString()\n            },\n            success: true\n        });\n    }\n    const appointmentTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.combineDateAndTime)(date, time);\n    // Check if date is in the past\n    if ((0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.isDateInPast)(appointmentTime)) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: \"I can't book appointments in the past. Please choose a future date and time.\",\n            newState: state,\n            success: false\n        });\n    }\n    const endTime = (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.getEndTime)(appointmentTime);\n    // Check availability\n    try {\n        const isAvailable = await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.checkAvailability)(appointmentTime, endTime);\n        if (isAvailable) {\n            // Book the appointment\n            const event = await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.createEvent)(\"Appointment - Voice Scheduler\", appointmentTime, endTime);\n            const formattedDateTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.formatDateTime)(appointmentTime);\n            // Log to sheets and send email with proper error handling\n            try {\n                await (0,_lib_google_sheets__WEBPACK_IMPORTED_MODULE_5__.logBooking)(message, formattedDateTime);\n                console.log(\"‚úÖ Logged to sheets successfully\");\n            } catch (logError) {\n                console.error(\"‚ùå Failed to log to sheets:\", logError);\n            }\n            try {\n                const emailSent = await (0,_lib_google_gmail__WEBPACK_IMPORTED_MODULE_6__.sendBookingConfirmation)(formattedDateTime);\n                console.log(emailSent ? \"‚úÖ Email sent successfully\" : \"‚ö†Ô∏è Email not sent\");\n            } catch (emailError) {\n                console.error(\"‚ùå Failed to send email:\", emailError);\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                reply: `‚úÖ **Appointment Confirmed!**\\n\\nüìÖ **Date:** ${formattedDateTime}\\n\\nYour appointment has been successfully booked. You'll receive a confirmation email shortly.`,\n                newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.resetState)(),\n                success: true\n            });\n        } else {\n            // Find alternative slots\n            const availableSlots = await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.findNextAvailableSlots)(date, 2);\n            if (availableSlots.length === 0) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    reply: `I'm sorry, but there are no available slots on ${formatDate(date)}. Would you like to try a different date?`,\n                    newState: state,\n                    success: true\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                reply: `The requested time is not available. Here are the next available slots for ${formatDate(date)}:`,\n                suggestedSlots: availableSlots,\n                newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.setPendingSlots)(state, availableSlots, \"BOOK\"),\n                success: true\n            });\n        }\n    } catch (error) {\n        console.error(\"Booking error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: \"I encountered an error while checking availability. Please try again.\",\n            newState: state,\n            success: false\n        });\n    }\n}\n// Handle slot selection\nasync function handleSlotSelection(message, state, slotIndex) {\n    const selectedSlot = (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.getSelectedSlot)(state, slotIndex);\n    if (!selectedSlot) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: \"I couldn't find that slot. Could you please select from the available options?\",\n            newState: state,\n            success: false\n        });\n    }\n    const startTime = new Date(selectedSlot.start);\n    const endTime = new Date(selectedSlot.end);\n    const formattedDateTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.formatDateTime)(startTime);\n    try {\n        if (state.currentIntent === \"RESCHEDULE\" && state.originalEvent) {\n            // Update the existing event\n            await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.updateEvent)(state.originalEvent.id, startTime, endTime);\n            const oldDateTime = new Date(state.originalEvent.start);\n            const formattedOldDateTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.formatDateTime)(oldDateTime);\n            // Log and send email with proper error handling\n            try {\n                await (0,_lib_google_sheets__WEBPACK_IMPORTED_MODULE_5__.logReschedule)(message, formattedDateTime);\n                console.log(\"‚úÖ Logged reschedule to sheets\");\n            } catch (logError) {\n                console.error(\"‚ùå Failed to log reschedule:\", logError);\n            }\n            try {\n                await (0,_lib_google_gmail__WEBPACK_IMPORTED_MODULE_6__.sendRescheduleConfirmation)(formattedOldDateTime, formattedDateTime);\n                console.log(\"‚úÖ Reschedule email sent\");\n            } catch (emailError) {\n                console.error(\"‚ùå Failed to send reschedule email:\", emailError);\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                reply: `‚úÖ **Appointment Rescheduled!**\\n\\nüìÖ **New Time:** ${formattedDateTime}\\n\\nYour appointment has been successfully moved from ${formattedOldDateTime}.`,\n                newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.resetState)(),\n                success: true\n            });\n        } else {\n            // Create new booking\n            await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.createEvent)(\"Appointment - Voice Scheduler\", startTime, endTime);\n            // Log and send email with proper error handling\n            try {\n                await (0,_lib_google_sheets__WEBPACK_IMPORTED_MODULE_5__.logBooking)(message, formattedDateTime);\n                console.log(\"‚úÖ Logged booking to sheets\");\n            } catch (logError) {\n                console.error(\"‚ùå Failed to log booking:\", logError);\n            }\n            try {\n                await (0,_lib_google_gmail__WEBPACK_IMPORTED_MODULE_6__.sendBookingConfirmation)(formattedDateTime);\n                console.log(\"‚úÖ Booking email sent\");\n            } catch (emailError) {\n                console.error(\"‚ùå Failed to send booking email:\", emailError);\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                reply: `‚úÖ **Appointment Confirmed!**\\n\\nüìÖ **Date:** ${formattedDateTime}\\n\\nYour appointment has been successfully booked.`,\n                newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.resetState)(),\n                success: true\n            });\n        }\n    } catch (error) {\n        console.error(\"Slot selection error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: \"I encountered an error booking the selected slot. Please try again.\",\n            newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.clearPendingSlots)(state),\n            success: false\n        });\n    }\n}\n// Handle reschedule intent\nasync function handleReschedule(message, state) {\n    const { originalDate, newDate, newTime } = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.parseRescheduleDates)(message);\n    // If we have an original event in state, use that\n    if (state.originalEvent && newDate && newTime) {\n        const newAppointmentTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.combineDateAndTime)(newDate, newTime);\n        const newEndTime = (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.getEndTime)(newAppointmentTime);\n        if ((0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.isDateInPast)(newAppointmentTime)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                reply: \"I can't reschedule to a time in the past. Please choose a future date and time.\",\n                newState: state,\n                success: false\n            });\n        }\n        const isAvailable = await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.checkAvailability)(newAppointmentTime, newEndTime);\n        if (isAvailable) {\n            await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.updateEvent)(state.originalEvent.id, newAppointmentTime, newEndTime);\n            const formattedDateTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.formatDateTime)(newAppointmentTime);\n            const oldDateTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.formatDateTime)(new Date(state.originalEvent.start));\n            try {\n                await (0,_lib_google_sheets__WEBPACK_IMPORTED_MODULE_5__.logReschedule)(message, formattedDateTime);\n                console.log(\"‚úÖ Logged reschedule to sheets\");\n            } catch (logError) {\n                console.error(\"‚ùå Failed to log reschedule:\", logError);\n            }\n            try {\n                await (0,_lib_google_gmail__WEBPACK_IMPORTED_MODULE_6__.sendRescheduleConfirmation)(oldDateTime, formattedDateTime);\n                console.log(\"‚úÖ Reschedule email sent\");\n            } catch (emailError) {\n                console.error(\"‚ùå Failed to send reschedule email:\", emailError);\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                reply: `‚úÖ **Appointment Rescheduled!**\\n\\nüìÖ **New Time:** ${formattedDateTime}\\n\\nYour appointment has been moved from ${oldDateTime}.`,\n                newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.resetState)(),\n                success: true\n            });\n        } else {\n            const availableSlots = await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.findNextAvailableSlots)(newDate, 2);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                reply: `The requested time is not available. Here are alternative slots:`,\n                suggestedSlots: availableSlots,\n                newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.setPendingSlots)((0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.setOriginalEvent)(state, state.originalEvent), availableSlots, \"RESCHEDULE\"),\n                success: true\n            });\n        }\n    }\n    // Try to find the original appointment\n    if (!originalDate) {\n        const parsed = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.parseDateTime)(message);\n        if (parsed.date) {\n            try {\n                const event = await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.findEventByDate)(parsed.date);\n                if (event) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        reply: `I found your appointment on ${(0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.formatDateTime)(new Date(event.start.dateTime))}. When would you like to reschedule it to?`,\n                        newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.setOriginalEvent)({\n                            ...state,\n                            currentIntent: \"RESCHEDULE\"\n                        }, event),\n                        success: true\n                    });\n                } else {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        reply: `I couldn't find an appointment on ${formatDate(parsed.date)}. Please check the date and try again.`,\n                        newState: state,\n                        success: false\n                    });\n                }\n            } catch (error) {\n                console.error(\"Error finding event:\", error);\n            }\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: 'To reschedule, please tell me which appointment you\\'d like to move. For example: \"Reschedule my appointment on Monday to Tuesday at 3pm\".',\n            newState: {\n                ...state,\n                currentIntent: \"RESCHEDULE\"\n            },\n            success: true\n        });\n    }\n    // Find the original event\n    try {\n        const event = await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.findEventByDate)(originalDate);\n        if (!event) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                reply: `I couldn't find an appointment on ${formatDate(originalDate)}. Please check the date and try again.`,\n                newState: state,\n                success: false\n            });\n        }\n        // If we have the new date/time, try to reschedule\n        if (newDate && newTime) {\n            const newAppointmentTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.combineDateAndTime)(newDate, newTime);\n            const newEndTime = (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.getEndTime)(newAppointmentTime);\n            if ((0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.isDateInPast)(newAppointmentTime)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    reply: \"I can't reschedule to a time in the past. Please choose a future date and time.\",\n                    newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.setOriginalEvent)(state, event),\n                    success: false\n                });\n            }\n            const isAvailable = await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.checkAvailability)(newAppointmentTime, newEndTime);\n            if (isAvailable) {\n                await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.updateEvent)(event.id, newAppointmentTime, newEndTime);\n                const formattedDateTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.formatDateTime)(newAppointmentTime);\n                const oldDateTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.formatDateTime)(new Date(event.start.dateTime));\n                try {\n                    await (0,_lib_google_sheets__WEBPACK_IMPORTED_MODULE_5__.logReschedule)(message, formattedDateTime);\n                    console.log(\"‚úÖ Logged reschedule to sheets\");\n                } catch (logError) {\n                    console.error(\"‚ùå Failed to log reschedule:\", logError);\n                }\n                try {\n                    await (0,_lib_google_gmail__WEBPACK_IMPORTED_MODULE_6__.sendRescheduleConfirmation)(oldDateTime, formattedDateTime);\n                    console.log(\"‚úÖ Reschedule email sent\");\n                } catch (emailError) {\n                    console.error(\"‚ùå Failed to send reschedule email:\", emailError);\n                }\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    reply: `‚úÖ **Appointment Rescheduled!**\\n\\nüìÖ **New Time:** ${formattedDateTime}\\n\\nYour appointment has been moved from ${oldDateTime}.`,\n                    newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.resetState)(),\n                    success: true\n                });\n            } else {\n                const availableSlots = await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.findNextAvailableSlots)(newDate, 2);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    reply: `The requested time is not available. Here are alternative slots:`,\n                    suggestedSlots: availableSlots,\n                    newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.setPendingSlots)((0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.setOriginalEvent)(state, event), availableSlots, \"RESCHEDULE\"),\n                    success: true\n                });\n            }\n        }\n        // Ask for new date/time\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: `I found your appointment on ${(0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.formatDateTime)(new Date(event.start.dateTime))}. When would you like to reschedule it to?`,\n            newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.setOriginalEvent)({\n                ...state,\n                currentIntent: \"RESCHEDULE\"\n            }, event),\n            success: true\n        });\n    } catch (error) {\n        console.error(\"Reschedule error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: \"I encountered an error while trying to reschedule. Please try again.\",\n            newState: state,\n            success: false\n        });\n    }\n}\n// Handle cancellation intent\nasync function handleCancellation(message, state) {\n    const { date } = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.parseDateTime)(message);\n    if (!date) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: 'Which appointment would you like to cancel? Please specify the date, for example: \"Cancel my appointment on Monday\" or \"Cancel appointment on January 20th\".',\n            newState: {\n                ...state,\n                currentIntent: \"CANCEL\"\n            },\n            success: true\n        });\n    }\n    try {\n        const event = await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.findEventByDate)(date);\n        if (!event) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                reply: `I couldn't find an appointment on ${formatDate(date)}. Please check the date and try again.`,\n                newState: state,\n                success: false\n            });\n        }\n        const formattedDateTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.formatDateTime)(new Date(event.start.dateTime));\n        // Delete the event\n        await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.deleteEvent)(event.id);\n        // Log and send email with proper error handling\n        try {\n            await (0,_lib_google_sheets__WEBPACK_IMPORTED_MODULE_5__.logCancellation)(message, formattedDateTime);\n            console.log(\"‚úÖ Logged cancellation to sheets\");\n        } catch (logError) {\n            console.error(\"‚ùå Failed to log cancellation:\", logError);\n        }\n        try {\n            await (0,_lib_google_gmail__WEBPACK_IMPORTED_MODULE_6__.sendCancellationConfirmation)(formattedDateTime);\n            console.log(\"‚úÖ Cancellation email sent\");\n        } catch (emailError) {\n            console.error(\"‚ùå Failed to send cancellation email:\", emailError);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: `‚úÖ **Appointment Cancelled**\\n\\nYour appointment on ${formattedDateTime} has been cancelled. A confirmation email has been sent.`,\n            newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.resetState)(),\n            success: true\n        });\n    } catch (error) {\n        console.error(\"Cancellation error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: \"I encountered an error while cancelling the appointment. Please try again.\",\n            newState: state,\n            success: false\n        });\n    }\n}\n// Handle confirmation\nasync function handleConfirmation(message, state) {\n    // If awaiting confirmation for something specific, handle it\n    if (state.awaitingConfirmation && state.targetDate && state.targetTime) {\n        const date = new Date(state.targetDate);\n        const appointmentTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.combineDateAndTime)(date, state.targetTime);\n        const endTime = (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.getEndTime)(appointmentTime);\n        await (0,_lib_google_calendar__WEBPACK_IMPORTED_MODULE_4__.createEvent)(\"Appointment - Voice Scheduler\", appointmentTime, endTime);\n        const formattedDateTime = (0,_lib_agent_date_parser__WEBPACK_IMPORTED_MODULE_2__.formatDateTime)(appointmentTime);\n        try {\n            await (0,_lib_google_sheets__WEBPACK_IMPORTED_MODULE_5__.logBooking)(message, formattedDateTime);\n            console.log(\"‚úÖ Logged confirmation to sheets\");\n        } catch (logError) {\n            console.error(\"‚ùå Failed to log confirmation:\", logError);\n        }\n        try {\n            await (0,_lib_google_gmail__WEBPACK_IMPORTED_MODULE_6__.sendBookingConfirmation)(formattedDateTime);\n            console.log(\"‚úÖ Confirmation email sent\");\n        } catch (emailError) {\n            console.error(\"‚ùå Failed to send confirmation email:\", emailError);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: `‚úÖ **Appointment Confirmed!**\\n\\nüìÖ **Date:** ${formattedDateTime}\\n\\nYour appointment has been booked.`,\n            newState: (0,_lib_agent_conversation__WEBPACK_IMPORTED_MODULE_3__.resetState)(),\n            success: true\n        });\n    }\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        reply: \"I'm not sure what you'd like to confirm. Could you please provide more details?\",\n        newState: state,\n        success: true\n    });\n}\n// Helper to format date for display\nfunction formatDate(date) {\n    return date.toLocaleDateString(\"en-US\", {\n        weekday: \"long\",\n        month: \"long\",\n        day: \"numeric\"\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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L2FwaS9jaGF0L3JvdXRlLnRzPzQ2YjciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IENoYXRSZXF1ZXN0LCBDaGF0UmVzcG9uc2UsIENvbnZlcnNhdGlvblN0YXRlLCBTbG90T3B0aW9uIH0gZnJvbSAnQC9saWIvdHlwZXMnO1xuaW1wb3J0IHsgcGFyc2VJbnRlbnQgfSBmcm9tICdAL2xpYi9hZ2VudC9pbnRlbnQtcGFyc2VyJztcbmltcG9ydCB7XG4gICAgcGFyc2VEYXRlVGltZSxcbiAgICBjb21iaW5lRGF0ZUFuZFRpbWUsXG4gICAgaXNEYXRlSW5QYXN0LFxuICAgIGZvcm1hdERhdGVUaW1lLFxuICAgIHBhcnNlUmVzY2hlZHVsZURhdGVzXG59IGZyb20gJ0AvbGliL2FnZW50L2RhdGUtcGFyc2VyJztcbmltcG9ydCB7XG4gICAgY3JlYXRlSW5pdGlhbFN0YXRlLFxuICAgIHJlc2V0U3RhdGUsXG4gICAgc2V0UGVuZGluZ1Nsb3RzLFxuICAgIGdldFNlbGVjdGVkU2xvdCxcbiAgICBzZXRPcmlnaW5hbEV2ZW50LFxuICAgIGNsZWFyUGVuZGluZ1Nsb3RzXG59IGZyb20gJ0AvbGliL2FnZW50L2NvbnZlcnNhdGlvbic7XG5pbXBvcnQge1xuICAgIGNoZWNrQXZhaWxhYmlsaXR5LFxuICAgIGZpbmROZXh0QXZhaWxhYmxlU2xvdHMsXG4gICAgY3JlYXRlRXZlbnQsXG4gICAgZmluZEV2ZW50QnlEYXRlLFxuICAgIHVwZGF0ZUV2ZW50LFxuICAgIGRlbGV0ZUV2ZW50LFxuICAgIGdldEVuZFRpbWUsXG59IGZyb20gJ0AvbGliL2dvb2dsZS9jYWxlbmRhcic7XG5pbXBvcnQgeyBsb2dCb29raW5nLCBsb2dSZXNjaGVkdWxlLCBsb2dDYW5jZWxsYXRpb24gfSBmcm9tICdAL2xpYi9nb29nbGUvc2hlZXRzJztcbmltcG9ydCB7XG4gICAgc2VuZEJvb2tpbmdDb25maXJtYXRpb24sXG4gICAgc2VuZFJlc2NoZWR1bGVDb25maXJtYXRpb24sXG4gICAgc2VuZENhbmNlbGxhdGlvbkNvbmZpcm1hdGlvblxufSBmcm9tICdAL2xpYi9nb29nbGUvZ21haWwnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCk6IFByb21pc2U8TmV4dFJlc3BvbnNlPENoYXRSZXNwb25zZT4+IHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBib2R5OiBDaGF0UmVxdWVzdCA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgICAgICBjb25zdCB7IG1lc3NhZ2UsIHNlc3Npb25TdGF0ZSB9ID0gYm9keTtcblxuICAgICAgICAvLyBJbml0aWFsaXplIHN0YXRlIGlmIG5vdCBwcm92aWRlZFxuICAgICAgICBjb25zdCBjdXJyZW50U3RhdGU6IENvbnZlcnNhdGlvblN0YXRlID0gc2Vzc2lvblN0YXRlIHx8IGNyZWF0ZUluaXRpYWxTdGF0ZSgpO1xuXG4gICAgICAgIC8vIFBhcnNlIHRoZSB1c2VyJ3MgaW50ZW50XG4gICAgICAgIGNvbnN0IGludGVudCA9IHBhcnNlSW50ZW50KG1lc3NhZ2UsIGN1cnJlbnRTdGF0ZSk7XG5cbiAgICAgICAgLy8gSGFuZGxlIGJhc2VkIG9uIGludGVudCB0eXBlXG4gICAgICAgIHN3aXRjaCAoaW50ZW50LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ1NFTEVDVF9TTE9UJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlU2xvdFNlbGVjdGlvbihtZXNzYWdlLCBjdXJyZW50U3RhdGUsIGludGVudC5zbG90SW5kZXghKTtcblxuICAgICAgICAgICAgY2FzZSAnQk9PSyc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZUJvb2tpbmcobWVzc2FnZSwgY3VycmVudFN0YXRlKTtcblxuICAgICAgICAgICAgY2FzZSAnUkVTQ0hFRFVMRSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZVJlc2NoZWR1bGUobWVzc2FnZSwgY3VycmVudFN0YXRlKTtcblxuICAgICAgICAgICAgY2FzZSAnQ0FOQ0VMJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlQ2FuY2VsbGF0aW9uKG1lc3NhZ2UsIGN1cnJlbnRTdGF0ZSk7XG5cbiAgICAgICAgICAgIGNhc2UgJ0NPTkZJUk0nOlxuICAgICAgICAgICAgICAgIHJldHVybiBoYW5kbGVDb25maXJtYXRpb24obWVzc2FnZSwgY3VycmVudFN0YXRlKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgICAgICAgICByZXBseTogXCJJJ20geW91ciBhcHBvaW50bWVudCBzY2hlZHVsaW5nIGFzc2lzdGFudC4gSSBjYW4gaGVscCB5b3U6XFxuXFxu4oCiICoqQm9vayoqIGFuIGFwcG9pbnRtZW50OiBcXFwiQm9vayBhbiBhcHBvaW50bWVudCBvbiBNb25kYXkgYXQgMnBtXFxcIlxcbuKAoiAqKlJlc2NoZWR1bGUqKiBhbiBhcHBvaW50bWVudDogXFxcIlJlc2NoZWR1bGUgbXkgYXBwb2ludG1lbnQgdG8gVHVlc2RheSBhdCAzcG1cXFwiXFxu4oCiICoqQ2FuY2VsKiogYW4gYXBwb2ludG1lbnQ6IFxcXCJDYW5jZWwgbXkgYXBwb2ludG1lbnQgb24gV2VkbmVzZGF5XFxcIlxcblxcbkhvdyBjYW4gSSBoZWxwIHlvdSB0b2RheT9cIixcbiAgICAgICAgICAgICAgICAgICAgbmV3U3RhdGU6IGN1cnJlbnRTdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NoYXQgQVBJIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgIHJlcGx5OiAnSSBhcG9sb2dpemUsIGJ1dCBJIGVuY291bnRlcmVkIGFuIGVycm9yIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0LiBQbGVhc2UgdHJ5IGFnYWluLicsXG4gICAgICAgICAgICBuZXdTdGF0ZTogY3JlYXRlSW5pdGlhbFN0YXRlKCksXG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyBIYW5kbGUgYm9va2luZyBpbnRlbnRcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUJvb2tpbmcoXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIHN0YXRlOiBDb252ZXJzYXRpb25TdGF0ZVxuKTogUHJvbWlzZTxOZXh0UmVzcG9uc2U8Q2hhdFJlc3BvbnNlPj4ge1xuICAgIGNvbnN0IHsgZGF0ZSwgdGltZSB9ID0gcGFyc2VEYXRlVGltZShtZXNzYWdlKTtcblxuICAgIGlmICghZGF0ZSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgcmVwbHk6IFwiSSdkIGJlIGhhcHB5IHRvIGJvb2sgYW4gYXBwb2ludG1lbnQgZm9yIHlvdS4gQ291bGQgeW91IHBsZWFzZSBzcGVjaWZ5IHRoZSBkYXRlPyBGb3IgZXhhbXBsZSwgXFxcIkphbnVhcnkgMjB0aFxcXCIgb3IgXFxcIm5leHQgTW9uZGF5XFxcIi5cIixcbiAgICAgICAgICAgIG5ld1N0YXRlOiB7IC4uLnN0YXRlLCBjdXJyZW50SW50ZW50OiAnQk9PSycgfSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICghdGltZSkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgcmVwbHk6IGBHcmVhdCEgSSBjYW4gc2VlIHlvdSB3YW50IHRvIGJvb2sgZm9yICR7Zm9ybWF0RGF0ZShkYXRlKX0uIFdoYXQgdGltZSB3b3VsZCB5b3UgcHJlZmVyPyBGb3IgZXhhbXBsZSwgXFxcImF0IDJwbVxcXCIgb3IgXFxcImF0IDEwOjMwYW1cXFwiLmAsXG4gICAgICAgICAgICBuZXdTdGF0ZTogeyAuLi5zdGF0ZSwgY3VycmVudEludGVudDogJ0JPT0snLCB0YXJnZXREYXRlOiBkYXRlLnRvSVNPU3RyaW5nKCkgfSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGFwcG9pbnRtZW50VGltZSA9IGNvbWJpbmVEYXRlQW5kVGltZShkYXRlLCB0aW1lKTtcblxuICAgIC8vIENoZWNrIGlmIGRhdGUgaXMgaW4gdGhlIHBhc3RcbiAgICBpZiAoaXNEYXRlSW5QYXN0KGFwcG9pbnRtZW50VGltZSkpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgIHJlcGx5OiBcIkkgY2FuJ3QgYm9vayBhcHBvaW50bWVudHMgaW4gdGhlIHBhc3QuIFBsZWFzZSBjaG9vc2UgYSBmdXR1cmUgZGF0ZSBhbmQgdGltZS5cIixcbiAgICAgICAgICAgIG5ld1N0YXRlOiBzdGF0ZSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBlbmRUaW1lID0gZ2V0RW5kVGltZShhcHBvaW50bWVudFRpbWUpO1xuXG4gICAgLy8gQ2hlY2sgYXZhaWxhYmlsaXR5XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaXNBdmFpbGFibGUgPSBhd2FpdCBjaGVja0F2YWlsYWJpbGl0eShhcHBvaW50bWVudFRpbWUsIGVuZFRpbWUpO1xuXG4gICAgICAgIGlmIChpc0F2YWlsYWJsZSkge1xuICAgICAgICAgICAgLy8gQm9vayB0aGUgYXBwb2ludG1lbnRcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gYXdhaXQgY3JlYXRlRXZlbnQoXG4gICAgICAgICAgICAgICAgJ0FwcG9pbnRtZW50IC0gVm9pY2UgU2NoZWR1bGVyJyxcbiAgICAgICAgICAgICAgICBhcHBvaW50bWVudFRpbWUsXG4gICAgICAgICAgICAgICAgZW5kVGltZVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkRGF0ZVRpbWUgPSBmb3JtYXREYXRlVGltZShhcHBvaW50bWVudFRpbWUpO1xuXG4gICAgICAgICAgICAvLyBMb2cgdG8gc2hlZXRzIGFuZCBzZW5kIGVtYWlsIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IGxvZ0Jvb2tpbmcobWVzc2FnZSwgZm9ybWF0dGVkRGF0ZVRpbWUpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgTG9nZ2VkIHRvIHNoZWV0cyBzdWNjZXNzZnVsbHknKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGxvZ0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBsb2cgdG8gc2hlZXRzOicsIGxvZ0Vycm9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbWFpbFNlbnQgPSBhd2FpdCBzZW5kQm9va2luZ0NvbmZpcm1hdGlvbihmb3JtYXR0ZWREYXRlVGltZSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZW1haWxTZW50ID8gJ+KchSBFbWFpbCBzZW50IHN1Y2Nlc3NmdWxseScgOiAn4pqg77iPIEVtYWlsIG5vdCBzZW50Jyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlbWFpbEVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBzZW5kIGVtYWlsOicsIGVtYWlsRXJyb3IpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgICAgIHJlcGx5OiBg4pyFICoqQXBwb2ludG1lbnQgQ29uZmlybWVkISoqXFxuXFxu8J+ThSAqKkRhdGU6KiogJHtmb3JtYXR0ZWREYXRlVGltZX1cXG5cXG5Zb3VyIGFwcG9pbnRtZW50IGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBib29rZWQuIFlvdSdsbCByZWNlaXZlIGEgY29uZmlybWF0aW9uIGVtYWlsIHNob3J0bHkuYCxcbiAgICAgICAgICAgICAgICBuZXdTdGF0ZTogcmVzZXRTdGF0ZSgpLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEZpbmQgYWx0ZXJuYXRpdmUgc2xvdHNcbiAgICAgICAgICAgIGNvbnN0IGF2YWlsYWJsZVNsb3RzID0gYXdhaXQgZmluZE5leHRBdmFpbGFibGVTbG90cyhkYXRlLCAyKTtcblxuICAgICAgICAgICAgaWYgKGF2YWlsYWJsZVNsb3RzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgICAgICAgICAgIHJlcGx5OiBgSSdtIHNvcnJ5LCBidXQgdGhlcmUgYXJlIG5vIGF2YWlsYWJsZSBzbG90cyBvbiAke2Zvcm1hdERhdGUoZGF0ZSl9LiBXb3VsZCB5b3UgbGlrZSB0byB0cnkgYSBkaWZmZXJlbnQgZGF0ZT9gLFxuICAgICAgICAgICAgICAgICAgICBuZXdTdGF0ZTogc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgICAgICAgcmVwbHk6IGBUaGUgcmVxdWVzdGVkIHRpbWUgaXMgbm90IGF2YWlsYWJsZS4gSGVyZSBhcmUgdGhlIG5leHQgYXZhaWxhYmxlIHNsb3RzIGZvciAke2Zvcm1hdERhdGUoZGF0ZSl9OmAsXG4gICAgICAgICAgICAgICAgc3VnZ2VzdGVkU2xvdHM6IGF2YWlsYWJsZVNsb3RzLFxuICAgICAgICAgICAgICAgIG5ld1N0YXRlOiBzZXRQZW5kaW5nU2xvdHMoc3RhdGUsIGF2YWlsYWJsZVNsb3RzLCAnQk9PSycpLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Jvb2tpbmcgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgcmVwbHk6ICdJIGVuY291bnRlcmVkIGFuIGVycm9yIHdoaWxlIGNoZWNraW5nIGF2YWlsYWJpbGl0eS4gUGxlYXNlIHRyeSBhZ2Fpbi4nLFxuICAgICAgICAgICAgbmV3U3RhdGU6IHN0YXRlLFxuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8gSGFuZGxlIHNsb3Qgc2VsZWN0aW9uXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVTbG90U2VsZWN0aW9uKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBzdGF0ZTogQ29udmVyc2F0aW9uU3RhdGUsXG4gICAgc2xvdEluZGV4OiBudW1iZXJcbik6IFByb21pc2U8TmV4dFJlc3BvbnNlPENoYXRSZXNwb25zZT4+IHtcbiAgICBjb25zdCBzZWxlY3RlZFNsb3QgPSBnZXRTZWxlY3RlZFNsb3Qoc3RhdGUsIHNsb3RJbmRleCk7XG5cbiAgICBpZiAoIXNlbGVjdGVkU2xvdCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgcmVwbHk6IFwiSSBjb3VsZG4ndCBmaW5kIHRoYXQgc2xvdC4gQ291bGQgeW91IHBsZWFzZSBzZWxlY3QgZnJvbSB0aGUgYXZhaWxhYmxlIG9wdGlvbnM/XCIsXG4gICAgICAgICAgICBuZXdTdGF0ZTogc3RhdGUsXG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gbmV3IERhdGUoc2VsZWN0ZWRTbG90LnN0YXJ0KTtcbiAgICBjb25zdCBlbmRUaW1lID0gbmV3IERhdGUoc2VsZWN0ZWRTbG90LmVuZCk7XG4gICAgY29uc3QgZm9ybWF0dGVkRGF0ZVRpbWUgPSBmb3JtYXREYXRlVGltZShzdGFydFRpbWUpO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHN0YXRlLmN1cnJlbnRJbnRlbnQgPT09ICdSRVNDSEVEVUxFJyAmJiBzdGF0ZS5vcmlnaW5hbEV2ZW50KSB7XG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGV4aXN0aW5nIGV2ZW50XG4gICAgICAgICAgICBhd2FpdCB1cGRhdGVFdmVudChzdGF0ZS5vcmlnaW5hbEV2ZW50LmlkLCBzdGFydFRpbWUsIGVuZFRpbWUpO1xuXG4gICAgICAgICAgICBjb25zdCBvbGREYXRlVGltZSA9IG5ldyBEYXRlKHN0YXRlLm9yaWdpbmFsRXZlbnQuc3RhcnQpO1xuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkT2xkRGF0ZVRpbWUgPSBmb3JtYXREYXRlVGltZShvbGREYXRlVGltZSk7XG5cbiAgICAgICAgICAgIC8vIExvZyBhbmQgc2VuZCBlbWFpbCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZ1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhd2FpdCBsb2dSZXNjaGVkdWxlKG1lc3NhZ2UsIGZvcm1hdHRlZERhdGVUaW1lKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIExvZ2dlZCByZXNjaGVkdWxlIHRvIHNoZWV0cycpO1xuICAgICAgICAgICAgfSBjYXRjaCAobG9nRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRmFpbGVkIHRvIGxvZyByZXNjaGVkdWxlOicsIGxvZ0Vycm9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhd2FpdCBzZW5kUmVzY2hlZHVsZUNvbmZpcm1hdGlvbihmb3JtYXR0ZWRPbGREYXRlVGltZSwgZm9ybWF0dGVkRGF0ZVRpbWUpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgUmVzY2hlZHVsZSBlbWFpbCBzZW50Jyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlbWFpbEVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBzZW5kIHJlc2NoZWR1bGUgZW1haWw6JywgZW1haWxFcnJvcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgICAgICAgcmVwbHk6IGDinIUgKipBcHBvaW50bWVudCBSZXNjaGVkdWxlZCEqKlxcblxcbvCfk4UgKipOZXcgVGltZToqKiAke2Zvcm1hdHRlZERhdGVUaW1lfVxcblxcbllvdXIgYXBwb2ludG1lbnQgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IG1vdmVkIGZyb20gJHtmb3JtYXR0ZWRPbGREYXRlVGltZX0uYCxcbiAgICAgICAgICAgICAgICBuZXdTdGF0ZTogcmVzZXRTdGF0ZSgpLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgYm9va2luZ1xuICAgICAgICAgICAgYXdhaXQgY3JlYXRlRXZlbnQoJ0FwcG9pbnRtZW50IC0gVm9pY2UgU2NoZWR1bGVyJywgc3RhcnRUaW1lLCBlbmRUaW1lKTtcblxuICAgICAgICAgICAgLy8gTG9nIGFuZCBzZW5kIGVtYWlsIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IGxvZ0Jvb2tpbmcobWVzc2FnZSwgZm9ybWF0dGVkRGF0ZVRpbWUpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgTG9nZ2VkIGJvb2tpbmcgdG8gc2hlZXRzJyk7XG4gICAgICAgICAgICB9IGNhdGNoIChsb2dFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gbG9nIGJvb2tpbmc6JywgbG9nRXJyb3IpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHNlbmRCb29raW5nQ29uZmlybWF0aW9uKGZvcm1hdHRlZERhdGVUaW1lKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIEJvb2tpbmcgZW1haWwgc2VudCcpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZW1haWxFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gc2VuZCBib29raW5nIGVtYWlsOicsIGVtYWlsRXJyb3IpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgICAgIHJlcGx5OiBg4pyFICoqQXBwb2ludG1lbnQgQ29uZmlybWVkISoqXFxuXFxu8J+ThSAqKkRhdGU6KiogJHtmb3JtYXR0ZWREYXRlVGltZX1cXG5cXG5Zb3VyIGFwcG9pbnRtZW50IGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBib29rZWQuYCxcbiAgICAgICAgICAgICAgICBuZXdTdGF0ZTogcmVzZXRTdGF0ZSgpLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Nsb3Qgc2VsZWN0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgIHJlcGx5OiAnSSBlbmNvdW50ZXJlZCBhbiBlcnJvciBib29raW5nIHRoZSBzZWxlY3RlZCBzbG90LiBQbGVhc2UgdHJ5IGFnYWluLicsXG4gICAgICAgICAgICBuZXdTdGF0ZTogY2xlYXJQZW5kaW5nU2xvdHMoc3RhdGUpLFxuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8gSGFuZGxlIHJlc2NoZWR1bGUgaW50ZW50XG5hc3luYyBmdW5jdGlvbiBoYW5kbGVSZXNjaGVkdWxlKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBzdGF0ZTogQ29udmVyc2F0aW9uU3RhdGVcbik6IFByb21pc2U8TmV4dFJlc3BvbnNlPENoYXRSZXNwb25zZT4+IHtcbiAgICBjb25zdCB7IG9yaWdpbmFsRGF0ZSwgbmV3RGF0ZSwgbmV3VGltZSB9ID0gcGFyc2VSZXNjaGVkdWxlRGF0ZXMobWVzc2FnZSk7XG5cbiAgICAvLyBJZiB3ZSBoYXZlIGFuIG9yaWdpbmFsIGV2ZW50IGluIHN0YXRlLCB1c2UgdGhhdFxuICAgIGlmIChzdGF0ZS5vcmlnaW5hbEV2ZW50ICYmIG5ld0RhdGUgJiYgbmV3VGltZSkge1xuICAgICAgICBjb25zdCBuZXdBcHBvaW50bWVudFRpbWUgPSBjb21iaW5lRGF0ZUFuZFRpbWUobmV3RGF0ZSwgbmV3VGltZSk7XG4gICAgICAgIGNvbnN0IG5ld0VuZFRpbWUgPSBnZXRFbmRUaW1lKG5ld0FwcG9pbnRtZW50VGltZSk7XG5cbiAgICAgICAgaWYgKGlzRGF0ZUluUGFzdChuZXdBcHBvaW50bWVudFRpbWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgICAgIHJlcGx5OiBcIkkgY2FuJ3QgcmVzY2hlZHVsZSB0byBhIHRpbWUgaW4gdGhlIHBhc3QuIFBsZWFzZSBjaG9vc2UgYSBmdXR1cmUgZGF0ZSBhbmQgdGltZS5cIixcbiAgICAgICAgICAgICAgICBuZXdTdGF0ZTogc3RhdGUsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlzQXZhaWxhYmxlID0gYXdhaXQgY2hlY2tBdmFpbGFiaWxpdHkobmV3QXBwb2ludG1lbnRUaW1lLCBuZXdFbmRUaW1lKTtcblxuICAgICAgICBpZiAoaXNBdmFpbGFibGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZUV2ZW50KHN0YXRlLm9yaWdpbmFsRXZlbnQuaWQsIG5ld0FwcG9pbnRtZW50VGltZSwgbmV3RW5kVGltZSk7XG4gICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWREYXRlVGltZSA9IGZvcm1hdERhdGVUaW1lKG5ld0FwcG9pbnRtZW50VGltZSk7XG4gICAgICAgICAgICBjb25zdCBvbGREYXRlVGltZSA9IGZvcm1hdERhdGVUaW1lKG5ldyBEYXRlKHN0YXRlLm9yaWdpbmFsRXZlbnQuc3RhcnQpKTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhd2FpdCBsb2dSZXNjaGVkdWxlKG1lc3NhZ2UsIGZvcm1hdHRlZERhdGVUaW1lKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIExvZ2dlZCByZXNjaGVkdWxlIHRvIHNoZWV0cycpO1xuICAgICAgICAgICAgfSBjYXRjaCAobG9nRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRmFpbGVkIHRvIGxvZyByZXNjaGVkdWxlOicsIGxvZ0Vycm9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhd2FpdCBzZW5kUmVzY2hlZHVsZUNvbmZpcm1hdGlvbihvbGREYXRlVGltZSwgZm9ybWF0dGVkRGF0ZVRpbWUpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgUmVzY2hlZHVsZSBlbWFpbCBzZW50Jyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlbWFpbEVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBzZW5kIHJlc2NoZWR1bGUgZW1haWw6JywgZW1haWxFcnJvcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgICAgICAgcmVwbHk6IGDinIUgKipBcHBvaW50bWVudCBSZXNjaGVkdWxlZCEqKlxcblxcbvCfk4UgKipOZXcgVGltZToqKiAke2Zvcm1hdHRlZERhdGVUaW1lfVxcblxcbllvdXIgYXBwb2ludG1lbnQgaGFzIGJlZW4gbW92ZWQgZnJvbSAke29sZERhdGVUaW1lfS5gLFxuICAgICAgICAgICAgICAgIG5ld1N0YXRlOiByZXNldFN0YXRlKCksXG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgYXZhaWxhYmxlU2xvdHMgPSBhd2FpdCBmaW5kTmV4dEF2YWlsYWJsZVNsb3RzKG5ld0RhdGUsIDIpO1xuXG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgICAgIHJlcGx5OiBgVGhlIHJlcXVlc3RlZCB0aW1lIGlzIG5vdCBhdmFpbGFibGUuIEhlcmUgYXJlIGFsdGVybmF0aXZlIHNsb3RzOmAsXG4gICAgICAgICAgICAgICAgc3VnZ2VzdGVkU2xvdHM6IGF2YWlsYWJsZVNsb3RzLFxuICAgICAgICAgICAgICAgIG5ld1N0YXRlOiBzZXRQZW5kaW5nU2xvdHMoXG4gICAgICAgICAgICAgICAgICAgIHNldE9yaWdpbmFsRXZlbnQoc3RhdGUsIHN0YXRlLm9yaWdpbmFsRXZlbnQpLFxuICAgICAgICAgICAgICAgICAgICBhdmFpbGFibGVTbG90cyxcbiAgICAgICAgICAgICAgICAgICAgJ1JFU0NIRURVTEUnXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUcnkgdG8gZmluZCB0aGUgb3JpZ2luYWwgYXBwb2ludG1lbnRcbiAgICBpZiAoIW9yaWdpbmFsRGF0ZSkge1xuICAgICAgICBjb25zdCBwYXJzZWQgPSBwYXJzZURhdGVUaW1lKG1lc3NhZ2UpO1xuICAgICAgICBpZiAocGFyc2VkLmRhdGUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBhd2FpdCBmaW5kRXZlbnRCeURhdGUocGFyc2VkLmRhdGUpO1xuICAgICAgICAgICAgICAgIGlmIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVwbHk6IGBJIGZvdW5kIHlvdXIgYXBwb2ludG1lbnQgb24gJHtmb3JtYXREYXRlVGltZShuZXcgRGF0ZShldmVudC5zdGFydC5kYXRlVGltZSkpfS4gV2hlbiB3b3VsZCB5b3UgbGlrZSB0byByZXNjaGVkdWxlIGl0IHRvP2AsXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdTdGF0ZTogc2V0T3JpZ2luYWxFdmVudCh7IC4uLnN0YXRlLCBjdXJyZW50SW50ZW50OiAnUkVTQ0hFRFVMRScgfSwgZXZlbnQgYXMgYW55KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXBseTogYEkgY291bGRuJ3QgZmluZCBhbiBhcHBvaW50bWVudCBvbiAke2Zvcm1hdERhdGUocGFyc2VkLmRhdGUpfS4gUGxlYXNlIGNoZWNrIHRoZSBkYXRlIGFuZCB0cnkgYWdhaW4uYCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1N0YXRlOiBzdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgZXZlbnQ6JywgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgIHJlcGx5OiBcIlRvIHJlc2NoZWR1bGUsIHBsZWFzZSB0ZWxsIG1lIHdoaWNoIGFwcG9pbnRtZW50IHlvdSdkIGxpa2UgdG8gbW92ZS4gRm9yIGV4YW1wbGU6IFxcXCJSZXNjaGVkdWxlIG15IGFwcG9pbnRtZW50IG9uIE1vbmRheSB0byBUdWVzZGF5IGF0IDNwbVxcXCIuXCIsXG4gICAgICAgICAgICBuZXdTdGF0ZTogeyAuLi5zdGF0ZSwgY3VycmVudEludGVudDogJ1JFU0NIRURVTEUnIH0sXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBGaW5kIHRoZSBvcmlnaW5hbCBldmVudFxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gYXdhaXQgZmluZEV2ZW50QnlEYXRlKG9yaWdpbmFsRGF0ZSk7XG5cbiAgICAgICAgaWYgKCFldmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgICAgICByZXBseTogYEkgY291bGRuJ3QgZmluZCBhbiBhcHBvaW50bWVudCBvbiAke2Zvcm1hdERhdGUob3JpZ2luYWxEYXRlKX0uIFBsZWFzZSBjaGVjayB0aGUgZGF0ZSBhbmQgdHJ5IGFnYWluLmAsXG4gICAgICAgICAgICAgICAgbmV3U3RhdGU6IHN0YXRlLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB3ZSBoYXZlIHRoZSBuZXcgZGF0ZS90aW1lLCB0cnkgdG8gcmVzY2hlZHVsZVxuICAgICAgICBpZiAobmV3RGF0ZSAmJiBuZXdUaW1lKSB7XG4gICAgICAgICAgICBjb25zdCBuZXdBcHBvaW50bWVudFRpbWUgPSBjb21iaW5lRGF0ZUFuZFRpbWUobmV3RGF0ZSwgbmV3VGltZSk7XG4gICAgICAgICAgICBjb25zdCBuZXdFbmRUaW1lID0gZ2V0RW5kVGltZShuZXdBcHBvaW50bWVudFRpbWUpO1xuXG4gICAgICAgICAgICBpZiAoaXNEYXRlSW5QYXN0KG5ld0FwcG9pbnRtZW50VGltZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgICAgICAgICByZXBseTogXCJJIGNhbid0IHJlc2NoZWR1bGUgdG8gYSB0aW1lIGluIHRoZSBwYXN0LiBQbGVhc2UgY2hvb3NlIGEgZnV0dXJlIGRhdGUgYW5kIHRpbWUuXCIsXG4gICAgICAgICAgICAgICAgICAgIG5ld1N0YXRlOiBzZXRPcmlnaW5hbEV2ZW50KHN0YXRlLCBldmVudCBhcyBhbnkpLFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaXNBdmFpbGFibGUgPSBhd2FpdCBjaGVja0F2YWlsYWJpbGl0eShuZXdBcHBvaW50bWVudFRpbWUsIG5ld0VuZFRpbWUpO1xuXG4gICAgICAgICAgICBpZiAoaXNBdmFpbGFibGUpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB1cGRhdGVFdmVudChldmVudC5pZCwgbmV3QXBwb2ludG1lbnRUaW1lLCBuZXdFbmRUaW1lKTtcbiAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXR0ZWREYXRlVGltZSA9IGZvcm1hdERhdGVUaW1lKG5ld0FwcG9pbnRtZW50VGltZSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2xkRGF0ZVRpbWUgPSBmb3JtYXREYXRlVGltZShuZXcgRGF0ZShldmVudC5zdGFydC5kYXRlVGltZSkpO1xuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgbG9nUmVzY2hlZHVsZShtZXNzYWdlLCBmb3JtYXR0ZWREYXRlVGltZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgTG9nZ2VkIHJlc2NoZWR1bGUgdG8gc2hlZXRzJyk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAobG9nRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBsb2cgcmVzY2hlZHVsZTonLCBsb2dFcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VuZFJlc2NoZWR1bGVDb25maXJtYXRpb24ob2xkRGF0ZVRpbWUsIGZvcm1hdHRlZERhdGVUaW1lKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+KchSBSZXNjaGVkdWxlIGVtYWlsIHNlbnQnKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlbWFpbEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gc2VuZCByZXNjaGVkdWxlIGVtYWlsOicsIGVtYWlsRXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgICAgICAgICAgIHJlcGx5OiBg4pyFICoqQXBwb2ludG1lbnQgUmVzY2hlZHVsZWQhKipcXG5cXG7wn5OFICoqTmV3IFRpbWU6KiogJHtmb3JtYXR0ZWREYXRlVGltZX1cXG5cXG5Zb3VyIGFwcG9pbnRtZW50IGhhcyBiZWVuIG1vdmVkIGZyb20gJHtvbGREYXRlVGltZX0uYCxcbiAgICAgICAgICAgICAgICAgICAgbmV3U3RhdGU6IHJlc2V0U3RhdGUoKSxcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXZhaWxhYmxlU2xvdHMgPSBhd2FpdCBmaW5kTmV4dEF2YWlsYWJsZVNsb3RzKG5ld0RhdGUsIDIpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgICAgICAgICAgcmVwbHk6IGBUaGUgcmVxdWVzdGVkIHRpbWUgaXMgbm90IGF2YWlsYWJsZS4gSGVyZSBhcmUgYWx0ZXJuYXRpdmUgc2xvdHM6YCxcbiAgICAgICAgICAgICAgICAgICAgc3VnZ2VzdGVkU2xvdHM6IGF2YWlsYWJsZVNsb3RzLFxuICAgICAgICAgICAgICAgICAgICBuZXdTdGF0ZTogc2V0UGVuZGluZ1Nsb3RzKFxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0T3JpZ2luYWxFdmVudChzdGF0ZSwgZXZlbnQgYXMgYW55KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF2YWlsYWJsZVNsb3RzLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ1JFU0NIRURVTEUnXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBc2sgZm9yIG5ldyBkYXRlL3RpbWVcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgIHJlcGx5OiBgSSBmb3VuZCB5b3VyIGFwcG9pbnRtZW50IG9uICR7Zm9ybWF0RGF0ZVRpbWUobmV3IERhdGUoZXZlbnQuc3RhcnQuZGF0ZVRpbWUpKX0uIFdoZW4gd291bGQgeW91IGxpa2UgdG8gcmVzY2hlZHVsZSBpdCB0bz9gLFxuICAgICAgICAgICAgbmV3U3RhdGU6IHNldE9yaWdpbmFsRXZlbnQoeyAuLi5zdGF0ZSwgY3VycmVudEludGVudDogJ1JFU0NIRURVTEUnIH0sIGV2ZW50IGFzIGFueSksXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdSZXNjaGVkdWxlIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgIHJlcGx5OiAnSSBlbmNvdW50ZXJlZCBhbiBlcnJvciB3aGlsZSB0cnlpbmcgdG8gcmVzY2hlZHVsZS4gUGxlYXNlIHRyeSBhZ2Fpbi4nLFxuICAgICAgICAgICAgbmV3U3RhdGU6IHN0YXRlLFxuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8gSGFuZGxlIGNhbmNlbGxhdGlvbiBpbnRlbnRcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUNhbmNlbGxhdGlvbihcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgc3RhdGU6IENvbnZlcnNhdGlvblN0YXRlXG4pOiBQcm9taXNlPE5leHRSZXNwb25zZTxDaGF0UmVzcG9uc2U+PiB7XG4gICAgY29uc3QgeyBkYXRlIH0gPSBwYXJzZURhdGVUaW1lKG1lc3NhZ2UpO1xuXG4gICAgaWYgKCFkYXRlKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgICByZXBseTogXCJXaGljaCBhcHBvaW50bWVudCB3b3VsZCB5b3UgbGlrZSB0byBjYW5jZWw/IFBsZWFzZSBzcGVjaWZ5IHRoZSBkYXRlLCBmb3IgZXhhbXBsZTogXFxcIkNhbmNlbCBteSBhcHBvaW50bWVudCBvbiBNb25kYXlcXFwiIG9yIFxcXCJDYW5jZWwgYXBwb2ludG1lbnQgb24gSmFudWFyeSAyMHRoXFxcIi5cIixcbiAgICAgICAgICAgIG5ld1N0YXRlOiB7IC4uLnN0YXRlLCBjdXJyZW50SW50ZW50OiAnQ0FOQ0VMJyB9LFxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZXZlbnQgPSBhd2FpdCBmaW5kRXZlbnRCeURhdGUoZGF0ZSk7XG5cbiAgICAgICAgaWYgKCFldmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgICAgICByZXBseTogYEkgY291bGRuJ3QgZmluZCBhbiBhcHBvaW50bWVudCBvbiAke2Zvcm1hdERhdGUoZGF0ZSl9LiBQbGVhc2UgY2hlY2sgdGhlIGRhdGUgYW5kIHRyeSBhZ2Fpbi5gLFxuICAgICAgICAgICAgICAgIG5ld1N0YXRlOiBzdGF0ZSxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZm9ybWF0dGVkRGF0ZVRpbWUgPSBmb3JtYXREYXRlVGltZShuZXcgRGF0ZShldmVudC5zdGFydC5kYXRlVGltZSkpO1xuXG4gICAgICAgIC8vIERlbGV0ZSB0aGUgZXZlbnRcbiAgICAgICAgYXdhaXQgZGVsZXRlRXZlbnQoZXZlbnQuaWQpO1xuXG4gICAgICAgIC8vIExvZyBhbmQgc2VuZCBlbWFpbCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZ1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgbG9nQ2FuY2VsbGF0aW9uKG1lc3NhZ2UsIGZvcm1hdHRlZERhdGVUaW1lKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgTG9nZ2VkIGNhbmNlbGxhdGlvbiB0byBzaGVldHMnKTtcbiAgICAgICAgfSBjYXRjaCAobG9nRXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gbG9nIGNhbmNlbGxhdGlvbjonLCBsb2dFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgc2VuZENhbmNlbGxhdGlvbkNvbmZpcm1hdGlvbihmb3JtYXR0ZWREYXRlVGltZSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIENhbmNlbGxhdGlvbiBlbWFpbCBzZW50Jyk7XG4gICAgICAgIH0gY2F0Y2ggKGVtYWlsRXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gc2VuZCBjYW5jZWxsYXRpb24gZW1haWw6JywgZW1haWxFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgcmVwbHk6IGDinIUgKipBcHBvaW50bWVudCBDYW5jZWxsZWQqKlxcblxcbllvdXIgYXBwb2ludG1lbnQgb24gJHtmb3JtYXR0ZWREYXRlVGltZX0gaGFzIGJlZW4gY2FuY2VsbGVkLiBBIGNvbmZpcm1hdGlvbiBlbWFpbCBoYXMgYmVlbiBzZW50LmAsXG4gICAgICAgICAgICBuZXdTdGF0ZTogcmVzZXRTdGF0ZSgpLFxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignQ2FuY2VsbGF0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgIHJlcGx5OiAnSSBlbmNvdW50ZXJlZCBhbiBlcnJvciB3aGlsZSBjYW5jZWxsaW5nIHRoZSBhcHBvaW50bWVudC4gUGxlYXNlIHRyeSBhZ2Fpbi4nLFxuICAgICAgICAgICAgbmV3U3RhdGU6IHN0YXRlLFxuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLy8gSGFuZGxlIGNvbmZpcm1hdGlvblxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlQ29uZmlybWF0aW9uKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBzdGF0ZTogQ29udmVyc2F0aW9uU3RhdGVcbik6IFByb21pc2U8TmV4dFJlc3BvbnNlPENoYXRSZXNwb25zZT4+IHtcbiAgICAvLyBJZiBhd2FpdGluZyBjb25maXJtYXRpb24gZm9yIHNvbWV0aGluZyBzcGVjaWZpYywgaGFuZGxlIGl0XG4gICAgaWYgKHN0YXRlLmF3YWl0aW5nQ29uZmlybWF0aW9uICYmIHN0YXRlLnRhcmdldERhdGUgJiYgc3RhdGUudGFyZ2V0VGltZSkge1xuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoc3RhdGUudGFyZ2V0RGF0ZSk7XG4gICAgICAgIGNvbnN0IGFwcG9pbnRtZW50VGltZSA9IGNvbWJpbmVEYXRlQW5kVGltZShkYXRlLCBzdGF0ZS50YXJnZXRUaW1lKTtcbiAgICAgICAgY29uc3QgZW5kVGltZSA9IGdldEVuZFRpbWUoYXBwb2ludG1lbnRUaW1lKTtcblxuICAgICAgICBhd2FpdCBjcmVhdGVFdmVudCgnQXBwb2ludG1lbnQgLSBWb2ljZSBTY2hlZHVsZXInLCBhcHBvaW50bWVudFRpbWUsIGVuZFRpbWUpO1xuICAgICAgICBjb25zdCBmb3JtYXR0ZWREYXRlVGltZSA9IGZvcm1hdERhdGVUaW1lKGFwcG9pbnRtZW50VGltZSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGxvZ0Jvb2tpbmcobWVzc2FnZSwgZm9ybWF0dGVkRGF0ZVRpbWUpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ+KchSBMb2dnZWQgY29uZmlybWF0aW9uIHRvIHNoZWV0cycpO1xuICAgICAgICB9IGNhdGNoIChsb2dFcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEZhaWxlZCB0byBsb2cgY29uZmlybWF0aW9uOicsIGxvZ0Vycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBzZW5kQm9va2luZ0NvbmZpcm1hdGlvbihmb3JtYXR0ZWREYXRlVGltZSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIENvbmZpcm1hdGlvbiBlbWFpbCBzZW50Jyk7XG4gICAgICAgIH0gY2F0Y2ggKGVtYWlsRXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGYWlsZWQgdG8gc2VuZCBjb25maXJtYXRpb24gZW1haWw6JywgZW1haWxFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgcmVwbHk6IGDinIUgKipBcHBvaW50bWVudCBDb25maXJtZWQhKipcXG5cXG7wn5OFICoqRGF0ZToqKiAke2Zvcm1hdHRlZERhdGVUaW1lfVxcblxcbllvdXIgYXBwb2ludG1lbnQgaGFzIGJlZW4gYm9va2VkLmAsXG4gICAgICAgICAgICBuZXdTdGF0ZTogcmVzZXRTdGF0ZSgpLFxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgcmVwbHk6IFwiSSdtIG5vdCBzdXJlIHdoYXQgeW91J2QgbGlrZSB0byBjb25maXJtLiBDb3VsZCB5b3UgcGxlYXNlIHByb3ZpZGUgbW9yZSBkZXRhaWxzP1wiLFxuICAgICAgICBuZXdTdGF0ZTogc3RhdGUsXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgfSk7XG59XG5cbi8vIEhlbHBlciB0byBmb3JtYXQgZGF0ZSBmb3IgZGlzcGxheVxuZnVuY3Rpb24gZm9ybWF0RGF0ZShkYXRlOiBEYXRlKTogc3RyaW5nIHtcbiAgICByZXR1cm4gZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLVVTJywge1xuICAgICAgICB3ZWVrZGF5OiAnbG9uZycsXG4gICAgICAgIG1vbnRoOiAnbG9uZycsXG4gICAgICAgIGRheTogJ251bWVyaWMnLFxuICAgIH0pO1xufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInBhcnNlSW50ZW50IiwicGFyc2VEYXRlVGltZSIsImNvbWJpbmVEYXRlQW5kVGltZSIsImlzRGF0ZUluUGFzdCIsImZvcm1hdERhdGVUaW1lIiwicGFyc2VSZXNjaGVkdWxlRGF0ZXMiLCJjcmVhdGVJbml0aWFsU3RhdGUiLCJyZXNldFN0YXRlIiwic2V0UGVuZGluZ1Nsb3RzIiwiZ2V0U2VsZWN0ZWRTbG90Iiwic2V0T3JpZ2luYWxFdmVudCIsImNsZWFyUGVuZGluZ1Nsb3RzIiwiY2hlY2tBdmFpbGFiaWxpdHkiLCJmaW5kTmV4dEF2YWlsYWJsZVNsb3RzIiwiY3JlYXRlRXZlbnQiLCJmaW5kRXZlbnRCeURhdGUiLCJ1cGRhdGVFdmVudCIsImRlbGV0ZUV2ZW50IiwiZ2V0RW5kVGltZSIsImxvZ0Jvb2tpbmciLCJsb2dSZXNjaGVkdWxlIiwibG9nQ2FuY2VsbGF0aW9uIiwic2VuZEJvb2tpbmdDb25maXJtYXRpb24iLCJzZW5kUmVzY2hlZHVsZUNvbmZpcm1hdGlvbiIsInNlbmRDYW5jZWxsYXRpb25Db25maXJtYXRpb24iLCJQT1NUIiwicmVxdWVzdCIsImJvZHkiLCJqc29uIiwibWVzc2FnZSIsInNlc3Npb25TdGF0ZSIsImN1cnJlbnRTdGF0ZSIsImludGVudCIsInR5cGUiLCJoYW5kbGVTbG90U2VsZWN0aW9uIiwic2xvdEluZGV4IiwiaGFuZGxlQm9va2luZyIsImhhbmRsZVJlc2NoZWR1bGUiLCJoYW5kbGVDYW5jZWxsYXRpb24iLCJoYW5kbGVDb25maXJtYXRpb24iLCJyZXBseSIsIm5ld1N0YXRlIiwic3VjY2VzcyIsImVycm9yIiwiY29uc29sZSIsInN0YXRlIiwiZGF0ZSIsInRpbWUiLCJjdXJyZW50SW50ZW50IiwiZm9ybWF0RGF0ZSIsInRhcmdldERhdGUiLCJ0b0lTT1N0cmluZyIsImFwcG9pbnRtZW50VGltZSIsImVuZFRpbWUiLCJpc0F2YWlsYWJsZSIsImV2ZW50IiwiZm9ybWF0dGVkRGF0ZVRpbWUiLCJsb2ciLCJsb2dFcnJvciIsImVtYWlsU2VudCIsImVtYWlsRXJyb3IiLCJhdmFpbGFibGVTbG90cyIsImxlbmd0aCIsInN1Z2dlc3RlZFNsb3RzIiwic2VsZWN0ZWRTbG90Iiwic3RhcnRUaW1lIiwiRGF0ZSIsInN0YXJ0IiwiZW5kIiwib3JpZ2luYWxFdmVudCIsImlkIiwib2xkRGF0ZVRpbWUiLCJmb3JtYXR0ZWRPbGREYXRlVGltZSIsIm9yaWdpbmFsRGF0ZSIsIm5ld0RhdGUiLCJuZXdUaW1lIiwibmV3QXBwb2ludG1lbnRUaW1lIiwibmV3RW5kVGltZSIsInBhcnNlZCIsImRhdGVUaW1lIiwiYXdhaXRpbmdDb25maXJtYXRpb24iLCJ0YXJnZXRUaW1lIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwid2Vla2RheSIsIm1vbnRoIiwiZGF5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/agent/conversation.ts":
/*!***************************************!*\
  !*** ./src/lib/agent/conversation.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearPendingSlots: () => (/* binding */ clearPendingSlots),\n/* harmony export */   createInitialState: () => (/* binding */ createInitialState),\n/* harmony export */   getCurrentIntent: () => (/* binding */ getCurrentIntent),\n/* harmony export */   getSelectedSlot: () => (/* binding */ getSelectedSlot),\n/* harmony export */   hasPendingSlots: () => (/* binding */ hasPendingSlots),\n/* harmony export */   isAwaitingConfirmation: () => (/* binding */ isAwaitingConfirmation),\n/* harmony export */   resetState: () => (/* binding */ resetState),\n/* harmony export */   setAwaitingConfirmation: () => (/* binding */ setAwaitingConfirmation),\n/* harmony export */   setOriginalEvent: () => (/* binding */ setOriginalEvent),\n/* harmony export */   setPendingSlots: () => (/* binding */ setPendingSlots)\n/* harmony export */ });\n// Create initial empty conversation state\nfunction createInitialState() {\n    return {\n        currentIntent: null,\n        pendingSlots: undefined,\n        originalEvent: undefined,\n        awaitingConfirmation: false,\n        targetDate: undefined,\n        targetTime: undefined\n    };\n}\n// Reset state after completing an action\nfunction resetState() {\n    return createInitialState();\n}\n// Update state for pending slot selection\nfunction setPendingSlots(state, slots, intent) {\n    return {\n        ...state,\n        currentIntent: intent,\n        pendingSlots: slots,\n        awaitingConfirmation: false\n    };\n}\n// Update state for awaiting confirmation\nfunction setAwaitingConfirmation(state, targetDate, targetTime) {\n    return {\n        ...state,\n        awaitingConfirmation: true,\n        targetDate,\n        targetTime\n    };\n}\n// Store original event for rescheduling\nfunction setOriginalEvent(state, event) {\n    return {\n        ...state,\n        originalEvent: event\n    };\n}\n// Clear pending slots after selection\nfunction clearPendingSlots(state) {\n    return {\n        ...state,\n        pendingSlots: undefined\n    };\n}\n// Get selected slot from pending slots\nfunction getSelectedSlot(state, index) {\n    if (!state.pendingSlots || index >= state.pendingSlots.length) {\n        return null;\n    }\n    return state.pendingSlots[index];\n}\n// Check if state has pending slots\nfunction hasPendingSlots(state) {\n    return !!state.pendingSlots && state.pendingSlots.length > 0;\n}\n// Check if state is awaiting confirmation\nfunction isAwaitingConfirmation(state) {\n    return !!state.awaitingConfirmation;\n}\n// Get current intent from state\nfunction getCurrentIntent(state) {\n    return state.currentIntent;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2FnZW50L2NvbnZlcnNhdGlvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBRUEsMENBQTBDO0FBQ25DLFNBQVNBO0lBQ1osT0FBTztRQUNIQyxlQUFlO1FBQ2ZDLGNBQWNDO1FBQ2RDLGVBQWVEO1FBQ2ZFLHNCQUFzQjtRQUN0QkMsWUFBWUg7UUFDWkksWUFBWUo7SUFDaEI7QUFDSjtBQUVBLHlDQUF5QztBQUNsQyxTQUFTSztJQUNaLE9BQU9SO0FBQ1g7QUFFQSwwQ0FBMEM7QUFDbkMsU0FBU1MsZ0JBQ1pDLEtBQXdCLEVBQ3hCQyxLQUFtQixFQUNuQkMsTUFBNkI7SUFFN0IsT0FBTztRQUNILEdBQUdGLEtBQUs7UUFDUlQsZUFBZVc7UUFDZlYsY0FBY1M7UUFDZE4sc0JBQXNCO0lBQzFCO0FBQ0o7QUFFQSx5Q0FBeUM7QUFDbEMsU0FBU1Esd0JBQ1pILEtBQXdCLEVBQ3hCSixVQUFrQixFQUNsQkMsVUFBa0I7SUFFbEIsT0FBTztRQUNILEdBQUdHLEtBQUs7UUFDUkwsc0JBQXNCO1FBQ3RCQztRQUNBQztJQUNKO0FBQ0o7QUFFQSx3Q0FBd0M7QUFDakMsU0FBU08saUJBQ1pKLEtBQXdCLEVBQ3hCSyxLQUFrRTtJQUVsRSxPQUFPO1FBQ0gsR0FBR0wsS0FBSztRQUNSTixlQUFlVztJQUNuQjtBQUNKO0FBRUEsc0NBQXNDO0FBQy9CLFNBQVNDLGtCQUFrQk4sS0FBd0I7SUFDdEQsT0FBTztRQUNILEdBQUdBLEtBQUs7UUFDUlIsY0FBY0M7SUFDbEI7QUFDSjtBQUVBLHVDQUF1QztBQUNoQyxTQUFTYyxnQkFDWlAsS0FBd0IsRUFDeEJRLEtBQWE7SUFFYixJQUFJLENBQUNSLE1BQU1SLFlBQVksSUFBSWdCLFNBQVNSLE1BQU1SLFlBQVksQ0FBQ2lCLE1BQU0sRUFBRTtRQUMzRCxPQUFPO0lBQ1g7SUFDQSxPQUFPVCxNQUFNUixZQUFZLENBQUNnQixNQUFNO0FBQ3BDO0FBRUEsbUNBQW1DO0FBQzVCLFNBQVNFLGdCQUFnQlYsS0FBd0I7SUFDcEQsT0FBTyxDQUFDLENBQUNBLE1BQU1SLFlBQVksSUFBSVEsTUFBTVIsWUFBWSxDQUFDaUIsTUFBTSxHQUFHO0FBQy9EO0FBRUEsMENBQTBDO0FBQ25DLFNBQVNFLHVCQUF1QlgsS0FBd0I7SUFDM0QsT0FBTyxDQUFDLENBQUNBLE1BQU1MLG9CQUFvQjtBQUN2QztBQUVBLGdDQUFnQztBQUN6QixTQUFTaUIsaUJBQWlCWixLQUF3QjtJQUNyRCxPQUFPQSxNQUFNVCxhQUFhO0FBQzlCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWR2aXNvci1hcHBvaW50bWVudC1zY2hlZHVsZXIvLi9zcmMvbGliL2FnZW50L2NvbnZlcnNhdGlvbi50cz80NjM1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnZlcnNhdGlvblN0YXRlLCBTbG90T3B0aW9uIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vLyBDcmVhdGUgaW5pdGlhbCBlbXB0eSBjb252ZXJzYXRpb24gc3RhdGVcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJbml0aWFsU3RhdGUoKTogQ29udmVyc2F0aW9uU3RhdGUge1xuICAgIHJldHVybiB7XG4gICAgICAgIGN1cnJlbnRJbnRlbnQ6IG51bGwsXG4gICAgICAgIHBlbmRpbmdTbG90czogdW5kZWZpbmVkLFxuICAgICAgICBvcmlnaW5hbEV2ZW50OiB1bmRlZmluZWQsXG4gICAgICAgIGF3YWl0aW5nQ29uZmlybWF0aW9uOiBmYWxzZSxcbiAgICAgICAgdGFyZ2V0RGF0ZTogdW5kZWZpbmVkLFxuICAgICAgICB0YXJnZXRUaW1lOiB1bmRlZmluZWQsXG4gICAgfTtcbn1cblxuLy8gUmVzZXQgc3RhdGUgYWZ0ZXIgY29tcGxldGluZyBhbiBhY3Rpb25cbmV4cG9ydCBmdW5jdGlvbiByZXNldFN0YXRlKCk6IENvbnZlcnNhdGlvblN0YXRlIHtcbiAgICByZXR1cm4gY3JlYXRlSW5pdGlhbFN0YXRlKCk7XG59XG5cbi8vIFVwZGF0ZSBzdGF0ZSBmb3IgcGVuZGluZyBzbG90IHNlbGVjdGlvblxuZXhwb3J0IGZ1bmN0aW9uIHNldFBlbmRpbmdTbG90cyhcbiAgICBzdGF0ZTogQ29udmVyc2F0aW9uU3RhdGUsXG4gICAgc2xvdHM6IFNsb3RPcHRpb25bXSxcbiAgICBpbnRlbnQ6ICdCT09LJyB8ICdSRVNDSEVEVUxFJ1xuKTogQ29udmVyc2F0aW9uU3RhdGUge1xuICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICBjdXJyZW50SW50ZW50OiBpbnRlbnQsXG4gICAgICAgIHBlbmRpbmdTbG90czogc2xvdHMsXG4gICAgICAgIGF3YWl0aW5nQ29uZmlybWF0aW9uOiBmYWxzZSxcbiAgICB9O1xufVxuXG4vLyBVcGRhdGUgc3RhdGUgZm9yIGF3YWl0aW5nIGNvbmZpcm1hdGlvblxuZXhwb3J0IGZ1bmN0aW9uIHNldEF3YWl0aW5nQ29uZmlybWF0aW9uKFxuICAgIHN0YXRlOiBDb252ZXJzYXRpb25TdGF0ZSxcbiAgICB0YXJnZXREYXRlOiBzdHJpbmcsXG4gICAgdGFyZ2V0VGltZTogc3RyaW5nXG4pOiBDb252ZXJzYXRpb25TdGF0ZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGF3YWl0aW5nQ29uZmlybWF0aW9uOiB0cnVlLFxuICAgICAgICB0YXJnZXREYXRlLFxuICAgICAgICB0YXJnZXRUaW1lLFxuICAgIH07XG59XG5cbi8vIFN0b3JlIG9yaWdpbmFsIGV2ZW50IGZvciByZXNjaGVkdWxpbmdcbmV4cG9ydCBmdW5jdGlvbiBzZXRPcmlnaW5hbEV2ZW50KFxuICAgIHN0YXRlOiBDb252ZXJzYXRpb25TdGF0ZSxcbiAgICBldmVudDogeyBpZDogc3RyaW5nOyBzdW1tYXJ5OiBzdHJpbmc7IHN0YXJ0OiBzdHJpbmc7IGVuZDogc3RyaW5nIH1cbik6IENvbnZlcnNhdGlvblN0YXRlIHtcbiAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgb3JpZ2luYWxFdmVudDogZXZlbnQsXG4gICAgfTtcbn1cblxuLy8gQ2xlYXIgcGVuZGluZyBzbG90cyBhZnRlciBzZWxlY3Rpb25cbmV4cG9ydCBmdW5jdGlvbiBjbGVhclBlbmRpbmdTbG90cyhzdGF0ZTogQ29udmVyc2F0aW9uU3RhdGUpOiBDb252ZXJzYXRpb25TdGF0ZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIHBlbmRpbmdTbG90czogdW5kZWZpbmVkLFxuICAgIH07XG59XG5cbi8vIEdldCBzZWxlY3RlZCBzbG90IGZyb20gcGVuZGluZyBzbG90c1xuZXhwb3J0IGZ1bmN0aW9uIGdldFNlbGVjdGVkU2xvdChcbiAgICBzdGF0ZTogQ29udmVyc2F0aW9uU3RhdGUsXG4gICAgaW5kZXg6IG51bWJlclxuKTogU2xvdE9wdGlvbiB8IG51bGwge1xuICAgIGlmICghc3RhdGUucGVuZGluZ1Nsb3RzIHx8IGluZGV4ID49IHN0YXRlLnBlbmRpbmdTbG90cy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiBzdGF0ZS5wZW5kaW5nU2xvdHNbaW5kZXhdO1xufVxuXG4vLyBDaGVjayBpZiBzdGF0ZSBoYXMgcGVuZGluZyBzbG90c1xuZXhwb3J0IGZ1bmN0aW9uIGhhc1BlbmRpbmdTbG90cyhzdGF0ZTogQ29udmVyc2F0aW9uU3RhdGUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gISFzdGF0ZS5wZW5kaW5nU2xvdHMgJiYgc3RhdGUucGVuZGluZ1Nsb3RzLmxlbmd0aCA+IDA7XG59XG5cbi8vIENoZWNrIGlmIHN0YXRlIGlzIGF3YWl0aW5nIGNvbmZpcm1hdGlvblxuZXhwb3J0IGZ1bmN0aW9uIGlzQXdhaXRpbmdDb25maXJtYXRpb24oc3RhdGU6IENvbnZlcnNhdGlvblN0YXRlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhc3RhdGUuYXdhaXRpbmdDb25maXJtYXRpb247XG59XG5cbi8vIEdldCBjdXJyZW50IGludGVudCBmcm9tIHN0YXRlXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VycmVudEludGVudChzdGF0ZTogQ29udmVyc2F0aW9uU3RhdGUpOiBzdHJpbmcgfCBudWxsIHtcbiAgICByZXR1cm4gc3RhdGUuY3VycmVudEludGVudDtcbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVJbml0aWFsU3RhdGUiLCJjdXJyZW50SW50ZW50IiwicGVuZGluZ1Nsb3RzIiwidW5kZWZpbmVkIiwib3JpZ2luYWxFdmVudCIsImF3YWl0aW5nQ29uZmlybWF0aW9uIiwidGFyZ2V0RGF0ZSIsInRhcmdldFRpbWUiLCJyZXNldFN0YXRlIiwic2V0UGVuZGluZ1Nsb3RzIiwic3RhdGUiLCJzbG90cyIsImludGVudCIsInNldEF3YWl0aW5nQ29uZmlybWF0aW9uIiwic2V0T3JpZ2luYWxFdmVudCIsImV2ZW50IiwiY2xlYXJQZW5kaW5nU2xvdHMiLCJnZXRTZWxlY3RlZFNsb3QiLCJpbmRleCIsImxlbmd0aCIsImhhc1BlbmRpbmdTbG90cyIsImlzQXdhaXRpbmdDb25maXJtYXRpb24iLCJnZXRDdXJyZW50SW50ZW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/agent/conversation.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/agent/date-parser.ts":
/*!**************************************!*\
  !*** ./src/lib/agent/date-parser.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   combineDateAndTime: () => (/* binding */ combineDateAndTime),\n/* harmony export */   formatDate: () => (/* binding */ formatDate),\n/* harmony export */   formatDateTime: () => (/* binding */ formatDateTime),\n/* harmony export */   formatTime: () => (/* binding */ formatTime),\n/* harmony export */   isDateInPast: () => (/* binding */ isDateInPast),\n/* harmony export */   parseDateTime: () => (/* binding */ parseDateTime),\n/* harmony export */   parseRescheduleDates: () => (/* binding */ parseRescheduleDates)\n/* harmony export */ });\n// Date parsing utilities for natural language date/time extraction\n// Month names for parsing\nconst MONTHS = {\n    january: 0,\n    jan: 0,\n    february: 1,\n    feb: 1,\n    march: 2,\n    mar: 2,\n    april: 3,\n    apr: 3,\n    may: 4,\n    june: 5,\n    jun: 5,\n    july: 6,\n    jul: 6,\n    august: 7,\n    aug: 7,\n    september: 8,\n    sep: 8,\n    sept: 8,\n    october: 9,\n    oct: 9,\n    november: 10,\n    nov: 10,\n    december: 11,\n    dec: 11\n};\n// Day names for relative parsing\nconst DAYS = {\n    sunday: 0,\n    sun: 0,\n    monday: 1,\n    mon: 1,\n    tuesday: 2,\n    tue: 2,\n    tues: 2,\n    wednesday: 3,\n    wed: 3,\n    thursday: 4,\n    thu: 4,\n    thur: 4,\n    thurs: 4,\n    friday: 5,\n    fri: 5,\n    saturday: 6,\n    sat: 6\n};\n// Parse natural language date/time from message\nfunction parseDateTime(message) {\n    const lowerMessage = message.toLowerCase();\n    let date = null;\n    let time = null;\n    // Parse relative dates\n    if (lowerMessage.includes(\"today\")) {\n        date = new Date();\n    } else if (lowerMessage.includes(\"tomorrow\")) {\n        date = new Date();\n        date.setDate(date.getDate() + 1);\n    } else if (lowerMessage.includes(\"day after tomorrow\")) {\n        date = new Date();\n        date.setDate(date.getDate() + 2);\n    }\n    // Parse \"next [day]\" pattern\n    const nextDayMatch = lowerMessage.match(/next\\s+(monday|tuesday|wednesday|thursday|friday|saturday|sunday|mon|tue|wed|thu|fri|sat|sun)/i);\n    if (nextDayMatch) {\n        const targetDay = DAYS[nextDayMatch[1].toLowerCase()];\n        if (targetDay !== undefined) {\n            date = getNextDayOfWeek(targetDay);\n        }\n    }\n    // Parse \"this [day]\" pattern\n    const thisDayMatch = lowerMessage.match(/this\\s+(monday|tuesday|wednesday|thursday|friday|saturday|sunday|mon|tue|wed|thu|fri|sat|sun)/i);\n    if (thisDayMatch) {\n        const targetDay = DAYS[thisDayMatch[1].toLowerCase()];\n        if (targetDay !== undefined) {\n            date = getThisDayOfWeek(targetDay);\n        }\n    }\n    // Parse explicit date formats: \"January 15\", \"Jan 15th\", \"15 January\", \"15th of January\"\n    const explicitDatePatterns = [\n        /(\\d{1,2})(?:st|nd|rd|th)?\\s*(?:of\\s*)?(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|jun|jul|aug|sep|sept|oct|nov|dec)/i,\n        /(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|jun|jul|aug|sep|sept|oct|nov|dec)\\s*(\\d{1,2})(?:st|nd|rd|th)?/i\n    ];\n    for (const pattern of explicitDatePatterns){\n        const match = lowerMessage.match(pattern);\n        if (match) {\n            let day;\n            let month;\n            if (isNaN(parseInt(match[1]))) {\n                // Month first format\n                month = MONTHS[match[1].toLowerCase()];\n                day = parseInt(match[2]);\n            } else {\n                // Day first format\n                day = parseInt(match[1]);\n                month = MONTHS[match[2].toLowerCase()];\n            }\n            if (!isNaN(day) && month !== undefined) {\n                date = new Date();\n                date.setMonth(month);\n                date.setDate(day);\n                // If the date is in the past, assume next year\n                if (date < new Date()) {\n                    date.setFullYear(date.getFullYear() + 1);\n                }\n            }\n            break;\n        }\n    }\n    // Parse time: \"at 2pm\", \"at 2:30 pm\", \"at 14:00\"\n    const timePatterns = [\n        /(?:at\\s+)?(\\d{1,2}):(\\d{2})\\s*(am|pm)?/i,\n        /(?:at\\s+)?(\\d{1,2})\\s*(am|pm)/i\n    ];\n    for (const pattern of timePatterns){\n        const match = lowerMessage.match(pattern);\n        if (match) {\n            let hours = parseInt(match[1]);\n            const minutes = match[2] && !isNaN(parseInt(match[2])) ? parseInt(match[2]) : 0;\n            const meridiem = match[3] || match[2];\n            if (meridiem) {\n                if (meridiem.toLowerCase() === \"pm\" && hours < 12) {\n                    hours += 12;\n                } else if (meridiem.toLowerCase() === \"am\" && hours === 12) {\n                    hours = 0;\n                }\n            }\n            time = `${hours.toString().padStart(2, \"0\")}:${minutes.toString().padStart(2, \"0\")}`;\n            break;\n        }\n    }\n    return {\n        date,\n        time\n    };\n}\n// Get the next occurrence of a day of week\nfunction getNextDayOfWeek(dayOfWeek) {\n    const date = new Date();\n    const currentDay = date.getDay();\n    const daysUntil = (dayOfWeek - currentDay + 7) % 7 || 7; // At least 1 day ahead\n    date.setDate(date.getDate() + daysUntil);\n    return date;\n}\n// Get this week's occurrence of a day\nfunction getThisDayOfWeek(dayOfWeek) {\n    const date = new Date();\n    const currentDay = date.getDay();\n    const diff = dayOfWeek - currentDay;\n    date.setDate(date.getDate() + diff);\n    return date;\n}\n// Combine date and time into a single Date object\nfunction combineDateAndTime(date, time) {\n    const result = new Date(date);\n    const [hours, minutes] = time.split(\":\").map(Number);\n    result.setHours(hours, minutes, 0, 0);\n    return result;\n}\n// Validate that date is not in the past\nfunction isDateInPast(date) {\n    const now = new Date();\n    return date < now;\n}\n// Format date for display\nfunction formatDateTime(date) {\n    return date.toLocaleString(\"en-US\", {\n        weekday: \"short\",\n        month: \"short\",\n        day: \"numeric\",\n        year: \"numeric\",\n        hour: \"numeric\",\n        minute: \"2-digit\",\n        hour12: true\n    });\n}\n// Format just the date\nfunction formatDate(date) {\n    return date.toLocaleDateString(\"en-US\", {\n        weekday: \"long\",\n        month: \"long\",\n        day: \"numeric\",\n        year: \"numeric\"\n    });\n}\n// Format just the time\nfunction formatTime(date) {\n    return date.toLocaleTimeString(\"en-US\", {\n        hour: \"numeric\",\n        minute: \"2-digit\",\n        hour12: true\n    });\n}\n// Parse \"from X to Y\" for rescheduling\nfunction parseRescheduleDates(message) {\n    const lowerMessage = message.toLowerCase();\n    // Split message by \"to\" to get old and new dates\n    const parts = lowerMessage.split(/\\s+to\\s+/);\n    if (parts.length >= 2) {\n        const originalParsed = parseDateTime(parts[0]);\n        const newParsed = parseDateTime(parts[1]);\n        return {\n            originalDate: originalParsed.date,\n            newDate: newParsed.date,\n            newTime: newParsed.time\n        };\n    }\n    // Fallback: try to find any date in the message\n    const parsed = parseDateTime(message);\n    return {\n        originalDate: parsed.date,\n        newDate: null,\n        newTime: parsed.time\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0lBQ1Y7QUFDSjtBQUVBLHVCQUF1QjtBQUNoQixTQUFTTSxXQUFXbEQsSUFBVTtJQUNqQyxPQUFPQSxLQUFLbUQsa0JBQWtCLENBQUMsU0FBUztRQUNwQ04sTUFBTTtRQUNOQyxRQUFRO1FBQ1JDLFFBQVE7SUFDWjtBQUNKO0FBRUEsdUNBQXVDO0FBQ2hDLFNBQVNLLHFCQUFxQnZELE9BQWU7SUFLaEQsTUFBTUMsZUFBZUQsUUFBUUUsV0FBVztJQUV4QyxpREFBaUQ7SUFDakQsTUFBTXNELFFBQVF2RCxhQUFhcUMsS0FBSyxDQUFDO0lBRWpDLElBQUlrQixNQUFNQyxNQUFNLElBQUksR0FBRztRQUNuQixNQUFNQyxpQkFBaUIzRCxjQUFjeUQsS0FBSyxDQUFDLEVBQUU7UUFDN0MsTUFBTUcsWUFBWTVELGNBQWN5RCxLQUFLLENBQUMsRUFBRTtRQUV4QyxPQUFPO1lBQ0hJLGNBQWNGLGVBQWV2RCxJQUFJO1lBQ2pDMEQsU0FBU0YsVUFBVXhELElBQUk7WUFDdkIyRCxTQUFTSCxVQUFVdkQsSUFBSTtRQUMzQjtJQUNKO0lBRUEsZ0RBQWdEO0lBQ2hELE1BQU0yRCxTQUFTaEUsY0FBY0M7SUFDN0IsT0FBTztRQUNINEQsY0FBY0csT0FBTzVELElBQUk7UUFDekIwRCxTQUFTO1FBQ1RDLFNBQVNDLE9BQU8zRCxJQUFJO0lBQ3hCO0FBQ0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZHZpc29yLWFwcG9pbnRtZW50LXNjaGVkdWxlci8uL3NyYy9saWIvYWdlbnQvZGF0ZS1wYXJzZXIudHM/MGM5OSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBEYXRlIHBhcnNpbmcgdXRpbGl0aWVzIGZvciBuYXR1cmFsIGxhbmd1YWdlIGRhdGUvdGltZSBleHRyYWN0aW9uXG5cbmludGVyZmFjZSBQYXJzZWREYXRlVGltZSB7XG4gICAgZGF0ZTogRGF0ZSB8IG51bGw7XG4gICAgdGltZTogc3RyaW5nIHwgbnVsbDtcbiAgICBlcnJvcj86IHN0cmluZztcbn1cblxuLy8gTW9udGggbmFtZXMgZm9yIHBhcnNpbmdcbmNvbnN0IE1PTlRIUzogeyBba2V5OiBzdHJpbmddOiBudW1iZXIgfSA9IHtcbiAgICBqYW51YXJ5OiAwLCBqYW46IDAsXG4gICAgZmVicnVhcnk6IDEsIGZlYjogMSxcbiAgICBtYXJjaDogMiwgbWFyOiAyLFxuICAgIGFwcmlsOiAzLCBhcHI6IDMsXG4gICAgbWF5OiA0LFxuICAgIGp1bmU6IDUsIGp1bjogNSxcbiAgICBqdWx5OiA2LCBqdWw6IDYsXG4gICAgYXVndXN0OiA3LCBhdWc6IDcsXG4gICAgc2VwdGVtYmVyOiA4LCBzZXA6IDgsIHNlcHQ6IDgsXG4gICAgb2N0b2JlcjogOSwgb2N0OiA5LFxuICAgIG5vdmVtYmVyOiAxMCwgbm92OiAxMCxcbiAgICBkZWNlbWJlcjogMTEsIGRlYzogMTEsXG59O1xuXG4vLyBEYXkgbmFtZXMgZm9yIHJlbGF0aXZlIHBhcnNpbmdcbmNvbnN0IERBWVM6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH0gPSB7XG4gICAgc3VuZGF5OiAwLCBzdW46IDAsXG4gICAgbW9uZGF5OiAxLCBtb246IDEsXG4gICAgdHVlc2RheTogMiwgdHVlOiAyLCB0dWVzOiAyLFxuICAgIHdlZG5lc2RheTogMywgd2VkOiAzLFxuICAgIHRodXJzZGF5OiA0LCB0aHU6IDQsIHRodXI6IDQsIHRodXJzOiA0LFxuICAgIGZyaWRheTogNSwgZnJpOiA1LFxuICAgIHNhdHVyZGF5OiA2LCBzYXQ6IDYsXG59O1xuXG4vLyBQYXJzZSBuYXR1cmFsIGxhbmd1YWdlIGRhdGUvdGltZSBmcm9tIG1lc3NhZ2VcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZURhdGVUaW1lKG1lc3NhZ2U6IHN0cmluZyk6IFBhcnNlZERhdGVUaW1lIHtcbiAgICBjb25zdCBsb3dlck1lc3NhZ2UgPSBtZXNzYWdlLnRvTG93ZXJDYXNlKCk7XG4gICAgbGV0IGRhdGU6IERhdGUgfCBudWxsID0gbnVsbDtcbiAgICBsZXQgdGltZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgICAvLyBQYXJzZSByZWxhdGl2ZSBkYXRlc1xuICAgIGlmIChsb3dlck1lc3NhZ2UuaW5jbHVkZXMoJ3RvZGF5JykpIHtcbiAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgfSBlbHNlIGlmIChsb3dlck1lc3NhZ2UuaW5jbHVkZXMoJ3RvbW9ycm93JykpIHtcbiAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSArIDEpO1xuICAgIH0gZWxzZSBpZiAobG93ZXJNZXNzYWdlLmluY2x1ZGVzKCdkYXkgYWZ0ZXIgdG9tb3Jyb3cnKSkge1xuICAgICAgICBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpICsgMik7XG4gICAgfVxuXG4gICAgLy8gUGFyc2UgXCJuZXh0IFtkYXldXCIgcGF0dGVyblxuICAgIGNvbnN0IG5leHREYXlNYXRjaCA9IGxvd2VyTWVzc2FnZS5tYXRjaCgvbmV4dFxccysobW9uZGF5fHR1ZXNkYXl8d2VkbmVzZGF5fHRodXJzZGF5fGZyaWRheXxzYXR1cmRheXxzdW5kYXl8bW9ufHR1ZXx3ZWR8dGh1fGZyaXxzYXR8c3VuKS9pKTtcbiAgICBpZiAobmV4dERheU1hdGNoKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldERheSA9IERBWVNbbmV4dERheU1hdGNoWzFdLnRvTG93ZXJDYXNlKCldO1xuICAgICAgICBpZiAodGFyZ2V0RGF5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGRhdGUgPSBnZXROZXh0RGF5T2ZXZWVrKHRhcmdldERheSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBQYXJzZSBcInRoaXMgW2RheV1cIiBwYXR0ZXJuXG4gICAgY29uc3QgdGhpc0RheU1hdGNoID0gbG93ZXJNZXNzYWdlLm1hdGNoKC90aGlzXFxzKyhtb25kYXl8dHVlc2RheXx3ZWRuZXNkYXl8dGh1cnNkYXl8ZnJpZGF5fHNhdHVyZGF5fHN1bmRheXxtb258dHVlfHdlZHx0aHV8ZnJpfHNhdHxzdW4pL2kpO1xuICAgIGlmICh0aGlzRGF5TWF0Y2gpIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0RGF5ID0gREFZU1t0aGlzRGF5TWF0Y2hbMV0udG9Mb3dlckNhc2UoKV07XG4gICAgICAgIGlmICh0YXJnZXREYXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZGF0ZSA9IGdldFRoaXNEYXlPZldlZWsodGFyZ2V0RGF5KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFBhcnNlIGV4cGxpY2l0IGRhdGUgZm9ybWF0czogXCJKYW51YXJ5IDE1XCIsIFwiSmFuIDE1dGhcIiwgXCIxNSBKYW51YXJ5XCIsIFwiMTV0aCBvZiBKYW51YXJ5XCJcbiAgICBjb25zdCBleHBsaWNpdERhdGVQYXR0ZXJucyA9IFtcbiAgICAgICAgLyhcXGR7MSwyfSkoPzpzdHxuZHxyZHx0aCk/XFxzKig/Om9mXFxzKik/KGphbnVhcnl8ZmVicnVhcnl8bWFyY2h8YXByaWx8bWF5fGp1bmV8anVseXxhdWd1c3R8c2VwdGVtYmVyfG9jdG9iZXJ8bm92ZW1iZXJ8ZGVjZW1iZXJ8amFufGZlYnxtYXJ8YXByfGp1bnxqdWx8YXVnfHNlcHxzZXB0fG9jdHxub3Z8ZGVjKS9pLFxuICAgICAgICAvKGphbnVhcnl8ZmVicnVhcnl8bWFyY2h8YXByaWx8bWF5fGp1bmV8anVseXxhdWd1c3R8c2VwdGVtYmVyfG9jdG9iZXJ8bm92ZW1iZXJ8ZGVjZW1iZXJ8amFufGZlYnxtYXJ8YXByfGp1bnxqdWx8YXVnfHNlcHxzZXB0fG9jdHxub3Z8ZGVjKVxccyooXFxkezEsMn0pKD86c3R8bmR8cmR8dGgpPy9pLFxuICAgIF07XG5cbiAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgZXhwbGljaXREYXRlUGF0dGVybnMpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBsb3dlck1lc3NhZ2UubWF0Y2gocGF0dGVybik7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgbGV0IGRheTogbnVtYmVyO1xuICAgICAgICAgICAgbGV0IG1vbnRoOiBudW1iZXI7XG5cbiAgICAgICAgICAgIGlmIChpc05hTihwYXJzZUludChtYXRjaFsxXSkpKSB7XG4gICAgICAgICAgICAgICAgLy8gTW9udGggZmlyc3QgZm9ybWF0XG4gICAgICAgICAgICAgICAgbW9udGggPSBNT05USFNbbWF0Y2hbMV0udG9Mb3dlckNhc2UoKV07XG4gICAgICAgICAgICAgICAgZGF5ID0gcGFyc2VJbnQobWF0Y2hbMl0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBEYXkgZmlyc3QgZm9ybWF0XG4gICAgICAgICAgICAgICAgZGF5ID0gcGFyc2VJbnQobWF0Y2hbMV0pO1xuICAgICAgICAgICAgICAgIG1vbnRoID0gTU9OVEhTW21hdGNoWzJdLnRvTG93ZXJDYXNlKCldO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWlzTmFOKGRheSkgJiYgbW9udGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIGRhdGUuc2V0TW9udGgobW9udGgpO1xuICAgICAgICAgICAgICAgIGRhdGUuc2V0RGF0ZShkYXkpO1xuXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGRhdGUgaXMgaW4gdGhlIHBhc3QsIGFzc3VtZSBuZXh0IHllYXJcbiAgICAgICAgICAgICAgICBpZiAoZGF0ZSA8IG5ldyBEYXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZS5zZXRGdWxsWWVhcihkYXRlLmdldEZ1bGxZZWFyKCkgKyAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFBhcnNlIHRpbWU6IFwiYXQgMnBtXCIsIFwiYXQgMjozMCBwbVwiLCBcImF0IDE0OjAwXCJcbiAgICBjb25zdCB0aW1lUGF0dGVybnMgPSBbXG4gICAgICAgIC8oPzphdFxccyspPyhcXGR7MSwyfSk6KFxcZHsyfSlcXHMqKGFtfHBtKT8vaSxcbiAgICAgICAgLyg/OmF0XFxzKyk/KFxcZHsxLDJ9KVxccyooYW18cG0pL2ksXG4gICAgXTtcblxuICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiB0aW1lUGF0dGVybnMpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBsb3dlck1lc3NhZ2UubWF0Y2gocGF0dGVybik7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgbGV0IGhvdXJzID0gcGFyc2VJbnQobWF0Y2hbMV0pO1xuICAgICAgICAgICAgY29uc3QgbWludXRlcyA9IG1hdGNoWzJdICYmICFpc05hTihwYXJzZUludChtYXRjaFsyXSkpID8gcGFyc2VJbnQobWF0Y2hbMl0pIDogMDtcbiAgICAgICAgICAgIGNvbnN0IG1lcmlkaWVtID0gbWF0Y2hbM10gfHwgbWF0Y2hbMl07XG5cbiAgICAgICAgICAgIGlmIChtZXJpZGllbSkge1xuICAgICAgICAgICAgICAgIGlmIChtZXJpZGllbS50b0xvd2VyQ2FzZSgpID09PSAncG0nICYmIGhvdXJzIDwgMTIpIHtcbiAgICAgICAgICAgICAgICAgICAgaG91cnMgKz0gMTI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtZXJpZGllbS50b0xvd2VyQ2FzZSgpID09PSAnYW0nICYmIGhvdXJzID09PSAxMikge1xuICAgICAgICAgICAgICAgICAgICBob3VycyA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aW1lID0gYCR7aG91cnMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfToke21pbnV0ZXMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWA7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7IGRhdGUsIHRpbWUgfTtcbn1cblxuLy8gR2V0IHRoZSBuZXh0IG9jY3VycmVuY2Ugb2YgYSBkYXkgb2Ygd2Vla1xuZnVuY3Rpb24gZ2V0TmV4dERheU9mV2VlayhkYXlPZldlZWs6IG51bWJlcik6IERhdGUge1xuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGN1cnJlbnREYXkgPSBkYXRlLmdldERheSgpO1xuICAgIGNvbnN0IGRheXNVbnRpbCA9IChkYXlPZldlZWsgLSBjdXJyZW50RGF5ICsgNykgJSA3IHx8IDc7IC8vIEF0IGxlYXN0IDEgZGF5IGFoZWFkXG4gICAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpICsgZGF5c1VudGlsKTtcbiAgICByZXR1cm4gZGF0ZTtcbn1cblxuLy8gR2V0IHRoaXMgd2VlaydzIG9jY3VycmVuY2Ugb2YgYSBkYXlcbmZ1bmN0aW9uIGdldFRoaXNEYXlPZldlZWsoZGF5T2ZXZWVrOiBudW1iZXIpOiBEYXRlIHtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBjdXJyZW50RGF5ID0gZGF0ZS5nZXREYXkoKTtcbiAgICBjb25zdCBkaWZmID0gZGF5T2ZXZWVrIC0gY3VycmVudERheTtcbiAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgKyBkaWZmKTtcbiAgICByZXR1cm4gZGF0ZTtcbn1cblxuLy8gQ29tYmluZSBkYXRlIGFuZCB0aW1lIGludG8gYSBzaW5nbGUgRGF0ZSBvYmplY3RcbmV4cG9ydCBmdW5jdGlvbiBjb21iaW5lRGF0ZUFuZFRpbWUoZGF0ZTogRGF0ZSwgdGltZTogc3RyaW5nKTogRGF0ZSB7XG4gICAgY29uc3QgcmVzdWx0ID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgY29uc3QgW2hvdXJzLCBtaW51dGVzXSA9IHRpbWUuc3BsaXQoJzonKS5tYXAoTnVtYmVyKTtcbiAgICByZXN1bHQuc2V0SG91cnMoaG91cnMsIG1pbnV0ZXMsIDAsIDApO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbi8vIFZhbGlkYXRlIHRoYXQgZGF0ZSBpcyBub3QgaW4gdGhlIHBhc3RcbmV4cG9ydCBmdW5jdGlvbiBpc0RhdGVJblBhc3QoZGF0ZTogRGF0ZSk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgcmV0dXJuIGRhdGUgPCBub3c7XG59XG5cbi8vIEZvcm1hdCBkYXRlIGZvciBkaXNwbGF5XG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0RGF0ZVRpbWUoZGF0ZTogRGF0ZSk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGRhdGUudG9Mb2NhbGVTdHJpbmcoJ2VuLVVTJywge1xuICAgICAgICB3ZWVrZGF5OiAnc2hvcnQnLFxuICAgICAgICBtb250aDogJ3Nob3J0JyxcbiAgICAgICAgZGF5OiAnbnVtZXJpYycsXG4gICAgICAgIHllYXI6ICdudW1lcmljJyxcbiAgICAgICAgaG91cjogJ251bWVyaWMnLFxuICAgICAgICBtaW51dGU6ICcyLWRpZ2l0JyxcbiAgICAgICAgaG91cjEyOiB0cnVlLFxuICAgIH0pO1xufVxuXG4vLyBGb3JtYXQganVzdCB0aGUgZGF0ZVxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdERhdGUoZGF0ZTogRGF0ZSk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGRhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCdlbi1VUycsIHtcbiAgICAgICAgd2Vla2RheTogJ2xvbmcnLFxuICAgICAgICBtb250aDogJ2xvbmcnLFxuICAgICAgICBkYXk6ICdudW1lcmljJyxcbiAgICAgICAgeWVhcjogJ251bWVyaWMnLFxuICAgIH0pO1xufVxuXG4vLyBGb3JtYXQganVzdCB0aGUgdGltZVxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFRpbWUoZGF0ZTogRGF0ZSk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGRhdGUudG9Mb2NhbGVUaW1lU3RyaW5nKCdlbi1VUycsIHtcbiAgICAgICAgaG91cjogJ251bWVyaWMnLFxuICAgICAgICBtaW51dGU6ICcyLWRpZ2l0JyxcbiAgICAgICAgaG91cjEyOiB0cnVlLFxuICAgIH0pO1xufVxuXG4vLyBQYXJzZSBcImZyb20gWCB0byBZXCIgZm9yIHJlc2NoZWR1bGluZ1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlUmVzY2hlZHVsZURhdGVzKG1lc3NhZ2U6IHN0cmluZyk6IHtcbiAgICBvcmlnaW5hbERhdGU6IERhdGUgfCBudWxsO1xuICAgIG5ld0RhdGU6IERhdGUgfCBudWxsO1xuICAgIG5ld1RpbWU6IHN0cmluZyB8IG51bGw7XG59IHtcbiAgICBjb25zdCBsb3dlck1lc3NhZ2UgPSBtZXNzYWdlLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAvLyBTcGxpdCBtZXNzYWdlIGJ5IFwidG9cIiB0byBnZXQgb2xkIGFuZCBuZXcgZGF0ZXNcbiAgICBjb25zdCBwYXJ0cyA9IGxvd2VyTWVzc2FnZS5zcGxpdCgvXFxzK3RvXFxzKy8pO1xuXG4gICAgaWYgKHBhcnRzLmxlbmd0aCA+PSAyKSB7XG4gICAgICAgIGNvbnN0IG9yaWdpbmFsUGFyc2VkID0gcGFyc2VEYXRlVGltZShwYXJ0c1swXSk7XG4gICAgICAgIGNvbnN0IG5ld1BhcnNlZCA9IHBhcnNlRGF0ZVRpbWUocGFydHNbMV0pO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBvcmlnaW5hbERhdGU6IG9yaWdpbmFsUGFyc2VkLmRhdGUsXG4gICAgICAgICAgICBuZXdEYXRlOiBuZXdQYXJzZWQuZGF0ZSxcbiAgICAgICAgICAgIG5ld1RpbWU6IG5ld1BhcnNlZC50aW1lLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIEZhbGxiYWNrOiB0cnkgdG8gZmluZCBhbnkgZGF0ZSBpbiB0aGUgbWVzc2FnZVxuICAgIGNvbnN0IHBhcnNlZCA9IHBhcnNlRGF0ZVRpbWUobWVzc2FnZSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgb3JpZ2luYWxEYXRlOiBwYXJzZWQuZGF0ZSxcbiAgICAgICAgbmV3RGF0ZTogbnVsbCxcbiAgICAgICAgbmV3VGltZTogcGFyc2VkLnRpbWUsXG4gICAgfTtcbn1cbiJdLCJuYW1lcyI6WyJNT05USFMiLCJqYW51YXJ5IiwiamFuIiwiZmVicnVhcnkiLCJmZWIiLCJtYXJjaCIsIm1hciIsImFwcmlsIiwiYXByIiwibWF5IiwianVuZSIsImp1biIsImp1bHkiLCJqdWwiLCJhdWd1c3QiLCJhdWciLCJzZXB0ZW1iZXIiLCJzZXAiLCJzZXB0Iiwib2N0b2JlciIsIm9jdCIsIm5vdmVtYmVyIiwibm92IiwiZGVjZW1iZXIiLCJkZWMiLCJEQVlTIiwic3VuZGF5Iiwic3VuIiwibW9uZGF5IiwibW9uIiwidHVlc2RheSIsInR1ZSIsInR1ZXMiLCJ3ZWRuZXNkYXkiLCJ3ZWQiLCJ0aHVyc2RheSIsInRodSIsInRodXIiLCJ0aHVycyIsImZyaWRheSIsImZyaSIsInNhdHVyZGF5Iiwic2F0IiwicGFyc2VEYXRlVGltZSIsIm1lc3NhZ2UiLCJsb3dlck1lc3NhZ2UiLCJ0b0xvd2VyQ2FzZSIsImRhdGUiLCJ0aW1lIiwiaW5jbHVkZXMiLCJEYXRlIiwic2V0RGF0ZSIsImdldERhdGUiLCJuZXh0RGF5TWF0Y2giLCJtYXRjaCIsInRhcmdldERheSIsInVuZGVmaW5lZCIsImdldE5leHREYXlPZldlZWsiLCJ0aGlzRGF5TWF0Y2giLCJnZXRUaGlzRGF5T2ZXZWVrIiwiZXhwbGljaXREYXRlUGF0dGVybnMiLCJwYXR0ZXJuIiwiZGF5IiwibW9udGgiLCJpc05hTiIsInBhcnNlSW50Iiwic2V0TW9udGgiLCJzZXRGdWxsWWVhciIsImdldEZ1bGxZZWFyIiwidGltZVBhdHRlcm5zIiwiaG91cnMiLCJtaW51dGVzIiwibWVyaWRpZW0iLCJ0b1N0cmluZyIsInBhZFN0YXJ0IiwiZGF5T2ZXZWVrIiwiY3VycmVudERheSIsImdldERheSIsImRheXNVbnRpbCIsImRpZmYiLCJjb21iaW5lRGF0ZUFuZFRpbWUiLCJyZXN1bHQiLCJzcGxpdCIsIm1hcCIsIk51bWJlciIsInNldEhvdXJzIiwiaXNEYXRlSW5QYXN0Iiwibm93IiwiZm9ybWF0RGF0ZVRpbWUiLCJ0b0xvY2FsZVN0cmluZyIsIndlZWtkYXkiLCJ5ZWFyIiwiaG91ciIsIm1pbnV0ZSIsImhvdXIxMiIsImZvcm1hdERhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJmb3JtYXRUaW1lIiwidG9Mb2NhbGVUaW1lU3RyaW5nIiwicGFyc2VSZXNjaGVkdWxlRGF0ZXMiLCJwYXJ0cyIsImxlbmd0aCIsIm9yaWdpbmFsUGFyc2VkIiwibmV3UGFyc2VkIiwib3JpZ2luYWxEYXRlIiwibmV3RGF0ZSIsIm5ld1RpbWUiLCJwYXJzZWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/agent/date-parser.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/agent/intent-parser.ts":
/*!****************************************!*\
  !*** ./src/lib/agent/intent-parser.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getIntentName: () => (/* binding */ getIntentName),\n/* harmony export */   hasAppointmentContext: () => (/* binding */ hasAppointmentContext),\n/* harmony export */   parseIntent: () => (/* binding */ parseIntent)\n/* harmony export */ });\n// Keywords for each intent type\nconst BOOK_KEYWORDS = [\n    \"book\",\n    \"schedule\",\n    \"make\",\n    \"set up\",\n    \"arrange\",\n    \"create\",\n    \"new appointment\"\n];\nconst RESCHEDULE_KEYWORDS = [\n    \"reschedule\",\n    \"move\",\n    \"change\",\n    \"shift\",\n    \"postpone\",\n    \"modify\",\n    \"update\"\n];\nconst CANCEL_KEYWORDS = [\n    \"cancel\",\n    \"delete\",\n    \"remove\",\n    \"drop\",\n    \"clear\"\n];\nconst SLOT_SELECTION_PATTERNS = [\n    /\\b(first|1st|option\\s*1|slot\\s*1|one)\\b/i,\n    /\\b(second|2nd|option\\s*2|slot\\s*2|two)\\b/i\n];\nconst CONFIRM_KEYWORDS = [\n    \"yes\",\n    \"confirm\",\n    \"okay\",\n    \"ok\",\n    \"sure\",\n    \"correct\",\n    \"right\",\n    \"yep\",\n    \"yeah\"\n];\n// Parse user message to determine intent\nfunction parseIntent(message, currentState) {\n    const lowerMessage = message.toLowerCase().trim();\n    // First check if we're waiting for slot selection\n    if (currentState?.pendingSlots && currentState.pendingSlots.length > 0) {\n        // Check for slot selection\n        for(let i = 0; i < SLOT_SELECTION_PATTERNS.length; i++){\n            if (SLOT_SELECTION_PATTERNS[i].test(lowerMessage)) {\n                return {\n                    type: \"SELECT_SLOT\",\n                    slotIndex: i\n                };\n            }\n        }\n    }\n    // Check for confirmation\n    if (currentState?.awaitingConfirmation) {\n        for (const keyword of CONFIRM_KEYWORDS){\n            if (lowerMessage.includes(keyword)) {\n                return {\n                    type: \"CONFIRM\"\n                };\n            }\n        }\n    }\n    // Check for cancellation intent\n    for (const keyword of CANCEL_KEYWORDS){\n        if (lowerMessage.includes(keyword)) {\n            return {\n                type: \"CANCEL\"\n            };\n        }\n    }\n    // Check for reschedule intent\n    for (const keyword of RESCHEDULE_KEYWORDS){\n        if (lowerMessage.includes(keyword)) {\n            return {\n                type: \"RESCHEDULE\"\n            };\n        }\n    }\n    // Check for booking intent\n    for (const keyword of BOOK_KEYWORDS){\n        if (lowerMessage.includes(keyword)) {\n            return {\n                type: \"BOOK\"\n            };\n        }\n    }\n    // Default to unknown\n    return {\n        type: \"UNKNOWN\"\n    };\n}\n// Get intent display name for user-facing messages\nfunction getIntentName(type) {\n    switch(type){\n        case \"BOOK\":\n            return \"book an appointment\";\n        case \"RESCHEDULE\":\n            return \"reschedule an appointment\";\n        case \"CANCEL\":\n            return \"cancel an appointment\";\n        case \"SELECT_SLOT\":\n            return \"select a time slot\";\n        case \"CONFIRM\":\n            return \"confirm\";\n        default:\n            return \"unknown action\";\n    }\n}\n// Check if the message contains appointment/meeting context\nfunction hasAppointmentContext(message) {\n    const contextKeywords = [\n        \"appointment\",\n        \"meeting\",\n        \"slot\",\n        \"time\",\n        \"session\",\n        \"call\"\n    ];\n    const lowerMessage = message.toLowerCase();\n    return contextKeywords.some((keyword)=>lowerMessage.includes(keyword));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2FnZW50L2ludGVudC1wYXJzZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBRUEsZ0NBQWdDO0FBQ2hDLE1BQU1BLGdCQUFnQjtJQUFDO0lBQVE7SUFBWTtJQUFRO0lBQVU7SUFBVztJQUFVO0NBQWtCO0FBQ3BHLE1BQU1DLHNCQUFzQjtJQUFDO0lBQWM7SUFBUTtJQUFVO0lBQVM7SUFBWTtJQUFVO0NBQVM7QUFDckcsTUFBTUMsa0JBQWtCO0lBQUM7SUFBVTtJQUFVO0lBQVU7SUFBUTtDQUFRO0FBQ3ZFLE1BQU1DLDBCQUEwQjtJQUM1QjtJQUNBO0NBQ0g7QUFDRCxNQUFNQyxtQkFBbUI7SUFBQztJQUFPO0lBQVc7SUFBUTtJQUFNO0lBQVE7SUFBVztJQUFTO0lBQU87Q0FBTztBQUVwRyx5Q0FBeUM7QUFDbEMsU0FBU0MsWUFDWkMsT0FBZSxFQUNmQyxZQUFnQztJQUVoQyxNQUFNQyxlQUFlRixRQUFRRyxXQUFXLEdBQUdDLElBQUk7SUFFL0Msa0RBQWtEO0lBQ2xELElBQUlILGNBQWNJLGdCQUFnQkosYUFBYUksWUFBWSxDQUFDQyxNQUFNLEdBQUcsR0FBRztRQUNwRSwyQkFBMkI7UUFDM0IsSUFBSyxJQUFJQyxJQUFJLEdBQUdBLElBQUlWLHdCQUF3QlMsTUFBTSxFQUFFQyxJQUFLO1lBQ3JELElBQUlWLHVCQUF1QixDQUFDVSxFQUFFLENBQUNDLElBQUksQ0FBQ04sZUFBZTtnQkFDL0MsT0FBTztvQkFDSE8sTUFBTTtvQkFDTkMsV0FBV0g7Z0JBQ2Y7WUFDSjtRQUNKO0lBQ0o7SUFFQSx5QkFBeUI7SUFDekIsSUFBSU4sY0FBY1Usc0JBQXNCO1FBQ3BDLEtBQUssTUFBTUMsV0FBV2QsaUJBQWtCO1lBQ3BDLElBQUlJLGFBQWFXLFFBQVEsQ0FBQ0QsVUFBVTtnQkFDaEMsT0FBTztvQkFBRUgsTUFBTTtnQkFBVTtZQUM3QjtRQUNKO0lBQ0o7SUFFQSxnQ0FBZ0M7SUFDaEMsS0FBSyxNQUFNRyxXQUFXaEIsZ0JBQWlCO1FBQ25DLElBQUlNLGFBQWFXLFFBQVEsQ0FBQ0QsVUFBVTtZQUNoQyxPQUFPO2dCQUFFSCxNQUFNO1lBQVM7UUFDNUI7SUFDSjtJQUVBLDhCQUE4QjtJQUM5QixLQUFLLE1BQU1HLFdBQVdqQixvQkFBcUI7UUFDdkMsSUFBSU8sYUFBYVcsUUFBUSxDQUFDRCxVQUFVO1lBQ2hDLE9BQU87Z0JBQUVILE1BQU07WUFBYTtRQUNoQztJQUNKO0lBRUEsMkJBQTJCO0lBQzNCLEtBQUssTUFBTUcsV0FBV2xCLGNBQWU7UUFDakMsSUFBSVEsYUFBYVcsUUFBUSxDQUFDRCxVQUFVO1lBQ2hDLE9BQU87Z0JBQUVILE1BQU07WUFBTztRQUMxQjtJQUNKO0lBRUEscUJBQXFCO0lBQ3JCLE9BQU87UUFBRUEsTUFBTTtJQUFVO0FBQzdCO0FBRUEsbURBQW1EO0FBQzVDLFNBQVNLLGNBQWNMLElBQWdCO0lBQzFDLE9BQVFBO1FBQ0osS0FBSztZQUNELE9BQU87UUFDWCxLQUFLO1lBQ0QsT0FBTztRQUNYLEtBQUs7WUFDRCxPQUFPO1FBQ1gsS0FBSztZQUNELE9BQU87UUFDWCxLQUFLO1lBQ0QsT0FBTztRQUNYO1lBQ0ksT0FBTztJQUNmO0FBQ0o7QUFFQSw0REFBNEQ7QUFDckQsU0FBU00sc0JBQXNCZixPQUFlO0lBQ2pELE1BQU1nQixrQkFBa0I7UUFBQztRQUFlO1FBQVc7UUFBUTtRQUFRO1FBQVc7S0FBTztJQUNyRixNQUFNZCxlQUFlRixRQUFRRyxXQUFXO0lBQ3hDLE9BQU9hLGdCQUFnQkMsSUFBSSxDQUFDTCxDQUFBQSxVQUFXVixhQUFhVyxRQUFRLENBQUNEO0FBQ2pFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWR2aXNvci1hcHBvaW50bWVudC1zY2hlZHVsZXIvLi9zcmMvbGliL2FnZW50L2ludGVudC1wYXJzZXIudHM/NGJjOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbnRlbnRUeXBlLCBQYXJzZWRJbnRlbnQsIENvbnZlcnNhdGlvblN0YXRlIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vLyBLZXl3b3JkcyBmb3IgZWFjaCBpbnRlbnQgdHlwZVxuY29uc3QgQk9PS19LRVlXT1JEUyA9IFsnYm9vaycsICdzY2hlZHVsZScsICdtYWtlJywgJ3NldCB1cCcsICdhcnJhbmdlJywgJ2NyZWF0ZScsICduZXcgYXBwb2ludG1lbnQnXTtcbmNvbnN0IFJFU0NIRURVTEVfS0VZV09SRFMgPSBbJ3Jlc2NoZWR1bGUnLCAnbW92ZScsICdjaGFuZ2UnLCAnc2hpZnQnLCAncG9zdHBvbmUnLCAnbW9kaWZ5JywgJ3VwZGF0ZSddO1xuY29uc3QgQ0FOQ0VMX0tFWVdPUkRTID0gWydjYW5jZWwnLCAnZGVsZXRlJywgJ3JlbW92ZScsICdkcm9wJywgJ2NsZWFyJ107XG5jb25zdCBTTE9UX1NFTEVDVElPTl9QQVRURVJOUyA9IFtcbiAgICAvXFxiKGZpcnN0fDFzdHxvcHRpb25cXHMqMXxzbG90XFxzKjF8b25lKVxcYi9pLFxuICAgIC9cXGIoc2Vjb25kfDJuZHxvcHRpb25cXHMqMnxzbG90XFxzKjJ8dHdvKVxcYi9pLFxuXTtcbmNvbnN0IENPTkZJUk1fS0VZV09SRFMgPSBbJ3llcycsICdjb25maXJtJywgJ29rYXknLCAnb2snLCAnc3VyZScsICdjb3JyZWN0JywgJ3JpZ2h0JywgJ3llcCcsICd5ZWFoJ107XG5cbi8vIFBhcnNlIHVzZXIgbWVzc2FnZSB0byBkZXRlcm1pbmUgaW50ZW50XG5leHBvcnQgZnVuY3Rpb24gcGFyc2VJbnRlbnQoXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIGN1cnJlbnRTdGF0ZT86IENvbnZlcnNhdGlvblN0YXRlXG4pOiBQYXJzZWRJbnRlbnQge1xuICAgIGNvbnN0IGxvd2VyTWVzc2FnZSA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKS50cmltKCk7XG5cbiAgICAvLyBGaXJzdCBjaGVjayBpZiB3ZSdyZSB3YWl0aW5nIGZvciBzbG90IHNlbGVjdGlvblxuICAgIGlmIChjdXJyZW50U3RhdGU/LnBlbmRpbmdTbG90cyAmJiBjdXJyZW50U3RhdGUucGVuZGluZ1Nsb3RzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gQ2hlY2sgZm9yIHNsb3Qgc2VsZWN0aW9uXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgU0xPVF9TRUxFQ1RJT05fUEFUVEVSTlMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChTTE9UX1NFTEVDVElPTl9QQVRURVJOU1tpXS50ZXN0KGxvd2VyTWVzc2FnZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnU0VMRUNUX1NMT1QnLFxuICAgICAgICAgICAgICAgICAgICBzbG90SW5kZXg6IGksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBjb25maXJtYXRpb25cbiAgICBpZiAoY3VycmVudFN0YXRlPy5hd2FpdGluZ0NvbmZpcm1hdGlvbikge1xuICAgICAgICBmb3IgKGNvbnN0IGtleXdvcmQgb2YgQ09ORklSTV9LRVlXT1JEUykge1xuICAgICAgICAgICAgaWYgKGxvd2VyTWVzc2FnZS5pbmNsdWRlcyhrZXl3b3JkKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHR5cGU6ICdDT05GSVJNJyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIGNhbmNlbGxhdGlvbiBpbnRlbnRcbiAgICBmb3IgKGNvbnN0IGtleXdvcmQgb2YgQ0FOQ0VMX0tFWVdPUkRTKSB7XG4gICAgICAgIGlmIChsb3dlck1lc3NhZ2UuaW5jbHVkZXMoa2V5d29yZCkpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6ICdDQU5DRUwnIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgcmVzY2hlZHVsZSBpbnRlbnRcbiAgICBmb3IgKGNvbnN0IGtleXdvcmQgb2YgUkVTQ0hFRFVMRV9LRVlXT1JEUykge1xuICAgICAgICBpZiAobG93ZXJNZXNzYWdlLmluY2x1ZGVzKGtleXdvcmQpKSB7XG4gICAgICAgICAgICByZXR1cm4geyB0eXBlOiAnUkVTQ0hFRFVMRScgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBib29raW5nIGludGVudFxuICAgIGZvciAoY29uc3Qga2V5d29yZCBvZiBCT09LX0tFWVdPUkRTKSB7XG4gICAgICAgIGlmIChsb3dlck1lc3NhZ2UuaW5jbHVkZXMoa2V5d29yZCkpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6ICdCT09LJyB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gRGVmYXVsdCB0byB1bmtub3duXG4gICAgcmV0dXJuIHsgdHlwZTogJ1VOS05PV04nIH07XG59XG5cbi8vIEdldCBpbnRlbnQgZGlzcGxheSBuYW1lIGZvciB1c2VyLWZhY2luZyBtZXNzYWdlc1xuZXhwb3J0IGZ1bmN0aW9uIGdldEludGVudE5hbWUodHlwZTogSW50ZW50VHlwZSk6IHN0cmluZyB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgJ0JPT0snOlxuICAgICAgICAgICAgcmV0dXJuICdib29rIGFuIGFwcG9pbnRtZW50JztcbiAgICAgICAgY2FzZSAnUkVTQ0hFRFVMRSc6XG4gICAgICAgICAgICByZXR1cm4gJ3Jlc2NoZWR1bGUgYW4gYXBwb2ludG1lbnQnO1xuICAgICAgICBjYXNlICdDQU5DRUwnOlxuICAgICAgICAgICAgcmV0dXJuICdjYW5jZWwgYW4gYXBwb2ludG1lbnQnO1xuICAgICAgICBjYXNlICdTRUxFQ1RfU0xPVCc6XG4gICAgICAgICAgICByZXR1cm4gJ3NlbGVjdCBhIHRpbWUgc2xvdCc7XG4gICAgICAgIGNhc2UgJ0NPTkZJUk0nOlxuICAgICAgICAgICAgcmV0dXJuICdjb25maXJtJztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiAndW5rbm93biBhY3Rpb24nO1xuICAgIH1cbn1cblxuLy8gQ2hlY2sgaWYgdGhlIG1lc3NhZ2UgY29udGFpbnMgYXBwb2ludG1lbnQvbWVldGluZyBjb250ZXh0XG5leHBvcnQgZnVuY3Rpb24gaGFzQXBwb2ludG1lbnRDb250ZXh0KG1lc3NhZ2U6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGNvbnRleHRLZXl3b3JkcyA9IFsnYXBwb2ludG1lbnQnLCAnbWVldGluZycsICdzbG90JywgJ3RpbWUnLCAnc2Vzc2lvbicsICdjYWxsJ107XG4gICAgY29uc3QgbG93ZXJNZXNzYWdlID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBjb250ZXh0S2V5d29yZHMuc29tZShrZXl3b3JkID0+IGxvd2VyTWVzc2FnZS5pbmNsdWRlcyhrZXl3b3JkKSk7XG59XG4iXSwibmFtZXMiOlsiQk9PS19LRVlXT1JEUyIsIlJFU0NIRURVTEVfS0VZV09SRFMiLCJDQU5DRUxfS0VZV09SRFMiLCJTTE9UX1NFTEVDVElPTl9QQVRURVJOUyIsIkNPTkZJUk1fS0VZV09SRFMiLCJwYXJzZUludGVudCIsIm1lc3NhZ2UiLCJjdXJyZW50U3RhdGUiLCJsb3dlck1lc3NhZ2UiLCJ0b0xvd2VyQ2FzZSIsInRyaW0iLCJwZW5kaW5nU2xvdHMiLCJsZW5ndGgiLCJpIiwidGVzdCIsInR5cGUiLCJzbG90SW5kZXgiLCJhd2FpdGluZ0NvbmZpcm1hdGlvbiIsImtleXdvcmQiLCJpbmNsdWRlcyIsImdldEludGVudE5hbWUiLCJoYXNBcHBvaW50bWVudENvbnRleHQiLCJjb250ZXh0S2V5d29yZHMiLCJzb21lIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/agent/intent-parser.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/google/auth.ts":
/*!********************************!*\
  !*** ./src/lib/google/auth.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCalendarClient: () => (/* binding */ getCalendarClient),\n/* harmony export */   getCalendarId: () => (/* binding */ getCalendarId),\n/* harmony export */   getEmailConfig: () => (/* binding */ getEmailConfig),\n/* harmony export */   getGmailAuth: () => (/* binding */ getGmailAuth),\n/* harmony export */   getGoogleAuth: () => (/* binding */ getGoogleAuth),\n/* harmony export */   getSheetsClient: () => (/* binding */ getSheetsClient),\n/* harmony export */   getSpreadsheetId: () => (/* binding */ getSpreadsheetId)\n/* harmony export */ });\n/* harmony import */ var googleapis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! googleapis */ \"googleapis\");\n/* harmony import */ var googleapis__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(googleapis__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n// Load service account credentials\nconst SERVICE_ACCOUNT_PATH = path__WEBPACK_IMPORTED_MODULE_1__.join(process.cwd(), \"service_account.json\");\nlet serviceAccountCredentials = null;\nfunction getServiceAccountCredentials() {\n    if (serviceAccountCredentials) {\n        return serviceAccountCredentials;\n    }\n    try {\n        const content = fs__WEBPACK_IMPORTED_MODULE_2__.readFileSync(SERVICE_ACCOUNT_PATH, \"utf8\");\n        serviceAccountCredentials = JSON.parse(content);\n        return serviceAccountCredentials;\n    } catch (error) {\n        console.error(\"Error loading service account:\", error);\n        throw new Error(\"Failed to load service account credentials\");\n    }\n}\n// Create JWT auth client for Google APIs\nfunction getGoogleAuth(scopes) {\n    const credentials = getServiceAccountCredentials();\n    if (!credentials) {\n        throw new Error(\"Service account credentials not found\");\n    }\n    const auth = new googleapis__WEBPACK_IMPORTED_MODULE_0__.google.auth.JWT({\n        email: credentials.client_email,\n        key: credentials.private_key,\n        scopes\n    });\n    return auth;\n}\n// Get Calendar API client\nfunction getCalendarClient() {\n    const auth = getGoogleAuth([\n        \"https://www.googleapis.com/auth/calendar\",\n        \"https://www.googleapis.com/auth/calendar.events\"\n    ]);\n    return googleapis__WEBPACK_IMPORTED_MODULE_0__.google.calendar({\n        version: \"v3\",\n        auth\n    });\n}\n// Get Sheets API client\nfunction getSheetsClient() {\n    const auth = getGoogleAuth([\n        \"https://www.googleapis.com/auth/spreadsheets\"\n    ]);\n    return googleapis__WEBPACK_IMPORTED_MODULE_0__.google.sheets({\n        version: \"v4\",\n        auth\n    });\n}\n// Get Gmail API client (for sending emails)\nfunction getGmailAuth() {\n    const auth = getGoogleAuth([\n        \"https://www.googleapis.com/auth/gmail.send\"\n    ]);\n    return auth;\n}\n// Calendar ID from environment\nfunction getCalendarId() {\n    return process.env.GOOGLE_CALENDAR_ID || \"\";\n}\n// Spreadsheet ID from environment\nfunction getSpreadsheetId() {\n    return process.env.GOOGLE_SPREADSHEET_ID || \"\";\n}\n// Email addresses from environment\nfunction getEmailConfig() {\n    return {\n        senderEmail: process.env.GMAIL_SENDER_EMAIL || \"\",\n        advisorEmail: process.env.ADVISOR_EMAIL || \"\",\n        gmailAppPassword: process.env.GMAIL_APP_PASSWORD || \"\"\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2dvb2dsZS9hdXRoLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBb0M7QUFDUDtBQUNKO0FBRXpCLG1DQUFtQztBQUNuQyxNQUFNRyx1QkFBdUJGLHNDQUFTLENBQUNJLFFBQVFDLEdBQUcsSUFBSTtBQUV0RCxJQUFJQyw0QkFJTztBQUVYLFNBQVNDO0lBQ0wsSUFBSUQsMkJBQTJCO1FBQzNCLE9BQU9BO0lBQ1g7SUFFQSxJQUFJO1FBQ0EsTUFBTUUsVUFBVVAsNENBQWUsQ0FBQ0Msc0JBQXNCO1FBQ3RESSw0QkFBNEJJLEtBQUtDLEtBQUssQ0FBQ0g7UUFDdkMsT0FBT0Y7SUFDWCxFQUFFLE9BQU9NLE9BQU87UUFDWkMsUUFBUUQsS0FBSyxDQUFDLGtDQUFrQ0E7UUFDaEQsTUFBTSxJQUFJRSxNQUFNO0lBQ3BCO0FBQ0o7QUFFQSx5Q0FBeUM7QUFDbEMsU0FBU0MsY0FBY0MsTUFBZ0I7SUFDMUMsTUFBTUMsY0FBY1Y7SUFFcEIsSUFBSSxDQUFDVSxhQUFhO1FBQ2QsTUFBTSxJQUFJSCxNQUFNO0lBQ3BCO0lBRUEsTUFBTUksT0FBTyxJQUFJbkIsOENBQU1BLENBQUNtQixJQUFJLENBQUNDLEdBQUcsQ0FBQztRQUM3QkMsT0FBT0gsWUFBWUksWUFBWTtRQUMvQkMsS0FBS0wsWUFBWU0sV0FBVztRQUM1QlA7SUFDSjtJQUVBLE9BQU9FO0FBQ1g7QUFFQSwwQkFBMEI7QUFDbkIsU0FBU007SUFDWixNQUFNTixPQUFPSCxjQUFjO1FBQ3ZCO1FBQ0E7S0FDSDtJQUVELE9BQU9oQiw4Q0FBTUEsQ0FBQzBCLFFBQVEsQ0FBQztRQUFFQyxTQUFTO1FBQU1SO0lBQUs7QUFDakQ7QUFFQSx3QkFBd0I7QUFDakIsU0FBU1M7SUFDWixNQUFNVCxPQUFPSCxjQUFjO1FBQ3ZCO0tBQ0g7SUFFRCxPQUFPaEIsOENBQU1BLENBQUM2QixNQUFNLENBQUM7UUFBRUYsU0FBUztRQUFNUjtJQUFLO0FBQy9DO0FBRUEsNENBQTRDO0FBQ3JDLFNBQVNXO0lBQ1osTUFBTVgsT0FBT0gsY0FBYztRQUN2QjtLQUNIO0lBRUQsT0FBT0c7QUFDWDtBQUVBLCtCQUErQjtBQUN4QixTQUFTWTtJQUNaLE9BQU8xQixRQUFRMkIsR0FBRyxDQUFDQyxrQkFBa0IsSUFBSTtBQUM3QztBQUVBLGtDQUFrQztBQUMzQixTQUFTQztJQUNaLE9BQU83QixRQUFRMkIsR0FBRyxDQUFDRyxxQkFBcUIsSUFBSTtBQUNoRDtBQUVBLG1DQUFtQztBQUM1QixTQUFTQztJQUNaLE9BQU87UUFDSEMsYUFBYWhDLFFBQVEyQixHQUFHLENBQUNNLGtCQUFrQixJQUFJO1FBQy9DQyxjQUFjbEMsUUFBUTJCLEdBQUcsQ0FBQ1EsYUFBYSxJQUFJO1FBQzNDQyxrQkFBa0JwQyxRQUFRMkIsR0FBRyxDQUFDVSxrQkFBa0IsSUFBSTtJQUN4RDtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWR2aXNvci1hcHBvaW50bWVudC1zY2hlZHVsZXIvLi9zcmMvbGliL2dvb2dsZS9hdXRoLnRzPzE3MWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ29vZ2xlIH0gZnJvbSAnZ29vZ2xlYXBpcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuXG4vLyBMb2FkIHNlcnZpY2UgYWNjb3VudCBjcmVkZW50aWFsc1xuY29uc3QgU0VSVklDRV9BQ0NPVU5UX1BBVEggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3NlcnZpY2VfYWNjb3VudC5qc29uJyk7XG5cbmxldCBzZXJ2aWNlQWNjb3VudENyZWRlbnRpYWxzOiB7XG4gICAgY2xpZW50X2VtYWlsOiBzdHJpbmc7XG4gICAgcHJpdmF0ZV9rZXk6IHN0cmluZztcbiAgICBwcm9qZWN0X2lkOiBzdHJpbmc7XG59IHwgbnVsbCA9IG51bGw7XG5cbmZ1bmN0aW9uIGdldFNlcnZpY2VBY2NvdW50Q3JlZGVudGlhbHMoKSB7XG4gICAgaWYgKHNlcnZpY2VBY2NvdW50Q3JlZGVudGlhbHMpIHtcbiAgICAgICAgcmV0dXJuIHNlcnZpY2VBY2NvdW50Q3JlZGVudGlhbHM7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhTRVJWSUNFX0FDQ09VTlRfUEFUSCwgJ3V0ZjgnKTtcbiAgICAgICAgc2VydmljZUFjY291bnRDcmVkZW50aWFscyA9IEpTT04ucGFyc2UoY29udGVudCk7XG4gICAgICAgIHJldHVybiBzZXJ2aWNlQWNjb3VudENyZWRlbnRpYWxzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgc2VydmljZSBhY2NvdW50OicsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gbG9hZCBzZXJ2aWNlIGFjY291bnQgY3JlZGVudGlhbHMnKTtcbiAgICB9XG59XG5cbi8vIENyZWF0ZSBKV1QgYXV0aCBjbGllbnQgZm9yIEdvb2dsZSBBUElzXG5leHBvcnQgZnVuY3Rpb24gZ2V0R29vZ2xlQXV0aChzY29wZXM6IHN0cmluZ1tdKSB7XG4gICAgY29uc3QgY3JlZGVudGlhbHMgPSBnZXRTZXJ2aWNlQWNjb3VudENyZWRlbnRpYWxzKCk7XG5cbiAgICBpZiAoIWNyZWRlbnRpYWxzKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignU2VydmljZSBhY2NvdW50IGNyZWRlbnRpYWxzIG5vdCBmb3VuZCcpO1xuICAgIH1cblxuICAgIGNvbnN0IGF1dGggPSBuZXcgZ29vZ2xlLmF1dGguSldUKHtcbiAgICAgICAgZW1haWw6IGNyZWRlbnRpYWxzLmNsaWVudF9lbWFpbCxcbiAgICAgICAga2V5OiBjcmVkZW50aWFscy5wcml2YXRlX2tleSxcbiAgICAgICAgc2NvcGVzLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGF1dGg7XG59XG5cbi8vIEdldCBDYWxlbmRhciBBUEkgY2xpZW50XG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2FsZW5kYXJDbGllbnQoKSB7XG4gICAgY29uc3QgYXV0aCA9IGdldEdvb2dsZUF1dGgoW1xuICAgICAgICAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jYWxlbmRhcicsXG4gICAgICAgICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NhbGVuZGFyLmV2ZW50cycsXG4gICAgXSk7XG5cbiAgICByZXR1cm4gZ29vZ2xlLmNhbGVuZGFyKHsgdmVyc2lvbjogJ3YzJywgYXV0aCB9KTtcbn1cblxuLy8gR2V0IFNoZWV0cyBBUEkgY2xpZW50XG5leHBvcnQgZnVuY3Rpb24gZ2V0U2hlZXRzQ2xpZW50KCkge1xuICAgIGNvbnN0IGF1dGggPSBnZXRHb29nbGVBdXRoKFtcbiAgICAgICAgJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvc3ByZWFkc2hlZXRzJyxcbiAgICBdKTtcblxuICAgIHJldHVybiBnb29nbGUuc2hlZXRzKHsgdmVyc2lvbjogJ3Y0JywgYXV0aCB9KTtcbn1cblxuLy8gR2V0IEdtYWlsIEFQSSBjbGllbnQgKGZvciBzZW5kaW5nIGVtYWlscylcbmV4cG9ydCBmdW5jdGlvbiBnZXRHbWFpbEF1dGgoKSB7XG4gICAgY29uc3QgYXV0aCA9IGdldEdvb2dsZUF1dGgoW1xuICAgICAgICAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9nbWFpbC5zZW5kJyxcbiAgICBdKTtcblxuICAgIHJldHVybiBhdXRoO1xufVxuXG4vLyBDYWxlbmRhciBJRCBmcm9tIGVudmlyb25tZW50XG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2FsZW5kYXJJZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiBwcm9jZXNzLmVudi5HT09HTEVfQ0FMRU5EQVJfSUQgfHwgJyc7XG59XG5cbi8vIFNwcmVhZHNoZWV0IElEIGZyb20gZW52aXJvbm1lbnRcbmV4cG9ydCBmdW5jdGlvbiBnZXRTcHJlYWRzaGVldElkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHByb2Nlc3MuZW52LkdPT0dMRV9TUFJFQURTSEVFVF9JRCB8fCAnJztcbn1cblxuLy8gRW1haWwgYWRkcmVzc2VzIGZyb20gZW52aXJvbm1lbnRcbmV4cG9ydCBmdW5jdGlvbiBnZXRFbWFpbENvbmZpZygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBzZW5kZXJFbWFpbDogcHJvY2Vzcy5lbnYuR01BSUxfU0VOREVSX0VNQUlMIHx8ICcnLFxuICAgICAgICBhZHZpc29yRW1haWw6IHByb2Nlc3MuZW52LkFEVklTT1JfRU1BSUwgfHwgJycsXG4gICAgICAgIGdtYWlsQXBwUGFzc3dvcmQ6IHByb2Nlc3MuZW52LkdNQUlMX0FQUF9QQVNTV09SRCB8fCAnJyxcbiAgICB9O1xufVxuIl0sIm5hbWVzIjpbImdvb2dsZSIsInBhdGgiLCJmcyIsIlNFUlZJQ0VfQUNDT1VOVF9QQVRIIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJzZXJ2aWNlQWNjb3VudENyZWRlbnRpYWxzIiwiZ2V0U2VydmljZUFjY291bnRDcmVkZW50aWFscyIsImNvbnRlbnQiLCJyZWFkRmlsZVN5bmMiLCJKU09OIiwicGFyc2UiLCJlcnJvciIsImNvbnNvbGUiLCJFcnJvciIsImdldEdvb2dsZUF1dGgiLCJzY29wZXMiLCJjcmVkZW50aWFscyIsImF1dGgiLCJKV1QiLCJlbWFpbCIsImNsaWVudF9lbWFpbCIsImtleSIsInByaXZhdGVfa2V5IiwiZ2V0Q2FsZW5kYXJDbGllbnQiLCJjYWxlbmRhciIsInZlcnNpb24iLCJnZXRTaGVldHNDbGllbnQiLCJzaGVldHMiLCJnZXRHbWFpbEF1dGgiLCJnZXRDYWxlbmRhcklkIiwiZW52IiwiR09PR0xFX0NBTEVOREFSX0lEIiwiZ2V0U3ByZWFkc2hlZXRJZCIsIkdPT0dMRV9TUFJFQURTSEVFVF9JRCIsImdldEVtYWlsQ29uZmlnIiwic2VuZGVyRW1haWwiLCJHTUFJTF9TRU5ERVJfRU1BSUwiLCJhZHZpc29yRW1haWwiLCJBRFZJU09SX0VNQUlMIiwiZ21haWxBcHBQYXNzd29yZCIsIkdNQUlMX0FQUF9QQVNTV09SRCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/google/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/google/calendar.ts":
/*!************************************!*\
  !*** ./src/lib/google/calendar.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkAvailability: () => (/* binding */ checkAvailability),\n/* harmony export */   createEvent: () => (/* binding */ createEvent),\n/* harmony export */   deleteEvent: () => (/* binding */ deleteEvent),\n/* harmony export */   findEventByDate: () => (/* binding */ findEventByDate),\n/* harmony export */   findNextAvailableSlots: () => (/* binding */ findNextAvailableSlots),\n/* harmony export */   getEndTime: () => (/* binding */ getEndTime),\n/* harmony export */   updateEvent: () => (/* binding */ updateEvent)\n/* harmony export */ });\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./auth */ \"(rsc)/./src/lib/google/auth.ts\");\n\nconst APPOINTMENT_DURATION_MINUTES = 30;\nconst BUSINESS_HOUR_START = 9; // 9 AM\nconst BUSINESS_HOUR_END = 18; // 6 PM\n// Check if a specific time slot is available\nasync function checkAvailability(startTime, endTime) {\n    const calendar = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCalendarClient)();\n    const calendarId = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCalendarId)();\n    try {\n        const response = await calendar.freebusy.query({\n            requestBody: {\n                timeMin: startTime.toISOString(),\n                timeMax: endTime.toISOString(),\n                items: [\n                    {\n                        id: calendarId\n                    }\n                ]\n            }\n        });\n        const busy = response.data.calendars?.[calendarId]?.busy || [];\n        return busy.length === 0;\n    } catch (error) {\n        console.error(\"Error checking availability:\", error);\n        throw error;\n    }\n}\n// Find next N available slots on a given date\nasync function findNextAvailableSlots(date, count = 2) {\n    const calendar = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCalendarClient)();\n    const calendarId = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCalendarId)();\n    // Set up the date range for the entire day\n    const startOfDay = new Date(date);\n    startOfDay.setHours(BUSINESS_HOUR_START, 0, 0, 0);\n    const endOfDay = new Date(date);\n    endOfDay.setHours(BUSINESS_HOUR_END, 0, 0, 0);\n    try {\n        // Get all busy times for the day\n        const response = await calendar.freebusy.query({\n            requestBody: {\n                timeMin: startOfDay.toISOString(),\n                timeMax: endOfDay.toISOString(),\n                items: [\n                    {\n                        id: calendarId\n                    }\n                ]\n            }\n        });\n        const busySlots = response.data.calendars?.[calendarId]?.busy || [];\n        const availableSlots = [];\n        // Iterate through the day in 30-minute increments\n        let currentTime = new Date(startOfDay);\n        while(currentTime < endOfDay && availableSlots.length < count){\n            const slotEnd = new Date(currentTime.getTime() + APPOINTMENT_DURATION_MINUTES * 60000);\n            // Check if this slot overlaps with any busy period\n            const isAvailable = !busySlots.some((busy)=>{\n                const busyStart = new Date(busy.start);\n                const busyEnd = new Date(busy.end);\n                return currentTime < busyEnd && slotEnd > busyStart;\n            });\n            if (isAvailable && slotEnd <= endOfDay) {\n                availableSlots.push({\n                    label: formatSlotLabel(currentTime, slotEnd),\n                    start: currentTime.toISOString(),\n                    end: slotEnd.toISOString()\n                });\n            }\n            // Move to next slot\n            currentTime = new Date(currentTime.getTime() + APPOINTMENT_DURATION_MINUTES * 60000);\n        }\n        return availableSlots;\n    } catch (error) {\n        console.error(\"Error finding available slots:\", error);\n        throw error;\n    }\n}\n// Format slot for display\nfunction formatSlotLabel(start, end) {\n    const options = {\n        hour: \"numeric\",\n        minute: \"2-digit\",\n        hour12: true\n    };\n    const startStr = start.toLocaleTimeString(\"en-US\", options);\n    const endStr = end.toLocaleTimeString(\"en-US\", options);\n    const dateStr = start.toLocaleDateString(\"en-US\", {\n        weekday: \"short\",\n        month: \"short\",\n        day: \"numeric\"\n    });\n    return `${dateStr}, ${startStr} - ${endStr}`;\n}\n// Create a new calendar event\nasync function createEvent(title, startTime, endTime, description) {\n    const calendar = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCalendarClient)();\n    const calendarId = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCalendarId)();\n    try {\n        const response = await calendar.events.insert({\n            calendarId,\n            requestBody: {\n                summary: title,\n                description: description || \"Appointment booked via Voice Scheduler\",\n                start: {\n                    dateTime: startTime.toISOString(),\n                    timeZone: \"Asia/Kolkata\"\n                },\n                end: {\n                    dateTime: endTime.toISOString(),\n                    timeZone: \"Asia/Kolkata\"\n                }\n            }\n        });\n        return {\n            id: response.data.id,\n            summary: response.data.summary,\n            start: {\n                dateTime: response.data.start?.dateTime,\n                timeZone: response.data.start?.timeZone\n            },\n            end: {\n                dateTime: response.data.end?.dateTime,\n                timeZone: response.data.end?.timeZone\n            }\n        };\n    } catch (error) {\n        console.error(\"Error creating event:\", error);\n        throw error;\n    }\n}\n// Find event by date\nasync function findEventByDate(date) {\n    const calendar = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCalendarClient)();\n    const calendarId = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCalendarId)();\n    const startOfDay = new Date(date);\n    startOfDay.setHours(0, 0, 0, 0);\n    const endOfDay = new Date(date);\n    endOfDay.setHours(23, 59, 59, 999);\n    try {\n        const response = await calendar.events.list({\n            calendarId,\n            timeMin: startOfDay.toISOString(),\n            timeMax: endOfDay.toISOString(),\n            singleEvents: true,\n            orderBy: \"startTime\"\n        });\n        const events = response.data.items || [];\n        if (events.length === 0) {\n            return null;\n        }\n        // Return the first event found\n        const event = events[0];\n        return {\n            id: event.id,\n            summary: event.summary || \"Appointment\",\n            start: {\n                dateTime: event.start?.dateTime || event.start?.date,\n                timeZone: event.start?.timeZone\n            },\n            end: {\n                dateTime: event.end?.dateTime || event.end?.date,\n                timeZone: event.end?.timeZone\n            }\n        };\n    } catch (error) {\n        console.error(\"Error finding event:\", error);\n        throw error;\n    }\n}\n// Update/reschedule an event\nasync function updateEvent(eventId, newStartTime, newEndTime) {\n    const calendar = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCalendarClient)();\n    const calendarId = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCalendarId)();\n    try {\n        const response = await calendar.events.patch({\n            calendarId,\n            eventId,\n            requestBody: {\n                start: {\n                    dateTime: newStartTime.toISOString(),\n                    timeZone: \"Asia/Kolkata\"\n                },\n                end: {\n                    dateTime: newEndTime.toISOString(),\n                    timeZone: \"Asia/Kolkata\"\n                }\n            }\n        });\n        return {\n            id: response.data.id,\n            summary: response.data.summary,\n            start: {\n                dateTime: response.data.start?.dateTime,\n                timeZone: response.data.start?.timeZone\n            },\n            end: {\n                dateTime: response.data.end?.dateTime,\n                timeZone: response.data.end?.timeZone\n            }\n        };\n    } catch (error) {\n        console.error(\"Error updating event:\", error);\n        throw error;\n    }\n}\n// Delete/cancel an event\nasync function deleteEvent(eventId) {\n    const calendar = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCalendarClient)();\n    const calendarId = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getCalendarId)();\n    try {\n        await calendar.events.delete({\n            calendarId,\n            eventId\n        });\n    } catch (error) {\n        console.error(\"Error deleting event:\", error);\n        throw error;\n    }\n}\n// Get end time based on start time and default duration\nfunction getEndTime(startTime) {\n    return new Date(startTime.getTime() + APPOINTMENT_DURATION_MINUTES * 60000);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBTWhFLFdBQVdSLHdEQUFpQkE7SUFDbEMsTUFBTVMsYUFBYVIsb0RBQWFBO0lBRWhDLElBQUk7UUFDQSxNQUFNTyxTQUFTcUQsTUFBTSxDQUFDZ0IsTUFBTSxDQUFDO1lBQ3pCcEU7WUFDQStEO1FBQ0o7SUFDSixFQUFFLE9BQU9qRCxPQUFPO1FBQ1pDLFFBQVFELEtBQUssQ0FBQyx5QkFBeUJBO1FBQ3ZDLE1BQU1BO0lBQ1Y7QUFDSjtBQUVBLHdEQUF3RDtBQUNqRCxTQUFTdUQsV0FBV3hFLFNBQWU7SUFDdEMsT0FBTyxJQUFJdUIsS0FBS3ZCLFVBQVU4QixPQUFPLEtBQUtsQywrQkFBK0I7QUFDekUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZHZpc29yLWFwcG9pbnRtZW50LXNjaGVkdWxlci8uL3NyYy9saWIvZ29vZ2xlL2NhbGVuZGFyLnRzP2Q3YzIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0Q2FsZW5kYXJDbGllbnQsIGdldENhbGVuZGFySWQgfSBmcm9tICcuL2F1dGgnO1xuaW1wb3J0IHsgQ2FsZW5kYXJFdmVudCwgU2xvdE9wdGlvbiB9IGZyb20gJy4uL3R5cGVzJztcblxuY29uc3QgQVBQT0lOVE1FTlRfRFVSQVRJT05fTUlOVVRFUyA9IDMwO1xuY29uc3QgQlVTSU5FU1NfSE9VUl9TVEFSVCA9IDk7IC8vIDkgQU1cbmNvbnN0IEJVU0lORVNTX0hPVVJfRU5EID0gMTg7IC8vIDYgUE1cblxuLy8gQ2hlY2sgaWYgYSBzcGVjaWZpYyB0aW1lIHNsb3QgaXMgYXZhaWxhYmxlXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tBdmFpbGFiaWxpdHkoXG4gICAgc3RhcnRUaW1lOiBEYXRlLFxuICAgIGVuZFRpbWU6IERhdGVcbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IGNhbGVuZGFyID0gZ2V0Q2FsZW5kYXJDbGllbnQoKTtcbiAgICBjb25zdCBjYWxlbmRhcklkID0gZ2V0Q2FsZW5kYXJJZCgpO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjYWxlbmRhci5mcmVlYnVzeS5xdWVyeSh7XG4gICAgICAgICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICAgICAgICAgIHRpbWVNaW46IHN0YXJ0VGltZS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgIHRpbWVNYXg6IGVuZFRpbWUudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBpdGVtczogW3sgaWQ6IGNhbGVuZGFySWQgfV0sXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBidXN5ID0gcmVzcG9uc2UuZGF0YS5jYWxlbmRhcnM/LltjYWxlbmRhcklkXT8uYnVzeSB8fCBbXTtcbiAgICAgICAgcmV0dXJuIGJ1c3kubGVuZ3RoID09PSAwO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nIGF2YWlsYWJpbGl0eTonLCBlcnJvcik7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbn1cblxuLy8gRmluZCBuZXh0IE4gYXZhaWxhYmxlIHNsb3RzIG9uIGEgZ2l2ZW4gZGF0ZVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmROZXh0QXZhaWxhYmxlU2xvdHMoXG4gICAgZGF0ZTogRGF0ZSxcbiAgICBjb3VudDogbnVtYmVyID0gMlxuKTogUHJvbWlzZTxTbG90T3B0aW9uW10+IHtcbiAgICBjb25zdCBjYWxlbmRhciA9IGdldENhbGVuZGFyQ2xpZW50KCk7XG4gICAgY29uc3QgY2FsZW5kYXJJZCA9IGdldENhbGVuZGFySWQoKTtcblxuICAgIC8vIFNldCB1cCB0aGUgZGF0ZSByYW5nZSBmb3IgdGhlIGVudGlyZSBkYXlcbiAgICBjb25zdCBzdGFydE9mRGF5ID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgc3RhcnRPZkRheS5zZXRIb3VycyhCVVNJTkVTU19IT1VSX1NUQVJULCAwLCAwLCAwKTtcblxuICAgIGNvbnN0IGVuZE9mRGF5ID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgZW5kT2ZEYXkuc2V0SG91cnMoQlVTSU5FU1NfSE9VUl9FTkQsIDAsIDAsIDApO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgLy8gR2V0IGFsbCBidXN5IHRpbWVzIGZvciB0aGUgZGF5XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2FsZW5kYXIuZnJlZWJ1c3kucXVlcnkoe1xuICAgICAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICAgICAgICB0aW1lTWluOiBzdGFydE9mRGF5LnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgdGltZU1heDogZW5kT2ZEYXkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBpdGVtczogW3sgaWQ6IGNhbGVuZGFySWQgfV0sXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBidXN5U2xvdHMgPSByZXNwb25zZS5kYXRhLmNhbGVuZGFycz8uW2NhbGVuZGFySWRdPy5idXN5IHx8IFtdO1xuICAgICAgICBjb25zdCBhdmFpbGFibGVTbG90czogU2xvdE9wdGlvbltdID0gW107XG5cbiAgICAgICAgLy8gSXRlcmF0ZSB0aHJvdWdoIHRoZSBkYXkgaW4gMzAtbWludXRlIGluY3JlbWVudHNcbiAgICAgICAgbGV0IGN1cnJlbnRUaW1lID0gbmV3IERhdGUoc3RhcnRPZkRheSk7XG5cbiAgICAgICAgd2hpbGUgKGN1cnJlbnRUaW1lIDwgZW5kT2ZEYXkgJiYgYXZhaWxhYmxlU2xvdHMubGVuZ3RoIDwgY291bnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHNsb3RFbmQgPSBuZXcgRGF0ZShjdXJyZW50VGltZS5nZXRUaW1lKCkgKyBBUFBPSU5UTUVOVF9EVVJBVElPTl9NSU5VVEVTICogNjAwMDApO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIHNsb3Qgb3ZlcmxhcHMgd2l0aCBhbnkgYnVzeSBwZXJpb2RcbiAgICAgICAgICAgIGNvbnN0IGlzQXZhaWxhYmxlID0gIWJ1c3lTbG90cy5zb21lKChidXN5KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgYnVzeVN0YXJ0ID0gbmV3IERhdGUoYnVzeS5zdGFydCEpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGJ1c3lFbmQgPSBuZXcgRGF0ZShidXN5LmVuZCEpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50VGltZSA8IGJ1c3lFbmQgJiYgc2xvdEVuZCA+IGJ1c3lTdGFydDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoaXNBdmFpbGFibGUgJiYgc2xvdEVuZCA8PSBlbmRPZkRheSkge1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZVNsb3RzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogZm9ybWF0U2xvdExhYmVsKGN1cnJlbnRUaW1lLCBzbG90RW5kKSxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGN1cnJlbnRUaW1lLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgIGVuZDogc2xvdEVuZC50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBNb3ZlIHRvIG5leHQgc2xvdFxuICAgICAgICAgICAgY3VycmVudFRpbWUgPSBuZXcgRGF0ZShjdXJyZW50VGltZS5nZXRUaW1lKCkgKyBBUFBPSU5UTUVOVF9EVVJBVElPTl9NSU5VVEVTICogNjAwMDApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGF2YWlsYWJsZVNsb3RzO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgYXZhaWxhYmxlIHNsb3RzOicsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxufVxuXG4vLyBGb3JtYXQgc2xvdCBmb3IgZGlzcGxheVxuZnVuY3Rpb24gZm9ybWF0U2xvdExhYmVsKHN0YXJ0OiBEYXRlLCBlbmQ6IERhdGUpOiBzdHJpbmcge1xuICAgIGNvbnN0IG9wdGlvbnM6IEludGwuRGF0ZVRpbWVGb3JtYXRPcHRpb25zID0ge1xuICAgICAgICBob3VyOiAnbnVtZXJpYycsXG4gICAgICAgIG1pbnV0ZTogJzItZGlnaXQnLFxuICAgICAgICBob3VyMTI6IHRydWUsXG4gICAgfTtcbiAgICBjb25zdCBzdGFydFN0ciA9IHN0YXJ0LnRvTG9jYWxlVGltZVN0cmluZygnZW4tVVMnLCBvcHRpb25zKTtcbiAgICBjb25zdCBlbmRTdHIgPSBlbmQudG9Mb2NhbGVUaW1lU3RyaW5nKCdlbi1VUycsIG9wdGlvbnMpO1xuICAgIGNvbnN0IGRhdGVTdHIgPSBzdGFydC50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLVVTJywge1xuICAgICAgICB3ZWVrZGF5OiAnc2hvcnQnLFxuICAgICAgICBtb250aDogJ3Nob3J0JyxcbiAgICAgICAgZGF5OiAnbnVtZXJpYydcbiAgICB9KTtcblxuICAgIHJldHVybiBgJHtkYXRlU3RyfSwgJHtzdGFydFN0cn0gLSAke2VuZFN0cn1gO1xufVxuXG4vLyBDcmVhdGUgYSBuZXcgY2FsZW5kYXIgZXZlbnRcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFdmVudChcbiAgICB0aXRsZTogc3RyaW5nLFxuICAgIHN0YXJ0VGltZTogRGF0ZSxcbiAgICBlbmRUaW1lOiBEYXRlLFxuICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nXG4pOiBQcm9taXNlPENhbGVuZGFyRXZlbnQ+IHtcbiAgICBjb25zdCBjYWxlbmRhciA9IGdldENhbGVuZGFyQ2xpZW50KCk7XG4gICAgY29uc3QgY2FsZW5kYXJJZCA9IGdldENhbGVuZGFySWQoKTtcblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2FsZW5kYXIuZXZlbnRzLmluc2VydCh7XG4gICAgICAgICAgICBjYWxlbmRhcklkLFxuICAgICAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICAgICAgICBzdW1tYXJ5OiB0aXRsZSxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24gfHwgJ0FwcG9pbnRtZW50IGJvb2tlZCB2aWEgVm9pY2UgU2NoZWR1bGVyJyxcbiAgICAgICAgICAgICAgICBzdGFydDoge1xuICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogc3RhcnRUaW1lLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgIHRpbWVab25lOiAnQXNpYS9Lb2xrYXRhJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVuZDoge1xuICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogZW5kVGltZS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICB0aW1lWm9uZTogJ0FzaWEvS29sa2F0YScsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogcmVzcG9uc2UuZGF0YS5pZCEsXG4gICAgICAgICAgICBzdW1tYXJ5OiByZXNwb25zZS5kYXRhLnN1bW1hcnkhLFxuICAgICAgICAgICAgc3RhcnQ6IHtcbiAgICAgICAgICAgICAgICBkYXRlVGltZTogcmVzcG9uc2UuZGF0YS5zdGFydD8uZGF0ZVRpbWUhLFxuICAgICAgICAgICAgICAgIHRpbWVab25lOiByZXNwb25zZS5kYXRhLnN0YXJ0Py50aW1lWm9uZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbmQ6IHtcbiAgICAgICAgICAgICAgICBkYXRlVGltZTogcmVzcG9uc2UuZGF0YS5lbmQ/LmRhdGVUaW1lISxcbiAgICAgICAgICAgICAgICB0aW1lWm9uZTogcmVzcG9uc2UuZGF0YS5lbmQ/LnRpbWVab25lLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBldmVudDonLCBlcnJvcik7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbn1cblxuLy8gRmluZCBldmVudCBieSBkYXRlXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmluZEV2ZW50QnlEYXRlKGRhdGU6IERhdGUpOiBQcm9taXNlPENhbGVuZGFyRXZlbnQgfCBudWxsPiB7XG4gICAgY29uc3QgY2FsZW5kYXIgPSBnZXRDYWxlbmRhckNsaWVudCgpO1xuICAgIGNvbnN0IGNhbGVuZGFySWQgPSBnZXRDYWxlbmRhcklkKCk7XG5cbiAgICBjb25zdCBzdGFydE9mRGF5ID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgc3RhcnRPZkRheS5zZXRIb3VycygwLCAwLCAwLCAwKTtcblxuICAgIGNvbnN0IGVuZE9mRGF5ID0gbmV3IERhdGUoZGF0ZSk7XG4gICAgZW5kT2ZEYXkuc2V0SG91cnMoMjMsIDU5LCA1OSwgOTk5KTtcblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2FsZW5kYXIuZXZlbnRzLmxpc3Qoe1xuICAgICAgICAgICAgY2FsZW5kYXJJZCxcbiAgICAgICAgICAgIHRpbWVNaW46IHN0YXJ0T2ZEYXkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIHRpbWVNYXg6IGVuZE9mRGF5LnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICBzaW5nbGVFdmVudHM6IHRydWUsXG4gICAgICAgICAgICBvcmRlckJ5OiAnc3RhcnRUaW1lJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgZXZlbnRzID0gcmVzcG9uc2UuZGF0YS5pdGVtcyB8fCBbXTtcblxuICAgICAgICBpZiAoZXZlbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZXR1cm4gdGhlIGZpcnN0IGV2ZW50IGZvdW5kXG4gICAgICAgIGNvbnN0IGV2ZW50ID0gZXZlbnRzWzBdO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IGV2ZW50LmlkISxcbiAgICAgICAgICAgIHN1bW1hcnk6IGV2ZW50LnN1bW1hcnkgfHwgJ0FwcG9pbnRtZW50JyxcbiAgICAgICAgICAgIHN0YXJ0OiB7XG4gICAgICAgICAgICAgICAgZGF0ZVRpbWU6IGV2ZW50LnN0YXJ0Py5kYXRlVGltZSB8fCBldmVudC5zdGFydD8uZGF0ZSEsXG4gICAgICAgICAgICAgICAgdGltZVpvbmU6IGV2ZW50LnN0YXJ0Py50aW1lWm9uZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbmQ6IHtcbiAgICAgICAgICAgICAgICBkYXRlVGltZTogZXZlbnQuZW5kPy5kYXRlVGltZSB8fCBldmVudC5lbmQ/LmRhdGUhLFxuICAgICAgICAgICAgICAgIHRpbWVab25lOiBldmVudC5lbmQ/LnRpbWVab25lLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmaW5kaW5nIGV2ZW50OicsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxufVxuXG4vLyBVcGRhdGUvcmVzY2hlZHVsZSBhbiBldmVudFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUV2ZW50KFxuICAgIGV2ZW50SWQ6IHN0cmluZyxcbiAgICBuZXdTdGFydFRpbWU6IERhdGUsXG4gICAgbmV3RW5kVGltZTogRGF0ZVxuKTogUHJvbWlzZTxDYWxlbmRhckV2ZW50PiB7XG4gICAgY29uc3QgY2FsZW5kYXIgPSBnZXRDYWxlbmRhckNsaWVudCgpO1xuICAgIGNvbnN0IGNhbGVuZGFySWQgPSBnZXRDYWxlbmRhcklkKCk7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGVuZGFyLmV2ZW50cy5wYXRjaCh7XG4gICAgICAgICAgICBjYWxlbmRhcklkLFxuICAgICAgICAgICAgZXZlbnRJZCxcbiAgICAgICAgICAgIHJlcXVlc3RCb2R5OiB7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IG5ld1N0YXJ0VGltZS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICB0aW1lWm9uZTogJ0FzaWEvS29sa2F0YScsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlbmQ6IHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IG5ld0VuZFRpbWUudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgdGltZVpvbmU6ICdBc2lhL0tvbGthdGEnLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IHJlc3BvbnNlLmRhdGEuaWQhLFxuICAgICAgICAgICAgc3VtbWFyeTogcmVzcG9uc2UuZGF0YS5zdW1tYXJ5ISxcbiAgICAgICAgICAgIHN0YXJ0OiB7XG4gICAgICAgICAgICAgICAgZGF0ZVRpbWU6IHJlc3BvbnNlLmRhdGEuc3RhcnQ/LmRhdGVUaW1lISxcbiAgICAgICAgICAgICAgICB0aW1lWm9uZTogcmVzcG9uc2UuZGF0YS5zdGFydD8udGltZVpvbmUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW5kOiB7XG4gICAgICAgICAgICAgICAgZGF0ZVRpbWU6IHJlc3BvbnNlLmRhdGEuZW5kPy5kYXRlVGltZSEsXG4gICAgICAgICAgICAgICAgdGltZVpvbmU6IHJlc3BvbnNlLmRhdGEuZW5kPy50aW1lWm9uZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZXZlbnQ6JywgZXJyb3IpO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG59XG5cbi8vIERlbGV0ZS9jYW5jZWwgYW4gZXZlbnRcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFdmVudChldmVudElkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjYWxlbmRhciA9IGdldENhbGVuZGFyQ2xpZW50KCk7XG4gICAgY29uc3QgY2FsZW5kYXJJZCA9IGdldENhbGVuZGFySWQoKTtcblxuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGNhbGVuZGFyLmV2ZW50cy5kZWxldGUoe1xuICAgICAgICAgICAgY2FsZW5kYXJJZCxcbiAgICAgICAgICAgIGV2ZW50SWQsXG4gICAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGV2ZW50OicsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxufVxuXG4vLyBHZXQgZW5kIHRpbWUgYmFzZWQgb24gc3RhcnQgdGltZSBhbmQgZGVmYXVsdCBkdXJhdGlvblxuZXhwb3J0IGZ1bmN0aW9uIGdldEVuZFRpbWUoc3RhcnRUaW1lOiBEYXRlKTogRGF0ZSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKHN0YXJ0VGltZS5nZXRUaW1lKCkgKyBBUFBPSU5UTUVOVF9EVVJBVElPTl9NSU5VVEVTICogNjAwMDApO1xufVxuIl0sIm5hbWVzIjpbImdldENhbGVuZGFyQ2xpZW50IiwiZ2V0Q2FsZW5kYXJJZCIsIkFQUE9JTlRNRU5UX0RVUkFUSU9OX01JTlVURVMiLCJCVVNJTkVTU19IT1VSX1NUQVJUIiwiQlVTSU5FU1NfSE9VUl9FTkQiLCJjaGVja0F2YWlsYWJpbGl0eSIsInN0YXJ0VGltZSIsImVuZFRpbWUiLCJjYWxlbmRhciIsImNhbGVuZGFySWQiLCJyZXNwb25zZSIsImZyZWVidXN5IiwicXVlcnkiLCJyZXF1ZXN0Qm9keSIsInRpbWVNaW4iLCJ0b0lTT1N0cmluZyIsInRpbWVNYXgiLCJpdGVtcyIsImlkIiwiYnVzeSIsImRhdGEiLCJjYWxlbmRhcnMiLCJsZW5ndGgiLCJlcnJvciIsImNvbnNvbGUiLCJmaW5kTmV4dEF2YWlsYWJsZVNsb3RzIiwiZGF0ZSIsImNvdW50Iiwic3RhcnRPZkRheSIsIkRhdGUiLCJzZXRIb3VycyIsImVuZE9mRGF5IiwiYnVzeVNsb3RzIiwiYXZhaWxhYmxlU2xvdHMiLCJjdXJyZW50VGltZSIsInNsb3RFbmQiLCJnZXRUaW1lIiwiaXNBdmFpbGFibGUiLCJzb21lIiwiYnVzeVN0YXJ0Iiwic3RhcnQiLCJidXN5RW5kIiwiZW5kIiwicHVzaCIsImxhYmVsIiwiZm9ybWF0U2xvdExhYmVsIiwib3B0aW9ucyIsImhvdXIiLCJtaW51dGUiLCJob3VyMTIiLCJzdGFydFN0ciIsInRvTG9jYWxlVGltZVN0cmluZyIsImVuZFN0ciIsImRhdGVTdHIiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJ3ZWVrZGF5IiwibW9udGgiLCJkYXkiLCJjcmVhdGVFdmVudCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJldmVudHMiLCJpbnNlcnQiLCJzdW1tYXJ5IiwiZGF0ZVRpbWUiLCJ0aW1lWm9uZSIsImZpbmRFdmVudEJ5RGF0ZSIsImxpc3QiLCJzaW5nbGVFdmVudHMiLCJvcmRlckJ5IiwiZXZlbnQiLCJ1cGRhdGVFdmVudCIsImV2ZW50SWQiLCJuZXdTdGFydFRpbWUiLCJuZXdFbmRUaW1lIiwicGF0Y2giLCJkZWxldGVFdmVudCIsImRlbGV0ZSIsImdldEVuZFRpbWUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/google/calendar.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/google/gmail.ts":
/*!*********************************!*\
  !*** ./src/lib/google/gmail.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   sendBookingConfirmation: () => (/* binding */ sendBookingConfirmation),\n/* harmony export */   sendCancellationConfirmation: () => (/* binding */ sendCancellationConfirmation),\n/* harmony export */   sendConfirmationEmail: () => (/* binding */ sendConfirmationEmail),\n/* harmony export */   sendRescheduleConfirmation: () => (/* binding */ sendRescheduleConfirmation)\n/* harmony export */ });\n/* harmony import */ var nodemailer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! nodemailer */ \"(rsc)/./node_modules/nodemailer/lib/nodemailer.js\");\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./auth */ \"(rsc)/./src/lib/google/auth.ts\");\n\n\n// Create reusable transporter using Gmail App Password\nfunction createTransporter() {\n    const { senderEmail, gmailAppPassword } = (0,_auth__WEBPACK_IMPORTED_MODULE_1__.getEmailConfig)();\n    if (!senderEmail || !gmailAppPassword) {\n        console.warn(\"Gmail configuration missing - skipping email notification\");\n        return null;\n    }\n    return nodemailer__WEBPACK_IMPORTED_MODULE_0__.createTransport({\n        service: \"gmail\",\n        auth: {\n            user: senderEmail,\n            pass: gmailAppPassword\n        }\n    });\n}\n// Send confirmation email using Nodemailer\nasync function sendConfirmationEmail(subject, htmlBody) {\n    const { senderEmail, advisorEmail } = (0,_auth__WEBPACK_IMPORTED_MODULE_1__.getEmailConfig)();\n    if (!senderEmail || !advisorEmail) {\n        console.warn(\"Email configuration missing - skipping email notification\");\n        return false;\n    }\n    const transporter = createTransporter();\n    if (!transporter) {\n        return false;\n    }\n    try {\n        const result = await transporter.sendMail({\n            from: `\"Appointment Scheduler\" <${senderEmail}>`,\n            to: advisorEmail,\n            subject: subject,\n            html: htmlBody\n        });\n        console.log(\"Email sent successfully:\", result.messageId);\n        return true;\n    } catch (error) {\n        console.error(\"Error sending email:\", error);\n        return false;\n    }\n}\n// Send booking confirmation\nasync function sendBookingConfirmation(appointmentDateTime) {\n    const subject = \"‚úÖ Appointment Booked - Voice Scheduler\";\n    const htmlBody = `\n    <div style=\"font-family: 'Segoe UI', Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n      <div style=\"background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); padding: 30px; border-radius: 12px 12px 0 0;\">\n        <h1 style=\"color: white; margin: 0; font-size: 24px;\">Appointment Confirmed</h1>\n      </div>\n      <div style=\"background: #f8fafc; padding: 30px; border-radius: 0 0 12px 12px; border: 1px solid #e2e8f0;\">\n        <p style=\"color: #334155; font-size: 16px; margin: 0 0 15px;\">A new appointment has been booked via the Voice Scheduler.</p>\n        <div style=\"background: white; padding: 20px; border-radius: 8px; border-left: 4px solid #3b82f6;\">\n          <p style=\"margin: 0; color: #64748b; font-size: 14px;\">Scheduled for:</p>\n          <p style=\"margin: 5px 0 0; color: #1e293b; font-size: 18px; font-weight: 600;\">${appointmentDateTime}</p>\n        </div>\n        <p style=\"color: #94a3b8; font-size: 12px; margin-top: 20px;\">This email was sent automatically by the Advisor Appointment Scheduler.</p>\n      </div>\n    </div>\n  `;\n    return sendConfirmationEmail(subject, htmlBody);\n}\n// Send reschedule confirmation\nasync function sendRescheduleConfirmation(oldDateTime, newDateTime) {\n    const subject = \"\\uD83D\\uDCC5 Appointment Rescheduled - Voice Scheduler\";\n    const htmlBody = `\n    <div style=\"font-family: 'Segoe UI', Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n      <div style=\"background: linear-gradient(135deg, #f59e0b 0%, #ea580c 100%); padding: 30px; border-radius: 12px 12px 0 0;\">\n        <h1 style=\"color: white; margin: 0; font-size: 24px;\">Appointment Rescheduled</h1>\n      </div>\n      <div style=\"background: #f8fafc; padding: 30px; border-radius: 0 0 12px 12px; border: 1px solid #e2e8f0;\">\n        <p style=\"color: #334155; font-size: 16px; margin: 0 0 15px;\">An appointment has been rescheduled via the Voice Scheduler.</p>\n        <div style=\"background: white; padding: 20px; border-radius: 8px; margin-bottom: 15px;\">\n          <p style=\"margin: 0; color: #ef4444; font-size: 14px; text-decoration: line-through;\">Previous: ${oldDateTime}</p>\n          <p style=\"margin: 10px 0 0; color: #22c55e; font-size: 18px; font-weight: 600;\">New: ${newDateTime}</p>\n        </div>\n        <p style=\"color: #94a3b8; font-size: 12px; margin-top: 20px;\">This email was sent automatically by the Advisor Appointment Scheduler.</p>\n      </div>\n    </div>\n  `;\n    return sendConfirmationEmail(subject, htmlBody);\n}\n// Send cancellation confirmation\nasync function sendCancellationConfirmation(appointmentDateTime) {\n    const subject = \"‚ùå Appointment Cancelled - Voice Scheduler\";\n    const htmlBody = `\n    <div style=\"font-family: 'Segoe UI', Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n      <div style=\"background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); padding: 30px; border-radius: 12px 12px 0 0;\">\n        <h1 style=\"color: white; margin: 0; font-size: 24px;\">Appointment Cancelled</h1>\n      </div>\n      <div style=\"background: #f8fafc; padding: 30px; border-radius: 0 0 12px 12px; border: 1px solid #e2e8f0;\">\n        <p style=\"color: #334155; font-size: 16px; margin: 0 0 15px;\">An appointment has been cancelled via the Voice Scheduler.</p>\n        <div style=\"background: white; padding: 20px; border-radius: 8px; border-left: 4px solid #ef4444;\">\n          <p style=\"margin: 0; color: #64748b; font-size: 14px;\">Cancelled appointment:</p>\n          <p style=\"margin: 5px 0 0; color: #1e293b; font-size: 18px; font-weight: 600; text-decoration: line-through;\">${appointmentDateTime}</p>\n        </div>\n        <p style=\"color: #94a3b8; font-size: 12px; margin-top: 20px;\">This email was sent automatically by the Advisor Appointment Scheduler.</p>\n      </div>\n    </div>\n  `;\n    return sendConfirmationEmail(subject, htmlBody);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2dvb2dsZS9nbWFpbC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBb0M7QUFDSTtBQUV4Qyx1REFBdUQ7QUFDdkQsU0FBU0U7SUFDUCxNQUFNLEVBQUVDLFdBQVcsRUFBRUMsZ0JBQWdCLEVBQUUsR0FBR0gscURBQWNBO0lBRXhELElBQUksQ0FBQ0UsZUFBZSxDQUFDQyxrQkFBa0I7UUFDckNDLFFBQVFDLElBQUksQ0FBQztRQUNiLE9BQU87SUFDVDtJQUVBLE9BQU9OLHVEQUEwQixDQUFDO1FBQ2hDUSxTQUFTO1FBQ1RDLE1BQU07WUFDSkMsTUFBTVA7WUFDTlEsTUFBTVA7UUFDUjtJQUNGO0FBQ0Y7QUFFQSwyQ0FBMkM7QUFDcEMsZUFBZVEsc0JBQ3BCQyxPQUFlLEVBQ2ZDLFFBQWdCO0lBRWhCLE1BQU0sRUFBRVgsV0FBVyxFQUFFWSxZQUFZLEVBQUUsR0FBR2QscURBQWNBO0lBRXBELElBQUksQ0FBQ0UsZUFBZSxDQUFDWSxjQUFjO1FBQ2pDVixRQUFRQyxJQUFJLENBQUM7UUFDYixPQUFPO0lBQ1Q7SUFFQSxNQUFNVSxjQUFjZDtJQUNwQixJQUFJLENBQUNjLGFBQWE7UUFDaEIsT0FBTztJQUNUO0lBRUEsSUFBSTtRQUNGLE1BQU1DLFNBQVMsTUFBTUQsWUFBWUUsUUFBUSxDQUFDO1lBQ3hDQyxNQUFNLENBQUMseUJBQXlCLEVBQUVoQixZQUFZLENBQUMsQ0FBQztZQUNoRGlCLElBQUlMO1lBQ0pGLFNBQVNBO1lBQ1RRLE1BQU1QO1FBQ1I7UUFFQVQsUUFBUWlCLEdBQUcsQ0FBQyw0QkFBNEJMLE9BQU9NLFNBQVM7UUFDeEQsT0FBTztJQUNULEVBQUUsT0FBT0MsT0FBTztRQUNkbkIsUUFBUW1CLEtBQUssQ0FBQyx3QkFBd0JBO1FBQ3RDLE9BQU87SUFDVDtBQUNGO0FBRUEsNEJBQTRCO0FBQ3JCLGVBQWVDLHdCQUNwQkMsbUJBQTJCO0lBRTNCLE1BQU1iLFVBQVU7SUFDaEIsTUFBTUMsV0FBVyxDQUFDOzs7Ozs7Ozs7eUZBU3FFLEVBQUVZLG9CQUFvQjs7Ozs7RUFLN0csQ0FBQztJQUVELE9BQU9kLHNCQUFzQkMsU0FBU0M7QUFDeEM7QUFFQSwrQkFBK0I7QUFDeEIsZUFBZWEsMkJBQ3BCQyxXQUFtQixFQUNuQkMsV0FBbUI7SUFFbkIsTUFBTWhCLFVBQVU7SUFDaEIsTUFBTUMsV0FBVyxDQUFDOzs7Ozs7OzswR0FRc0YsRUFBRWMsWUFBWTsrRkFDekIsRUFBRUMsWUFBWTs7Ozs7RUFLM0csQ0FBQztJQUVELE9BQU9qQixzQkFBc0JDLFNBQVNDO0FBQ3hDO0FBRUEsaUNBQWlDO0FBQzFCLGVBQWVnQiw2QkFDcEJKLG1CQUEyQjtJQUUzQixNQUFNYixVQUFVO0lBQ2hCLE1BQU1DLFdBQVcsQ0FBQzs7Ozs7Ozs7O3dIQVNvRyxFQUFFWSxvQkFBb0I7Ozs7O0VBSzVJLENBQUM7SUFFRCxPQUFPZCxzQkFBc0JDLFNBQVNDO0FBQ3hDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWR2aXNvci1hcHBvaW50bWVudC1zY2hlZHVsZXIvLi9zcmMvbGliL2dvb2dsZS9nbWFpbC50cz8zNTAyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBub2RlbWFpbGVyIGZyb20gJ25vZGVtYWlsZXInO1xuaW1wb3J0IHsgZ2V0RW1haWxDb25maWcgfSBmcm9tICcuL2F1dGgnO1xuXG4vLyBDcmVhdGUgcmV1c2FibGUgdHJhbnNwb3J0ZXIgdXNpbmcgR21haWwgQXBwIFBhc3N3b3JkXG5mdW5jdGlvbiBjcmVhdGVUcmFuc3BvcnRlcigpIHtcbiAgY29uc3QgeyBzZW5kZXJFbWFpbCwgZ21haWxBcHBQYXNzd29yZCB9ID0gZ2V0RW1haWxDb25maWcoKTtcblxuICBpZiAoIXNlbmRlckVtYWlsIHx8ICFnbWFpbEFwcFBhc3N3b3JkKSB7XG4gICAgY29uc29sZS53YXJuKCdHbWFpbCBjb25maWd1cmF0aW9uIG1pc3NpbmcgLSBza2lwcGluZyBlbWFpbCBub3RpZmljYXRpb24nKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XG4gICAgc2VydmljZTogJ2dtYWlsJyxcbiAgICBhdXRoOiB7XG4gICAgICB1c2VyOiBzZW5kZXJFbWFpbCxcbiAgICAgIHBhc3M6IGdtYWlsQXBwUGFzc3dvcmQsXG4gICAgfSxcbiAgfSk7XG59XG5cbi8vIFNlbmQgY29uZmlybWF0aW9uIGVtYWlsIHVzaW5nIE5vZGVtYWlsZXJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZW5kQ29uZmlybWF0aW9uRW1haWwoXG4gIHN1YmplY3Q6IHN0cmluZyxcbiAgaHRtbEJvZHk6IHN0cmluZ1xuKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIGNvbnN0IHsgc2VuZGVyRW1haWwsIGFkdmlzb3JFbWFpbCB9ID0gZ2V0RW1haWxDb25maWcoKTtcblxuICBpZiAoIXNlbmRlckVtYWlsIHx8ICFhZHZpc29yRW1haWwpIHtcbiAgICBjb25zb2xlLndhcm4oJ0VtYWlsIGNvbmZpZ3VyYXRpb24gbWlzc2luZyAtIHNraXBwaW5nIGVtYWlsIG5vdGlmaWNhdGlvbicpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IHRyYW5zcG9ydGVyID0gY3JlYXRlVHJhbnNwb3J0ZXIoKTtcbiAgaWYgKCF0cmFuc3BvcnRlcikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdHJhbnNwb3J0ZXIuc2VuZE1haWwoe1xuICAgICAgZnJvbTogYFwiQXBwb2ludG1lbnQgU2NoZWR1bGVyXCIgPCR7c2VuZGVyRW1haWx9PmAsXG4gICAgICB0bzogYWR2aXNvckVtYWlsLFxuICAgICAgc3ViamVjdDogc3ViamVjdCxcbiAgICAgIGh0bWw6IGh0bWxCb2R5LFxuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coJ0VtYWlsIHNlbnQgc3VjY2Vzc2Z1bGx5OicsIHJlc3VsdC5tZXNzYWdlSWQpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgZW1haWw6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vLyBTZW5kIGJvb2tpbmcgY29uZmlybWF0aW9uXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VuZEJvb2tpbmdDb25maXJtYXRpb24oXG4gIGFwcG9pbnRtZW50RGF0ZVRpbWU6IHN0cmluZ1xuKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIGNvbnN0IHN1YmplY3QgPSAn4pyFIEFwcG9pbnRtZW50IEJvb2tlZCAtIFZvaWNlIFNjaGVkdWxlcic7XG4gIGNvbnN0IGh0bWxCb2R5ID0gYFxuICAgIDxkaXYgc3R5bGU9XCJmb250LWZhbWlseTogJ1NlZ29lIFVJJywgQXJpYWwsIHNhbnMtc2VyaWY7IG1heC13aWR0aDogNjAwcHg7IG1hcmdpbjogMCBhdXRvOyBwYWRkaW5nOiAyMHB4O1wiPlxuICAgICAgPGRpdiBzdHlsZT1cImJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICMzYjgyZjYgMCUsICM4YjVjZjYgMTAwJSk7IHBhZGRpbmc6IDMwcHg7IGJvcmRlci1yYWRpdXM6IDEycHggMTJweCAwIDA7XCI+XG4gICAgICAgIDxoMSBzdHlsZT1cImNvbG9yOiB3aGl0ZTsgbWFyZ2luOiAwOyBmb250LXNpemU6IDI0cHg7XCI+QXBwb2ludG1lbnQgQ29uZmlybWVkPC9oMT5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBzdHlsZT1cImJhY2tncm91bmQ6ICNmOGZhZmM7IHBhZGRpbmc6IDMwcHg7IGJvcmRlci1yYWRpdXM6IDAgMCAxMnB4IDEycHg7IGJvcmRlcjogMXB4IHNvbGlkICNlMmU4ZjA7XCI+XG4gICAgICAgIDxwIHN0eWxlPVwiY29sb3I6ICMzMzQxNTU7IGZvbnQtc2l6ZTogMTZweDsgbWFyZ2luOiAwIDAgMTVweDtcIj5BIG5ldyBhcHBvaW50bWVudCBoYXMgYmVlbiBib29rZWQgdmlhIHRoZSBWb2ljZSBTY2hlZHVsZXIuPC9wPlxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogd2hpdGU7IHBhZGRpbmc6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDhweDsgYm9yZGVyLWxlZnQ6IDRweCBzb2xpZCAjM2I4MmY2O1wiPlxuICAgICAgICAgIDxwIHN0eWxlPVwibWFyZ2luOiAwOyBjb2xvcjogIzY0NzQ4YjsgZm9udC1zaXplOiAxNHB4O1wiPlNjaGVkdWxlZCBmb3I6PC9wPlxuICAgICAgICAgIDxwIHN0eWxlPVwibWFyZ2luOiA1cHggMCAwOyBjb2xvcjogIzFlMjkzYjsgZm9udC1zaXplOiAxOHB4OyBmb250LXdlaWdodDogNjAwO1wiPiR7YXBwb2ludG1lbnREYXRlVGltZX08L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8cCBzdHlsZT1cImNvbG9yOiAjOTRhM2I4OyBmb250LXNpemU6IDEycHg7IG1hcmdpbi10b3A6IDIwcHg7XCI+VGhpcyBlbWFpbCB3YXMgc2VudCBhdXRvbWF0aWNhbGx5IGJ5IHRoZSBBZHZpc29yIEFwcG9pbnRtZW50IFNjaGVkdWxlci48L3A+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgYDtcblxuICByZXR1cm4gc2VuZENvbmZpcm1hdGlvbkVtYWlsKHN1YmplY3QsIGh0bWxCb2R5KTtcbn1cblxuLy8gU2VuZCByZXNjaGVkdWxlIGNvbmZpcm1hdGlvblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlbmRSZXNjaGVkdWxlQ29uZmlybWF0aW9uKFxuICBvbGREYXRlVGltZTogc3RyaW5nLFxuICBuZXdEYXRlVGltZTogc3RyaW5nXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3Qgc3ViamVjdCA9ICfwn5OFIEFwcG9pbnRtZW50IFJlc2NoZWR1bGVkIC0gVm9pY2UgU2NoZWR1bGVyJztcbiAgY29uc3QgaHRtbEJvZHkgPSBgXG4gICAgPGRpdiBzdHlsZT1cImZvbnQtZmFtaWx5OiAnU2Vnb2UgVUknLCBBcmlhbCwgc2Fucy1zZXJpZjsgbWF4LXdpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmc6IDIwcHg7XCI+XG4gICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2Y1OWUwYiAwJSwgI2VhNTgwYyAxMDAlKTsgcGFkZGluZzogMzBweDsgYm9yZGVyLXJhZGl1czogMTJweCAxMnB4IDAgMDtcIj5cbiAgICAgICAgPGgxIHN0eWxlPVwiY29sb3I6IHdoaXRlOyBtYXJnaW46IDA7IGZvbnQtc2l6ZTogMjRweDtcIj5BcHBvaW50bWVudCBSZXNjaGVkdWxlZDwvaDE+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kOiAjZjhmYWZjOyBwYWRkaW5nOiAzMHB4OyBib3JkZXItcmFkaXVzOiAwIDAgMTJweCAxMnB4OyBib3JkZXI6IDFweCBzb2xpZCAjZTJlOGYwO1wiPlxuICAgICAgICA8cCBzdHlsZT1cImNvbG9yOiAjMzM0MTU1OyBmb250LXNpemU6IDE2cHg7IG1hcmdpbjogMCAwIDE1cHg7XCI+QW4gYXBwb2ludG1lbnQgaGFzIGJlZW4gcmVzY2hlZHVsZWQgdmlhIHRoZSBWb2ljZSBTY2hlZHVsZXIuPC9wPlxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogd2hpdGU7IHBhZGRpbmc6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDhweDsgbWFyZ2luLWJvdHRvbTogMTVweDtcIj5cbiAgICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogMDsgY29sb3I6ICNlZjQ0NDQ7IGZvbnQtc2l6ZTogMTRweDsgdGV4dC1kZWNvcmF0aW9uOiBsaW5lLXRocm91Z2g7XCI+UHJldmlvdXM6ICR7b2xkRGF0ZVRpbWV9PC9wPlxuICAgICAgICAgIDxwIHN0eWxlPVwibWFyZ2luOiAxMHB4IDAgMDsgY29sb3I6ICMyMmM1NWU7IGZvbnQtc2l6ZTogMThweDsgZm9udC13ZWlnaHQ6IDYwMDtcIj5OZXc6ICR7bmV3RGF0ZVRpbWV9PC9wPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPHAgc3R5bGU9XCJjb2xvcjogIzk0YTNiODsgZm9udC1zaXplOiAxMnB4OyBtYXJnaW4tdG9wOiAyMHB4O1wiPlRoaXMgZW1haWwgd2FzIHNlbnQgYXV0b21hdGljYWxseSBieSB0aGUgQWR2aXNvciBBcHBvaW50bWVudCBTY2hlZHVsZXIuPC9wPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIGA7XG5cbiAgcmV0dXJuIHNlbmRDb25maXJtYXRpb25FbWFpbChzdWJqZWN0LCBodG1sQm9keSk7XG59XG5cbi8vIFNlbmQgY2FuY2VsbGF0aW9uIGNvbmZpcm1hdGlvblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlbmRDYW5jZWxsYXRpb25Db25maXJtYXRpb24oXG4gIGFwcG9pbnRtZW50RGF0ZVRpbWU6IHN0cmluZ1xuKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIGNvbnN0IHN1YmplY3QgPSAn4p2MIEFwcG9pbnRtZW50IENhbmNlbGxlZCAtIFZvaWNlIFNjaGVkdWxlcic7XG4gIGNvbnN0IGh0bWxCb2R5ID0gYFxuICAgIDxkaXYgc3R5bGU9XCJmb250LWZhbWlseTogJ1NlZ29lIFVJJywgQXJpYWwsIHNhbnMtc2VyaWY7IG1heC13aWR0aDogNjAwcHg7IG1hcmdpbjogMCBhdXRvOyBwYWRkaW5nOiAyMHB4O1wiPlxuICAgICAgPGRpdiBzdHlsZT1cImJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNlZjQ0NDQgMCUsICNkYzI2MjYgMTAwJSk7IHBhZGRpbmc6IDMwcHg7IGJvcmRlci1yYWRpdXM6IDEycHggMTJweCAwIDA7XCI+XG4gICAgICAgIDxoMSBzdHlsZT1cImNvbG9yOiB3aGl0ZTsgbWFyZ2luOiAwOyBmb250LXNpemU6IDI0cHg7XCI+QXBwb2ludG1lbnQgQ2FuY2VsbGVkPC9oMT5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBzdHlsZT1cImJhY2tncm91bmQ6ICNmOGZhZmM7IHBhZGRpbmc6IDMwcHg7IGJvcmRlci1yYWRpdXM6IDAgMCAxMnB4IDEycHg7IGJvcmRlcjogMXB4IHNvbGlkICNlMmU4ZjA7XCI+XG4gICAgICAgIDxwIHN0eWxlPVwiY29sb3I6ICMzMzQxNTU7IGZvbnQtc2l6ZTogMTZweDsgbWFyZ2luOiAwIDAgMTVweDtcIj5BbiBhcHBvaW50bWVudCBoYXMgYmVlbiBjYW5jZWxsZWQgdmlhIHRoZSBWb2ljZSBTY2hlZHVsZXIuPC9wPlxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogd2hpdGU7IHBhZGRpbmc6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDhweDsgYm9yZGVyLWxlZnQ6IDRweCBzb2xpZCAjZWY0NDQ0O1wiPlxuICAgICAgICAgIDxwIHN0eWxlPVwibWFyZ2luOiAwOyBjb2xvcjogIzY0NzQ4YjsgZm9udC1zaXplOiAxNHB4O1wiPkNhbmNlbGxlZCBhcHBvaW50bWVudDo8L3A+XG4gICAgICAgICAgPHAgc3R5bGU9XCJtYXJnaW46IDVweCAwIDA7IGNvbG9yOiAjMWUyOTNiOyBmb250LXNpemU6IDE4cHg7IGZvbnQtd2VpZ2h0OiA2MDA7IHRleHQtZGVjb3JhdGlvbjogbGluZS10aHJvdWdoO1wiPiR7YXBwb2ludG1lbnREYXRlVGltZX08L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8cCBzdHlsZT1cImNvbG9yOiAjOTRhM2I4OyBmb250LXNpemU6IDEycHg7IG1hcmdpbi10b3A6IDIwcHg7XCI+VGhpcyBlbWFpbCB3YXMgc2VudCBhdXRvbWF0aWNhbGx5IGJ5IHRoZSBBZHZpc29yIEFwcG9pbnRtZW50IFNjaGVkdWxlci48L3A+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgYDtcblxuICByZXR1cm4gc2VuZENvbmZpcm1hdGlvbkVtYWlsKHN1YmplY3QsIGh0bWxCb2R5KTtcbn1cbiJdLCJuYW1lcyI6WyJub2RlbWFpbGVyIiwiZ2V0RW1haWxDb25maWciLCJjcmVhdGVUcmFuc3BvcnRlciIsInNlbmRlckVtYWlsIiwiZ21haWxBcHBQYXNzd29yZCIsImNvbnNvbGUiLCJ3YXJuIiwiY3JlYXRlVHJhbnNwb3J0Iiwic2VydmljZSIsImF1dGgiLCJ1c2VyIiwicGFzcyIsInNlbmRDb25maXJtYXRpb25FbWFpbCIsInN1YmplY3QiLCJodG1sQm9keSIsImFkdmlzb3JFbWFpbCIsInRyYW5zcG9ydGVyIiwicmVzdWx0Iiwic2VuZE1haWwiLCJmcm9tIiwidG8iLCJodG1sIiwibG9nIiwibWVzc2FnZUlkIiwiZXJyb3IiLCJzZW5kQm9va2luZ0NvbmZpcm1hdGlvbiIsImFwcG9pbnRtZW50RGF0ZVRpbWUiLCJzZW5kUmVzY2hlZHVsZUNvbmZpcm1hdGlvbiIsIm9sZERhdGVUaW1lIiwibmV3RGF0ZVRpbWUiLCJzZW5kQ2FuY2VsbGF0aW9uQ29uZmlybWF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/google/gmail.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/google/sheets.ts":
/*!**********************************!*\
  !*** ./src/lib/google/sheets.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logAction: () => (/* binding */ logAction),\n/* harmony export */   logBooking: () => (/* binding */ logBooking),\n/* harmony export */   logCancellation: () => (/* binding */ logCancellation),\n/* harmony export */   logReschedule: () => (/* binding */ logReschedule)\n/* harmony export */ });\n/* harmony import */ var _auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./auth */ \"(rsc)/./src/lib/google/auth.ts\");\n\nconst SHEET_NAME = \"Appointments\";\n// Ensure the Appointments sheet exists, create if not\nasync function ensureSheetExists() {\n    const sheets = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getSheetsClient)();\n    const spreadsheetId = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getSpreadsheetId)();\n    try {\n        // Try to get the spreadsheet to see if Appointments sheet exists\n        const spreadsheet = await sheets.spreadsheets.get({\n            spreadsheetId\n        });\n        const sheetExists = spreadsheet.data.sheets?.some((sheet)=>sheet.properties?.title === SHEET_NAME);\n        if (!sheetExists) {\n            // Create the Appointments sheet\n            await sheets.spreadsheets.batchUpdate({\n                spreadsheetId,\n                requestBody: {\n                    requests: [\n                        {\n                            addSheet: {\n                                properties: {\n                                    title: SHEET_NAME\n                                }\n                            }\n                        }\n                    ]\n                }\n            });\n            // Add headers\n            await sheets.spreadsheets.values.update({\n                spreadsheetId,\n                range: `${SHEET_NAME}!A1:E1`,\n                valueInputOption: \"RAW\",\n                requestBody: {\n                    values: [\n                        [\n                            \"Timestamp\",\n                            \"User Request\",\n                            \"Action\",\n                            \"Appointment DateTime\",\n                            \"Status\"\n                        ]\n                    ]\n                }\n            });\n            console.log(\"‚úÖ Created Appointments sheet with headers\");\n        }\n    } catch (error) {\n        console.error(\"Error ensuring sheet exists:\", error);\n        throw error;\n    }\n}\n// Log an action to Google Sheets\nasync function logAction(entry) {\n    const sheets = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getSheetsClient)();\n    const spreadsheetId = (0,_auth__WEBPACK_IMPORTED_MODULE_0__.getSpreadsheetId)();\n    try {\n        // First ensure the sheet exists\n        await ensureSheetExists();\n        await sheets.spreadsheets.values.append({\n            spreadsheetId,\n            range: `${SHEET_NAME}!A:E`,\n            valueInputOption: \"USER_ENTERED\",\n            requestBody: {\n                values: [\n                    [\n                        entry.timestamp,\n                        entry.userRequest,\n                        entry.actionTaken,\n                        entry.appointmentDateTime,\n                        entry.status\n                    ]\n                ]\n            }\n        });\n        console.log(\"‚úÖ Successfully logged to Google Sheets\");\n    } catch (error) {\n        console.error(\"‚ùå Error logging to sheets:\", error);\n        throw error; // Re-throw so caller knows it failed\n    }\n}\n// Log a booking action\nasync function logBooking(userRequest, appointmentDateTime) {\n    await logAction({\n        timestamp: new Date().toISOString(),\n        userRequest,\n        actionTaken: \"BOOKED\",\n        appointmentDateTime,\n        status: \"Confirmed\"\n    });\n}\n// Log a reschedule action\nasync function logReschedule(userRequest, newAppointmentDateTime) {\n    await logAction({\n        timestamp: new Date().toISOString(),\n        userRequest,\n        actionTaken: \"RESCHEDULED\",\n        appointmentDateTime: newAppointmentDateTime,\n        status: \"Updated\"\n    });\n}\n// Log a cancellation action\nasync function logCancellation(userRequest, appointmentDateTime) {\n    await logAction({\n        timestamp: new Date().toISOString(),\n        userRequest,\n        actionTaken: \"CANCELLED\",\n        appointmentDateTime,\n        status: \"Cancelled\"\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bnRtZW50LXNjaGVkdWxlci8uL3NyYy9saWIvZ29vZ2xlL3NoZWV0cy50cz84MGUwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFNoZWV0c0NsaWVudCwgZ2V0U3ByZWFkc2hlZXRJZCB9IGZyb20gJy4vYXV0aCc7XG5pbXBvcnQgeyBMb2dFbnRyeSB9IGZyb20gJy4uL3R5cGVzJztcblxuY29uc3QgU0hFRVRfTkFNRSA9ICdBcHBvaW50bWVudHMnO1xuXG4vLyBFbnN1cmUgdGhlIEFwcG9pbnRtZW50cyBzaGVldCBleGlzdHMsIGNyZWF0ZSBpZiBub3RcbmFzeW5jIGZ1bmN0aW9uIGVuc3VyZVNoZWV0RXhpc3RzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHNoZWV0cyA9IGdldFNoZWV0c0NsaWVudCgpO1xuICAgIGNvbnN0IHNwcmVhZHNoZWV0SWQgPSBnZXRTcHJlYWRzaGVldElkKCk7XG5cbiAgICB0cnkge1xuICAgICAgICAvLyBUcnkgdG8gZ2V0IHRoZSBzcHJlYWRzaGVldCB0byBzZWUgaWYgQXBwb2ludG1lbnRzIHNoZWV0IGV4aXN0c1xuICAgICAgICBjb25zdCBzcHJlYWRzaGVldCA9IGF3YWl0IHNoZWV0cy5zcHJlYWRzaGVldHMuZ2V0KHtcbiAgICAgICAgICAgIHNwcmVhZHNoZWV0SWQsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHNoZWV0RXhpc3RzID0gc3ByZWFkc2hlZXQuZGF0YS5zaGVldHM/LnNvbWUoXG4gICAgICAgICAgICAoc2hlZXQpID0+IHNoZWV0LnByb3BlcnRpZXM/LnRpdGxlID09PSBTSEVFVF9OQU1FXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKCFzaGVldEV4aXN0cykge1xuICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBBcHBvaW50bWVudHMgc2hlZXRcbiAgICAgICAgICAgIGF3YWl0IHNoZWV0cy5zcHJlYWRzaGVldHMuYmF0Y2hVcGRhdGUoe1xuICAgICAgICAgICAgICAgIHNwcmVhZHNoZWV0SWQsXG4gICAgICAgICAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdHM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRTaGVldDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogU0hFRVRfTkFNRSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBoZWFkZXJzXG4gICAgICAgICAgICBhd2FpdCBzaGVldHMuc3ByZWFkc2hlZXRzLnZhbHVlcy51cGRhdGUoe1xuICAgICAgICAgICAgICAgIHNwcmVhZHNoZWV0SWQsXG4gICAgICAgICAgICAgICAgcmFuZ2U6IGAke1NIRUVUX05BTUV9IUExOkUxYCxcbiAgICAgICAgICAgICAgICB2YWx1ZUlucHV0T3B0aW9uOiAnUkFXJyxcbiAgICAgICAgICAgICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IFtbJ1RpbWVzdGFtcCcsICdVc2VyIFJlcXVlc3QnLCAnQWN0aW9uJywgJ0FwcG9pbnRtZW50IERhdGVUaW1lJywgJ1N0YXR1cyddXSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgQ3JlYXRlZCBBcHBvaW50bWVudHMgc2hlZXQgd2l0aCBoZWFkZXJzJyk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBlbnN1cmluZyBzaGVldCBleGlzdHM6JywgZXJyb3IpO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG59XG5cbi8vIExvZyBhbiBhY3Rpb24gdG8gR29vZ2xlIFNoZWV0c1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ0FjdGlvbihlbnRyeTogTG9nRW50cnkpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBzaGVldHMgPSBnZXRTaGVldHNDbGllbnQoKTtcbiAgICBjb25zdCBzcHJlYWRzaGVldElkID0gZ2V0U3ByZWFkc2hlZXRJZCgpO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgLy8gRmlyc3QgZW5zdXJlIHRoZSBzaGVldCBleGlzdHNcbiAgICAgICAgYXdhaXQgZW5zdXJlU2hlZXRFeGlzdHMoKTtcblxuICAgICAgICBhd2FpdCBzaGVldHMuc3ByZWFkc2hlZXRzLnZhbHVlcy5hcHBlbmQoe1xuICAgICAgICAgICAgc3ByZWFkc2hlZXRJZCxcbiAgICAgICAgICAgIHJhbmdlOiBgJHtTSEVFVF9OQU1FfSFBOkVgLFxuICAgICAgICAgICAgdmFsdWVJbnB1dE9wdGlvbjogJ1VTRVJfRU5URVJFRCcsXG4gICAgICAgICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICAgICAgICAgIHZhbHVlczogW1tcbiAgICAgICAgICAgICAgICAgICAgZW50cnkudGltZXN0YW1wLFxuICAgICAgICAgICAgICAgICAgICBlbnRyeS51c2VyUmVxdWVzdCxcbiAgICAgICAgICAgICAgICAgICAgZW50cnkuYWN0aW9uVGFrZW4sXG4gICAgICAgICAgICAgICAgICAgIGVudHJ5LmFwcG9pbnRtZW50RGF0ZVRpbWUsXG4gICAgICAgICAgICAgICAgICAgIGVudHJ5LnN0YXR1cyxcbiAgICAgICAgICAgICAgICBdXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZygn4pyFIFN1Y2Nlc3NmdWxseSBsb2dnZWQgdG8gR29vZ2xlIFNoZWV0cycpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBsb2dnaW5nIHRvIHNoZWV0czonLCBlcnJvcik7XG4gICAgICAgIHRocm93IGVycm9yOyAvLyBSZS10aHJvdyBzbyBjYWxsZXIga25vd3MgaXQgZmFpbGVkXG4gICAgfVxufVxuXG4vLyBMb2cgYSBib29raW5nIGFjdGlvblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ0Jvb2tpbmcoXG4gICAgdXNlclJlcXVlc3Q6IHN0cmluZyxcbiAgICBhcHBvaW50bWVudERhdGVUaW1lOiBzdHJpbmdcbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IGxvZ0FjdGlvbih7XG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB1c2VyUmVxdWVzdCxcbiAgICAgICAgYWN0aW9uVGFrZW46ICdCT09LRUQnLFxuICAgICAgICBhcHBvaW50bWVudERhdGVUaW1lLFxuICAgICAgICBzdGF0dXM6ICdDb25maXJtZWQnLFxuICAgIH0pO1xufVxuXG4vLyBMb2cgYSByZXNjaGVkdWxlIGFjdGlvblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ1Jlc2NoZWR1bGUoXG4gICAgdXNlclJlcXVlc3Q6IHN0cmluZyxcbiAgICBuZXdBcHBvaW50bWVudERhdGVUaW1lOiBzdHJpbmdcbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IGxvZ0FjdGlvbih7XG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB1c2VyUmVxdWVzdCxcbiAgICAgICAgYWN0aW9uVGFrZW46ICdSRVNDSEVEVUxFRCcsXG4gICAgICAgIGFwcG9pbnRtZW50RGF0ZVRpbWU6IG5ld0FwcG9pbnRtZW50RGF0ZVRpbWUsXG4gICAgICAgIHN0YXR1czogJ1VwZGF0ZWQnLFxuICAgIH0pO1xufVxuXG4vLyBMb2cgYSBjYW5jZWxsYXRpb24gYWN0aW9uXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nQ2FuY2VsbGF0aW9uKFxuICAgIHVzZXJSZXF1ZXN0OiBzdHJpbmcsXG4gICAgYXBwb2ludG1lbnREYXRlVGltZTogc3RyaW5nXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCBsb2dBY3Rpb24oe1xuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgdXNlclJlcXVlc3QsXG4gICAgICAgIGFjdGlvblRha2VuOiAnQ0FOQ0VMTEVEJyxcbiAgICAgICAgYXBwb2ludG1lbnREYXRlVGltZSxcbiAgICAgICAgc3RhdHVzOiAnQ2FuY2VsbGVkJyxcbiAgICB9KTtcbn1cbiJdLCJuYW1lcyI6WyJnZXRTaGVldHNDbGllbnQiLCJnZXRTcHJlYWRzaGVldElkIiwiU0hFRVRfTkFNRSIsImVuc3VyZVNoZWV0RXhpc3RzIiwic2hlZXRzIiwic3ByZWFkc2hlZXRJZCIsInNwcmVhZHNoZWV0Iiwic3ByZWFkc2hlZXRzIiwiZ2V0Iiwic2hlZXRFeGlzdHMiLCJkYXRhIiwic29tZSIsInNoZWV0IiwicHJvcGVydGllcyIsInRpdGxlIiwiYmF0Y2hVcGRhdGUiLCJyZXF1ZXN0Qm9keSIsInJlcXVlc3RzIiwiYWRkU2hlZXQiLCJ2YWx1ZXMiLCJ1cGRhdGUiLCJyYW5nZSIsInZhbHVlSW5wdXRPcHRpb24iLCJjb25zb2xlIiwibG9nIiwiZXJyb3IiLCJsb2dBY3Rpb24iLCJlbnRyeSIsImFwcGVuZCIsInRpbWVzdGFtcCIsInVzZXJSZXF1ZXN0IiwiYWN0aW9uVGFrZW4iLCJhcHBvaW50bWVudERhdGVUaW1lIiwic3RhdHVzIiwibG9nQm9va2luZyIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImxvZ1Jlc2NoZWR1bGUiLCJuZXdBcHBvaW50bWVudERhdGVUaW1lIiwibG9nQ2FuY2VsbGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/google/sheets.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/nodemailer"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=%2FUsers%2Fanjali.shrivastava07icloud.com%2FDocuments%2FGitHub%2FM4%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fanjali.shrivastava07icloud.com%2FDocuments%2FGitHub%2FM4&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();